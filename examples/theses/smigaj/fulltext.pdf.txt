Design and numerical modelling of integrated optical
components
Wojciech S´migaj
To cite this version:
Wojciech S´migaj. Design and numerical modelling of integrated optical components. Mathe-
matical Physics. Universite´ Paul Ce´zanne - Aix-Marseille III, 2010. English. <tel-00567213>
HAL Id: tel-00567213
https://tel.archives-ouvertes.fr/tel-00567213
Submitted on 18 Feb 2011
HAL is a multi-disciplinary open access L’archive ouverte pluridisciplinaire HAL, est
archive for the deposit and dissemination of sci- destine´e au de´poˆt et a` la diffusion de documents
entific research documents, whether they are pub- scientifiques de niveau recherche, publie´s ou non,
lished or not. The documents may come from e´manant des e´tablissements d’enseignement et de
teaching and research institutions in France or recherche franc¸ais ou e´trangers, des laboratoires
abroad, or from public or private research centers. publics ou prive´s.
Thèse presentée à l’Université Paul Cézanne (Aix-Marseille III)
pour obtenir le grade de docteur en sciences
Conception et modélisation numérique
de composants optiques en nanophotonique intégrée
Design and numerical modelling
of integrated optical components
Wojciech S´MIGAJ
22 septembre 2010
Laboratoire d’accueil Institut Fresnel, équipe CLARTE
Formation doctorale physique théorique et mathématique
Membres du jury
Philippe LALANNE rapporteur
Andrey A. FEDYANIN rapporteur
Didier LIPPENS examinateur
Maciej KRAWCZYK examinateur
Mathias VANWOLLEGHEM examinateur
Stefan ENOCH directeur de thèse
Boris GRALAK tuteur de thèse

Contents
Acknowledgements 5
Résumé en français 7
1 Preliminaries 15
1.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
1.2 Outline of the thesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
1.3 Notational conventions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
1.4 Maxwell’s equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
2 Effective-medium model of photonic crystals 21
2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
2.2 Definition of the effective parameters of photonic crystals . . . . . . . . . . . . . . . . . 22
2.2.1 Preliminaries: the homogeneous-medium case . . . . . . . . . . . . . . . . . . 22
2.2.2 Existing definitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
2.2.3 Proposed definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
2.3 Influence of symmetries on the effective parameters . . . . . . . . . . . . . . . . . . . . 27
2.3.1 Real-valuedness . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
2.3.2 Continuity and boundedness . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
2.4 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
2.4.1 Hexagonal lattice . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
2.4.2 Square lattice . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
2.4.3 Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
2.5 Validity of the single-mode approximation . . . . . . . . . . . . . . . . . . . . . . . . . 40
2.6 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
3 Antireflection gratings for photonic crystals 45
3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
3.2 Types of antireflection structures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
3.2.1 Antireflection structures for homogeneous media . . . . . . . . . . . . . . . . . 45
3.2.2 Antireflection structures for photonic crystals . . . . . . . . . . . . . . . . . . . 46
3.3 Design procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
3.4 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
3.4.1 A photonic-crystal flat lens . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
3.4.2 A supercollimating photonic crystal . . . . . . . . . . . . . . . . . . . . . . . . 59
3.4.3 A photonic-crystal superprism . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
3.5 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
3
4 Contents
4 Magneto-optical circulators 65
4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
4.1.1 Basic characteristics of isolators and circulators . . . . . . . . . . . . . . . . . . 65
4.1.2 Routes to nonreciprocity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
4.1.3 Experimental realisations of optical isolators and circulators . . . . . . . . . . . 67
4.1.4 Outline of this chapter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
4.2 Extension of the coupled-wave model . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
4.2.1 Inclusion of direct coupling between waveguides . . . . . . . . . . . . . . . . . 72
4.2.2 Inclusion of radiation loss . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
4.3 Cavities with circular symmetry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
4.4 Photonic-crystal-based circulators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
4.5 Rib-waveguide-based circulators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
4.5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
4.5.2 Numerical calculations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92
4.5.3 Geometry optimisation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
4.5.4 Fabrication . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
4.6 Simulations of three-dimensional axisymmetric cavities . . . . . . . . . . . . . . . . . . 101
4.6.1 Evaluation of possible three-dimensional geometries . . . . . . . . . . . . . . . 101
4.6.2 Towards cavities with higher quality factor . . . . . . . . . . . . . . . . . . . . 105
4.7 Conclusions and perspectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111
5 Numerical methods 115
5.1 Multiple-scattering method for systems containing gyrotropic media . . . . . . . . . . . 115
5.2 Calculation of photonic-crystal band structures with Fourier-Bessel expansions . . . . . 118
5.2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
5.2.2 Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
5.2.3 Numerical examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
5.2.4 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128
5.3 Finite-element simulations of three-dimensional axisymmetric cavities . . . . . . . . . . 128
5.3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128
5.3.2 Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129
5.3.3 Numerical implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 137
5.3.4 Evaluation of accuracy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138
6 Conclusions and perspectives 143
Bibliography 145
Acknowledgements
I have been very privileged to have undoubtedly the most supportive, reliable and friendly advisor anyone
could ask for, namely Boris Gralak. While not hesitating to offer his advice and share his experience, he
let me enjoy a complete liberty in the pursuit of my scientific interests. I really appreciated his eye for
detail, his striving for clarity and precision (even as I am writing these words, Boris is still hunting for
the remaining mistakes in the French summary of this thesis), as well as his inextinguishable optimism.
In addition to being a mentor, he became a friend. I thank him and Mylène for all the evenings we spent
together. I am also indebted to Stefan Enoch, who agreed to act as the director of this thesis, in spite of
his numerous responsibilities as the associate director of Institut Fresnel.
My gratitude extends towards all the members of the CLARTE team in Institut Fresnel, who gave
me a warm welcome upon my arrival to Marseille three years ago and have ensured an excellent work-
ing environment ever since. Four persons deserve a special mention. Gérard Tayeb was always willing
to share his experience in the development of computational methods. On various occasions, he took
time to participate in rehearsals of my oral presentations, and his help and advice was invariably much
appreciated. I was also fortunate to be able to collaborate with Daniel Maystre, whose profound un-
derstanding of the mathematical foundations of numerical algorithms is unmatched by anyone I know.
Sebastién Guenneau and Javier Romero-Vivas took active part in the development of magneto-optical
circulators and performed numerous simulations that helped to optimise the devices. Besides, Javier and
I shared the joys and sorrows of a foreigner in France (« C’est Marseille. . . »).
This thesis owes also a lot to collaborations with several research groups from outside Marseille.
The work on antireflection gratings for photonic crystals was done in collaboration with teams from
Université de Lille I and Université de Bourgogne in Dijon. Maxence Hofman and Olivier Vanbésien
from the DOME team in Université de Lille I manufactured samples of photonic-crystal flat lens covered
with the antireflection gratings we had designed. Geoffroy Scherrer, Benoît Cluzel and Frédérique de
Fornel from the OCP team in Université de Bourgogne performed the near-field characterisation of these
samples. I would like to thank all of them for the interesting and fruitful meetings. Special thanks go to
Olivier for giving us all a taste of the delicious Flemish cuisine. I am also indebted to Didier Lippens,
director of the DOME team, for having accepted the invitation to act as a member of the examining board.
I greatly enjoyed the collaboration with the members of the MMS team in Institut d’Électronique
Fondamentale (IEF) in Orsay on magneto-optical circulators. I am particularly grateful to Mathias Van-
wolleghem, who introduced me to the fascinating topic of non-reciprocity in optics, infecting me with his
enthusiasm. Luba Magdenko and Béatrice Dagens devoted a lot of effort to the fabrication of prototypes
of the circulators, gradually taming the etch-resistant bismuth-iron-garnet substrates. Luba also took part
in the numerical modelling of the circulators. Always ready to ask inconvenient questions and to point
out the experimental constraints, she was fun to work with. Thanks are due to the whole team for the
innumerable discussions and e-mail interchanges we have had, as well as for inviting Boris and me to
spend a month at IEF.
I am no less indebted to Maciej Krawczyk from Adam Mickiewicz University in Poznan´, the advisor
for my Master’s thesis, who has also accepted to be a member of the examination board. Thanks to
5
6 Acknowledgements
Maciej I have been able to keep in touch with my alma mater. I am grateful for his continuous support
and for his genuine interest in the progress of my research. I am also indebted to Henryk Puszkarski,
director of the Surface Physics Division in Poznan´, for his willingness to share his experience and advice.
I particularly want to thank all the members of Prof. Puszkarski’s group for the warm welcome they gave
me whenever I came back to Poznan´.
I would like to extend my sincere gratitude to Philippe Lalanne from Institut d’Optique in Palaiseau
and to Andrey A. Fedyanin from Lomonosov Moscow State University for accepting to write reviews of
this thesis. I also acknowledge the French Ministry of Higher Education and Research for providing its
funding.
Finally, I would like to thank all my friends and my family, whose presence has been absolutely
invaluable during these three years. I am deeply grateful to my parents and sister for their continuing
support, kindness and love. My fellow Ph.D. students from the CLARTE and HIPE teams in Institut Fres-
nel, Alexis, Fabien, Raphaël P., Raphaël L., Mohamed, Xiaoyun, Frédéric, Muamer and Guillaume con-
tributed to making the lab the great place it was. My special thanks go to all the members of Aumônerie
Jer’aum,? who made me feel at home in Marseille. I will miss you much when I leave! Lastly, I want to
thank all of my Polish friends, especially Kasia, Małgosia, Milena, Alicja, Marcin, Jacek, Wawrzyniec
and Karol.
Wojciech S´migaj, Marseille, 1 September 2010
? Jean Pol and Jean, Louis and Paul, Jules Hervé and Estelle, Jeannette, Alexandra, Lucie, Marion, Alexis, Frédéric, Césaire,
Romuald, Matthieu, Descartes, Jean-François and Yen, Rakia, Chinh, Olga, Damien, Jean-Marie, Charles and Yvri, Katell,
Randy, Thibault, Priscilla, Melissa. . .
Résumé en français
Contexte historique
L’aube de la seconde moitié du XXème siècle a été marquée par l’invention des circuits électroniques
intégrés fabriqués dans des couches minces semiconductrices. En raison de leur faible coût et de leur
petite taille, les circuits intégrés ont rapidement presque supplanté les « gros » composants électroniques :
les bobines, les tubes électroniques etc. Ils ont fourni les moyens de la révolution technologique qui a
fait des appareils électroniques compacts une partie intégrante de la vie moderne.
Peu de temps après la première démonstration expérimentale du laser en 1960, le concept des cir-
cuits optiques intégrés est apparu. Par analogie avec leurs homologues électroniques, ils devaient ouvrir
la voie à la miniaturisation des dispositifs optiques. Depuis la découverte du laser, des progrès signifi-
catifs ont été accomplis : de nombreux composants photoniques intégrés, tels que coupleurs, filtres ou
multiplexeurs, sont couramment utilisés dans les dispositifs disponibles dans le commerce. Toutefois,
il faut admettre que le développement de la technologie des circuits optiques intégrés a été beaucoup
plus lent que celui des circuits électroniques. Pour preuve, si les processeurs modernes contiennent des
millions de transistors sur une seule puce, les circuits intégrés optiques les plus complexes réalisés à ce
jour se composent d’à peine quelques centaines de composants [1–4].
Il semble y avoir deux raisons principales à cette différence. Premièrement, la longueur d’onde de
la lumière aux fréquences de télécommunications, qui est de l’ordre de 0.1–1 µm dans des matériaux
diélectriques typiques, est beaucoup plus grande que la longueur de l’onde de Broglie d’un électron au
niveau de Fermi d’un métal classique, 0.1–1 nm [5, p. 120]. Celle-ci est si petite que, jusqu’à récemment,
les propriétés ondulatoires des électrons pourraient être quasiment ignorées dans la conception de com-
posants électroniques, qui pourraient donc être miniaturisés sans encombre. Au contraire, la longueur
d’onde de la lumière constitue une vraie limite de la taille des composants optiques.? Deuxièmement,
pour des applications diverses, il est avantageux d’utiliser des substrats avec des propriétés physiques
particulières, présentant par exemple d’importants effets électro-, magnéto- ou acousto-optiques. Étant
donné que ces propriétés sont difficiles à obtenir simultanément dans un seul matériau, les premiers
circuits optiques intégrés ont été construits de la façon dite hybride, où tous les composants sont fabri-
qués séparément en utilisant des matériaux et technologies différents avant d’être assemblés sur un seul
substrat [7, p. 9]. Avec cette approche, chaque composant peut être optimisé séparément ; par contre,
l’alignement et le couplage des différents éléments constituent une difficulté de taille. Ainsi, les circuits
optiques intégrés hybrides ne comportent pas plus que quelques composants. Les circuits intégrés les
plus complexes sont donc fabriqués de façon monolithique, où tout le système est gravé dans un seul
substrat. Actuellement, la technologie de ce type la plus avancée est certainement celle qui est fondée sur
le phosphure d’indium.
L’introduction de la notion de cristaux photoniques à la fin des années 1980 [8, 9] a profondément
influencé la recherche sur les circuits optiques intégrés. Le cristal photonique est défini comme un sys-
? Les composants plasmoniques, qui constituent actuellement le sujet de recherches actives, pourraient néanmoins permettre
d’aller plus loin dans la miniaturisation des dispositifs optiques [6].
7
8 Résumé en français
tème dans lequel la permittivité et la perméabilité dépendent périodiquement de la variable d’espace :
ainsi, il peut être considéré comme un analogue électromagnétique d’un solide cristallin. La périodi-
cité de la permittivité et de la perméabilité peut donner lieu à des « gaps », c’est-à-dire, des bandes de
fréquences où aucun état propagatif (transportant de l’énergie) n’existe à l’intérieur du cristal. Rapide-
ment, pour des fréquences situées dans un gap, des défauts linéaires le long desquels des modes localisés
peuvent se propager ont été imaginés dans des cristaux photoniques ; de tels défauts peuvent donc ser-
vir de guides d’onde [10]. En même temps, on a démontré que les défauts ponctuels dans les cristaux
photoniques peuvent se comporter comme des résonateurs avec la valeur du ratio entre le facteur de
qualité et le volume du mode potentiellement très importante [10]. Toutefois, c’est une autre découverte
qui va révéler l’énorme intérêt envers les cristaux photoniques en tant que moyen de miniaturiser les
circuits optiques intégrés : les modes de guides d’onde à cristaux photoniques peuvent se propager le
long des coudes pratiquement sans pertes d’énergie [11]. En effet, les rayons de courbure des guides
d’onde standards doivent être de l’ordre de quelques millimètres afin de maintenir les pertes à un niveau
raisonnable [10]. En revanche, les guides à cristaux photoniques peuvent avoir des coudes avec un rayon
de courbure d’environ un micromètre. Jusqu’ici, de nombreux dispositifs optiques basés sur les guides
d’onde et résonateurs à cristaux photoniques ont été proposés, et plusieurs d’entre eux ont été réalisés
expérimentalement. Pour une revue relativement récente de l’état actuel de la recherche sur les cristaux
photoniques, le lecteur peut consulter la référence 12.
Alors que les premières études de cristaux photoniques ont porté principalement sur la recherche de
structures fournissant le gap le plus large et sur la conception de composants fonctionnant dans le gap,
la dernière décennie a vu la communauté porter une attention croissante aux propriétés inhabituelles des
cristaux photoniques en dehors des gaps. Contrairement aux diélectriques homogènes, dont la surface
d’isofréquence est une ellipsoïde, la forme de la surface d’isofréquence des cristaux photoniques peut
être très compliquée.? En outre, la vitesse de groupe dans un cristal photonique peut être orientée dans
n’importe quelle direction. Cette richesse de la relation de dispersion donne lieu à des phénomènes
inhabituels [13], comme la réfraction négative de la lumière [14], l’apparition de faisceaux autocollimatés
[15] ou l’effet « superprism » [16]. Ainsi, il a été reconnu que même les cristaux photoniques sans défauts
(la présence de surfaces exceptée) peuvent constituer des dispositifs utiles, par exemple des lentilles
planes [17, 18] ou des diviseurs de faisceau [19].
Structure de la thèse
Cette thèse est consacrée à la conception et l’analyse théorique et numérique de certains composants
en cristaux photoniques. Dans le chapitre 1, nous donnons une brève introduction à la thématique de la
thèse, nous définissons les notations utilisées dans la suite, et nous rappelons quelques faits de base sur
les équations de Maxwell, fondement de tous les développements ultérieurs. L’essence de la thèse, les
chapitres 2 à 5, se divise naturellement en trois parties distinctes. Dans les chapitres 2 et 3, nous étudions
les cristaux photoniques bidimensionnels sans défauts, limités par une ou deux surfaces planes parallèles.
En particulier, nous nous intéressons à la dépendance des propriétés de tels cristaux à l’égard de la
structure des interfaces les séparant des milieux homogènes. Dans le chapitre 4, qui constitue la deuxième
partie essentielle de cette thèse, nous tournons notre attention vers un type de composants optiques plus
traditionnels, puisque basés sur les guides d’onde : les circulateurs magnéto-optiques. La troisième partie
de la thèse, le chapitre 5, est consacrée à la présentation de quelques méthodes numériques développées
pour les simulations des dispositifs analysés dans les chapitres précédents. La thèse se termine par le
chapitre 6, dans lequel nous mettons en évidence les résultats qui nous semblent les plus importants
? On observe la même chose dans la théorie de l’état solide : la surface de Fermi dans un gaz d’électrons libres est sphérique,
mais dans un solide réel, elle a souvent une forme très complexe, parfois appelée, judicieusement, un monstre.
Chapitre 2 : Modèle du milieu effectif pour les cristaux photoniques 9
et nous indiquons les perspectives des futurs travaux sur certains sujets. Ci-dessous nous résumons le
contenu des chapitres qui constituent le corps de la thèse.
Chapitre 2 : Modèle du milieu effectif pour les cristaux photoniques
Comme mentionné ci-dessus, une caractéristique essentielle des cristaux photoniques réside dans la ri-
chesse de leur relation de dispersion. La forme des surfaces d’isofréquence des cristaux photoniques
peut être très complexe : ils contiennent parfois des changements de direction brutaux séparant des ré-
gions planes ou même concaves. Toutefois, à certaines fréquences, ils peuvent également atteindre une
forme ellipsoïdale, caractéristique pour des milieux homogènes. En conséquence, la question se pose si
les cristaux peuvent alors être correctement décrits par le modèle du milieu effectif, dans lequel ils sont
représentés par un matériau homogène avec une certaine permittivité  et perméabilité . Comme les
matériaux homogènes sont incomparablement plus faciles à analyser que les matériaux structurés, une
réponse affirmative simplifierait le développement de dispositifs à cristaux photoniques, en particulier de
ceux qui utilisent l’effet de la réfraction négative [14]. En effet, la plupart des composants basés sur ce
phénomène, comme les célèbres superlentilles [17], ont été conçus pour des matériaux à indice négatif
homogènes imaginés par Veselago [20].
De nombreux documents traitant de ce sujet ont déjà été publiés [21–32], donnant lieu à plusieurs
définitions des paramètres effectifs des cristaux photoniques, reportées au paragraphe 2.2.2. Cependant,
ces définitions sont généralement introduites de façon heuristique et manquent de justification formelle.
En outre, pour toutes ces définitions, la confrontation du coefficient de réflexion du cristal calculé rigou-
reusement avec celui du milieu effectif correspondant n’a jusqu’alors été effectuée que pour l’incidence
normale [24–26] ou quasi-normale [28]. Pourtant, de nombreuses applications, y compris celles utilisant
la réfraction négative, s’appuient sur le comportement des ondes incidentes aux grands angles, voire des
ondes évanescentes. Le domaine de validité de l’approximation du milieu effectif est, par conséquent,
encore mal connu.
L’objectif du travail présenté dans le chapitre 2 est de remédier à ces lacunes. Dans la section 2.2,
nous adoptons l’hypothèse de l’approximation monomode pour fournir une justification mathématique
rigoureuse à une certaine définition des paramètres effectifs des cristaux photoniques bidimensionnels.
Dans la section 2.3, nous étudions l’influence de la symétrie du plan de troncature du cristal et celle des
modes propres du cristal sur le comportement de ses paramètres effectifs. En particulier, nous dérivons
les conditions dans lesquelles les paramètres effectifs sont réels et bornés pour tous les angles d’inci-
dence. Nous généralisons ainsi le résultat obtenu par Pierre and Gralak [27] dans le cas unidimensionnel.
Pour évaluer la précision du modèle du milieu effectif, nous comparons dans la section 2.4 les valeurs
du coefficient de la réflexion spéculaire prévu dans le cadre du modèle avec les résultats des calculs
numériques rigoureux. Ces tests, effectués pour deux cristaux différents à un nombre de fréquences et
dans tout le domaine d’angle d’incidence, indiquent que la précision du modèle est limitée par celle de
l’hypothèse de départ, l’approximation monomode.
Ces résultats ont imposé d’analyser de façon précise le domaine de validité de l’approximation mo-
nomode. Dans la section 2.5, nous établissons un lien entre les amplitudes relatives d’excitation des
modes propres d’un cristal et le spectre de Fourier des champs électrique et magnétique de ces modes sur
le plan de troncature du cristal. Ce lien est utilisé pour formuler un critère d’estimation de la précision de
l’approximation monomode : cette hypothèse est d’autant plus pertinente que la courbe d’isofréquence
du cristal photonique se rapproche de celle du milieu homogène avec l’indice de réfraction égal à la
moyenne de l’indice de réfraction du cristal. Enfin, nous considérons le cas particulier des modes en-
gendrant la réfraction négative. Nous observons que leur excitation par une onde plane est accompagnée
pour la plupart des angles d’incidence par une excitation simultanée d’autres modes (évanescents) avec
10 Résumé en français
une amplitude importante. Dans ce cas, l’approximation monomode d’un cristal photonique présentant
le phénomène de réfraction négative ne peut être considéré comme (relativement) précise que près de
l’incidence normale. Notre analyse montre qu’il hasardeux de traiter un tel cristal photonique comme
un matériau homogène pour des angles d’incidence importants ou dans le régime d’ondes évanescentes.
Finalement, le comportement de systèmes contenant des matériaux d’indice négatif homogènes peut
s’avérer considérablement différent lorsque ces matériaux sont remplacés par des cristaux photoniques,
même si les courbes d’isofréquence (et, par conséquent, les indices de réfraction définis par l’intermé-
diaire de la vitesse de phase) des deux milieux sont identiques.
Chapitre 3 : Réseaux antiréfléchissants pour des cristaux photoniques
Les courbes du coefficient de réflexion des cristaux photoniques étudiés dans le chapitre 2 (figures 2.5,
2.7, 2.10, 2.12 et 2.13) montrent que des ondes réfléchies d’amplitude importante sont souvent générées
sur la surface des cristaux photoniques. Dans de nombreuses applications, il est au contraire souhaitable
d’obtenir un transfert d’énergie parfait entre l’onde plane incidente et le mode propre propagatif du cristal
photoniques (ou, plus rarement, plusieurs modes propagatifs). Les ondes réfléchies de caractère propa-
gatif doivent donc être éliminées. Le chapitre 3 concerne la conception de structures antiréfléchissantes
qui, placées sur la surface d’un cristal photonique, diminuent significativement la fraction d’énergie per-
due dans les ondes réfléchies. Après avoir examiné les classes de telles structures proposées à ce jour
(section 3.2), dans la section 3.3, nous proposons une nouvelle méthode de conception de réseaux anti-
réfléchissants avec une tolérance angulaire importante.
L’algorithme de conception que nous proposons consiste en trois étapes. Premièrement, les para-
mètres d’une couche homogène antiréfléchissante sont calculés à partir d’un modèle du milieu effectif
du cristal photonique en question. Deuxièmement, une théorie analytique du milieu effectif des réseaux
lamellaires binaires est utilisée pour trouver les paramètres d’un réseau composé des seuls matériaux
constitutifs du cristal, et dont les propriétés sont proches de celles de la couche obtenue à l’étape pré-
cédente. Troisièmement, la forme de la grille est raffinée à l’aide d’une routine numérique de recherche
locale qui vise à minimiser la réflectance moyenne de la structure dans la gamme désirée d’angle ou de
la fréquence. Cette dernière étape est nécessaire en raison des approximations faites dans les dérivations
analytiques utilisées dans les deux premières étapes de la procédure.
Dans la section 3.4, nous appliquons la méthode proposée à trois cristaux dont les courbes d’iso-
fréquence sont de courbure différente : un cristal présentant le phénomène d’autocollimation, avec une
courbe isofréquence très plate ; un cristal présentant l’effet de réfraction négative, avec une courbe d’iso-
fréquence presque circulaire ; et un cristal photonique du type « superprism », dont la courbe isofréquence
a des cornes. Dans les deux premiers cas, nous réussissons à concevoir des réseaux antiréfléchissants ga-
rantissant une réflectance très faible dans une vaste gamme angulaire. Les structures obtenues sont très
compactes et paraissent simple à fabriquer ; en fait, l’amélioration apportée par ces réseaux antiréflé-
chissants à la transmission à travers une lentille plate de cristal photonique (basée sur l’effet de réfrac-
tion négative) a déjà été confirmée expérimentalement [33]. Cependant, dans le cas du cristal du type
« superprism », la procédure de conception échoue à cause de la violation de certaines contraintes sur
l’impédance effective du cristal, qui doivent être remplies pour que la couche antiréfléchissante géné-
rée dans la première étape puisse être approchée par un réseau binaire constitué de matériaux réalistes.
L’existence de ces contraintes est la limitation principale de la procédure présentée.
Chapitre 4 : Circulateurs magnéto-optiques 11
Chapitre 4 : Circulateurs magnéto-optiques
Dans le chapitre 4, nous étudions le problème de la miniaturisation des circulateurs optiques, qui ap-
partiennent aux derniers composants optiques intégrés importants dont la version intégrée ne soit pas
encore disponible dans le commerce. Le circulateur est un dispositif reliant n  3 guides d’onde de telle
sorte que l’énergie entrant par le guide Wi (1  i < n) est entièrement transférée au guide WiC1 et
l’énergie entrant par le guide Wn est transférée au guide W1. Un dispositif apparenté, l’isolateur, relie
deux guides d’onde ainsi que le transfert d’énergie soit interdit dans un sens, mais autorisé dans l’autre.
Manifestement, le circulateur peut également faire fonction d’isolateur.
Ces deux composants ont plusieurs applications importantes. Ils peuvent servir à éliminer les ondes
réfléchies des composants d’impédance mal adaptée dans des circuits complexes ; la présence de telles
ondes peut donner lieu à des interférences indésirables et couplages parasites [34]. Les composants en
question sont également employés dans l’acheminement des signaux dans des dispositifs tels que les
multiplexeurs [35]. Dans le domaine optique, l’application la plus importante des isolateurs est sans
doute la protection des lasers de la lumière réfléchie, qui perturbe la configuration des ondes stationnaires
dans une cavité laser et peut entraîner le laser à devenir instable [36].
Les circulateurs et les isolateurs sont dits des dispositifs non-réciproques. Cela signifie, en particu-
lier, qu’ils ne peuvent pas être réalisés en utilisant uniquement des matériaux linéaires, invariants dans le
temps et dont la permittivité et la perméabilité s’expriment par des tenseurs symétriques. La façon la plus
commune d’obtenir un système non-réciproque est d’y inclure un matériau présentant l’effet magnéto-
optique : par exemple, un grenat synthétique tel que le grenat de fer et bismuth. Traditionnellement, les
isolateurs sont constitués d’une plaque d’un matériau magnéto-optique placée entre deux polariseurs, P1
et P , tournés de 45ı2 l’un par rapport à l’autre. Le fonctionnement d’un tel isolateur s’appuie sur l’effet
de Faraday, qui consiste en une rotation non-réciproque du plan de polarisation des ondes électromagné-
tiques traversant un matériau magnéto-optique dans la direction parallèle à celle d’un champ magnétique
statique externe. Grâce à cet effet, le plan de polarisation des ondes qui entrent dans l’isolateur par le
polariseur P1 (par exemple) s’aligne progressivement avec l’axe du polariseur P2 ; par conséquent, ces
ondes sont transmises à travers le dispositif. En revanche, le plan de polarisation des ondes entrant par le
polariseur P2 devient perpendiculaire à l’axe du polariseur P1, par lequel ils sont donc absorbées.
Malheureusement, en raison de leur structure non plane, les isolateurs décrits ci-dessus ne peuvent
être produits comme éléments d’un circuit optique intégré. En conséquence, dans les deux dernières
décennies, beaucoup d’efforts ont été faits pour concevoir des isolateurs et des circulateurs adaptés à la
fabrication sur puce (voir la référence 35 pour une revue de la littérature). Le fonctionnement de la plupart
des dispositifs proposés jusqu’à présent est basé sur la conversion non-réciproque des modes propres d’un
guide d’onde (un phénomène analogue à l’effet de Faraday) ou sur l’interférence des ondes se propageant
dans deux ou plusieurs guides d’onde placés dans un champ magnétique statique externe. Cependant,
l’effet magnéto-optique est généralement faible : il ne peut influencer sensiblement le comportement
de la lumière que si celle-ci interagit avec un matériau magnéto-optique sur un chemin optique très
long, typiquement 1000, où  est la longueur d’onde de la lumière. En conséquence, les isolateurs et
circulateurs basés sur des guides d’onde sont très longs (1mm), ce qui rend difficile leur intégration
avec d’autres composants optiques fondamentaux, beaucoup plus petits.
Une stratégie de miniaturisation potentielle consiste à employer des résonateurs optiques pour allon-
ger le temps de l’interaction de la lumière avec le matériau magnéto-optique, au prix d’une réduction de la
bande passante du composant. En 2005,Wang et Fan [34, 37] ont proposé un circulateur magnéto-optique
inspiré d’une classe de dispositifs couramment utilisés dans le domaine micro-ondes, où, cependant, les
effets induits par un champ magnétique statique externe sont beaucoup plus importants. Le circulateur
de Wang et Fan se compose de trois guides d’onde à cristal photonique couplés à une cavité à cristal
12 Résumé en français
photonique dans laquelle deux modes propres bien localisés peuvent être excités. Leurs fréquences sont
décalées l’une par rapport à l’autre en présence d’un champ magnétique statique externe, la matrice du
cristal photonique étant d’un matériau magnéto-optique. En utilisant le formalisme du couplage faible,
on peut montrer qu’un tel système fonctionne comme un circulateur.
Il faut noter, cependant, que la séparation des fréquences des deux modes de la cavité originale pré-
sentée dans les références 34 et 37 est négligeable dans un champ magnétique statique externe uniforme.
Elle ne devient acceptable que si le matériau magnéto-optique dans la cavité est divisé dans de nombreux
domaines magnétiques polarisés dans les sens contraires, chacun d’une superficie d’une fraction de µm2.
La réalisation de tels domaines est, en pratique, très difficile technologiquement, car elle nécessite un
contrôle précis – à l’échelle nanométrique – du champ magnétique statique externe appliqué. Pour cette
raison, le dispositif conçu par Wang et Fan n’a jamais été fabriqué. L’objectif de la recherche présentée
dans le chapitre 4 était d’élaborer la conception d’un circulateur s’appuyant sur un résonateur magnéto-
optique et capable de fonctionner dans un champ magnétique statique externe uniforme, c’est-à-dire,
avec tout le matériau magnéto-optique aimanté uniformément.
Nous commençons par étudier comment la géométrie d’une cavité magnéto-optique bidimension-
nelle placée dans un champ magnétique statique externe influence le décalage des fréquences de ses
deux modes propres (section 4.3). Afin de mieux comprendre le problème, nous nous concentrons sur
le modèle simplifié d’une cavité axisymétrique, c’est à dire composée d’une série d’anneaux concen-
triques. De telles structures peuvent être traitées analytiquement ; en particulier, nous sommes en mesure
de montrer que le décalage maximal des fréquences dans un champ magnétique statique externe uni-
forme est obtenu pour des cavités ayant la forme d’un miroir de Bragg annulaire. Nous obtenons ainsi
une procédure explicite pour la conception de cavités axisymétriques optimisées pour le fonctionnement
dans un champ magnétique statique externe uniforme, ce qui constitue le fondement de cette étude.
L’étape suivante de la conception du circulateur est de coupler efficacement la cavité avec les guides
d’onde d’entrée et de sortie. Dans les sections 4.4 et 4.5, deux classes de structures sont examinées :
les circulateurs à base de cristaux photoniques, semblables à ceux étudiés dans les références 34 et 37,
et les circulateurs dans lesquels le revêtement à cristal photonique est supprimé et la cavité est couplée
directement à des guides d’onde standards. Cette élimination du cristal photonique conduit à une simpli-
fication importante de la géométrie du dispositif. Néanmoins, l’analyse théorique de son fonctionnement
devient un peu plus compliqué, car on doit tenir compte des effets du couplage direct entre les guides
d’onde et des pertes d’énergie par le rayonnement dans le plan du dispositif, comme il est décrit dans la
section 4.2. Les performances des deux catégories de circulateurs sont évaluées à l’aide de simulations
numériques rigoureuses. Nous concluons que la simplification de géométrie résultant de l’élimination du
cristal photonique ne doit pas être accompagnée d’une détérioration de la performance du composant.
Par conséquent, dans la suite du chapitre 4 nous nous concentrons sur les circulateurs avec des guides
standards, c’est-à-dire sans cristaux photoniques.
A ce stade, il convient de résumer les résultats des tests expérimentaux de nos circulateurs, fabriqués
et caractérisés par L. Magdenko et B. Dagens (Institut d’Electronique Fondamentale, Orsay, France) dans
des hétérostructures composées des grenats de bismuth et fer et de gadolinium et gallium. Ces résultats
révèlent un problème significatif dans la conception originale des cavités : des pertes d’énergie impor-
tantes par rayonnement hors plan du dispositif. Elles sont une conséquence du fait que la conception
n’était originellement basée que sur des simulations bidimensionnelles (l’approximation d’indice effec-
tif utilisée dans certaines des simulations s’est avérée ne pas avoir été assez précise). C’est pourquoi, dans
la dernière partie du chapitre 4, nous présentons les premiers résultats des simulations tridimensionnelles
des cavités, obtenus avec la méthode des éléments finis décrite dans la section 5.3. Nous démontrons
que le problème des pertes hors-plan peut être surmonté par un ajustement approprié de la géométrie de
la cavité. Plus précisément, le facteur de qualité des modes propres peut être sensiblement amélioré en
Chapitre 5 : Méthodes numériques 13
recouvrant la cavité avec un matériau ayant un indice de réfraction proche de celui du substrat et par
l’optimisation numérique des positions et des largeurs des anneaux constitutifs de la cavité. A ce jour,
ce raffinement de la conception basé sur des simulations tridimensionnelles demande à être confirmé
expérimentalement.
Chapitre 5 : Méthodes numériques
Dans le chapitre 5, nous présentons les méthodes de calcul développées au cours de cette thèse et utilisées
pour obtenir une partie des résultats présentés dans l’ensemble des chapitres.
La section 5.1 est consacrée à la méthode de diffusion multiple [38–40] pour la solution du problème
de la diffusion de lumière par des cristaux photoniques bidimensionnels composés de cylindres circu-
laires. Cette technique est reconnue depuis longtemps comme l’une des méthodes les plus efficaces pour
traiter ce type de problèmes. La raison en est double. D’une part, les fonctions de base utilisées pour
développer le champ électromagnétique (à savoir les séries de Fourier-Bessel) sont des solutions exactes
des équations de Maxwell, et donc elles sont bien adaptées pour représenter le champ électromagnétique
en présence de ces domaines. Deuxièmement, comme les fonctions de base sont séparables en coordon-
nées polaires, les conditions de continuité satisfaites par le champ électromagnétique sur les surfaces
des cylindres sont simples à exprimer et imposer. Dans la section 5.1, nous montrons que la méthode
en question peut être généralisée aisément au cas des cristaux photoniques contenant des milieux gyro-
tropiques qui respectent la même symétrie axiale que les tiges circulaires [les tenseurs de permittivité et
perméabilité ont alors la forme donnée par l’équation (5.5)]. Nous notons, toutefois, qu’une extension
similaire pour le cas des matériaux avec une anisotropie plus générale n’est pas possible, car la réduction
des équations de Maxwell à l’équation de Helmholtz n’est alors possible qu’au prix d’un changement de
coordonnées transformant des cercles en des ellipses, ce qui engendre des effets secondaires indésirables.
Compte tenu de l’efficacité et la simplicité de la méthode de diffusion multiple, cette méthode a été
également appliquée au calcul de la relation de dispersion des cristaux photoniques infinis composés
de cylindres ou de sphères [41–47]. Elle nécessite, pourtant, de calculer explicitement le champ produit
par un nombre infini de diffuseurs disposés sur un réseau périodique. Ce champ peut être exprimé par
une série dite « lattice sum». Malheureusement, des telles séries sont lentement convergentes, et les
techniques particulières nécessaires pour l’accélération de leur calcul compliquent considérablement la
mise en œuvre de la méthode par rapport au cas d’un système fini.
Dans la section 5.2, nous proposons une technique élégante de calcul de la relation de dispersion des
cristaux photoniques composés de cylindres circulaires. Comme la méthode de diffusion multiple, elle
s’appuie sur le développement du champ électromagnétique sur des solutions exactes des équations de
Maxwell (les séries de Fourier-Bessel), avec l’avantage d’éviter le calcul des « lattice sums ». L’idée de
base est très simple : le champ dans une maille d’un cristal photonique est développé sur des solutions
particulières de l’équation de Helmholtz, et les conditions de Bloch sur les limites de la maille sont im-
posées par collocation. Cette approche est en fait similaire à la technique utilisée dans les simulations
de réseaux avec la méthode de sources fictives afin d’éviter le calcul des fonctions de Green périodiques
[48]. La méthode proposée ici partage également de nombreuses caractéristiques avec la technique des
opérateurs de Dirichlet-Neumann, mise au point dans le groupe de Lu [49, 50]. Par rapport à cette tech-
nique, la présente méthode est plus directe et plus efficace, mais aussi moins générale (spécialement
adaptée aux calculs de la relation de dispersion).
La principale vertu de la méthode que nous proposons est sa grande efficacité : en raison de la
convergence exponentielle des résultats, il est possible d’atteindre une précision relative meilleure que
10 10 avec un coût de calcul modeste, comme il est démontré dans plusieurs exemples étudiés dans le
paragraphe 5.2.3. Par conséquent, la technique en question peut fournir des valeurs de référence extrê-
14 Résumé en français
mement précises aux fins des tests d’autres méthodes numériques. La haute précision est aussi précieuse
dans les études avec des effets faibles, tels que la non-réciprocité entraînée par l’influence d’un champ
magnétique statique sur la propagation des ondes aux fréquences optiques.
Pour les cristaux photoniques dont la maille ne contient qu’une seule inclusion circulaire, la mise
en œuvre de cette méthode est directe. Cependant, si plusieurs inclusions sont présentes, la maille doit
être décomposée en sous-mailles englobant les inclusions individuelles, ce qui complique à un certain
degré la mise en œuvre de la méthode. Les inconvénients principales de la technique en question sont
(1) sa restriction à des systèmes contenant des inclusions circulaires et (2) la dégradation visible de sa
précision à la présence des sous-mailles dont la forme diffère nettement de celle d’un cercle centré sur
l’inclusion.
Dans la section 5.3, nous décrivons une variante de la méthode des éléments finis utilisée pour cal-
culer les modes propres de cavités axisymétriques tridimensionnelles ouvertes, contenant des matériaux
gyrotropiques. Cette technique a été employée pour obtenir les résultats présentés dans la section 4.6.
Elle combine des éléments de plusieurs approches décrites dans la littérature, en particulier celles pré-
sentées dans les références 51 et 52. L’apport original de ce travail consiste en l’extension de la méthode
au cas des systèmes contenant des milieux gyrotropiques. Jusqu’à présent, elle n’avait été formulée que
pour des matériaux avec des permittivité et perméabilité représentées par des tenseurs diagonaux, ce qui
est le niveau de généralité nécessaire pour la modélisation des couches absorbantes parfaitement adaptées
(PMLs) [51, 53, 54].
Nous donnons ici une caractérisation concise de la méthode décrite dans la section 5.3. Nous pro-
fitons d’abord de la symétrie axiale du domaine tridimensionnel en réduisant le problème original à
un système dénombrable des problèmes propres découplés, posés sur un seul plan méridien (bidimen-
sionnel). Nous utilisons des éléments finis nodaux scalaires pour développer la composante azimutale
du champ électrique, et des éléments finis vectoriels pour développer une superposition particulière des
composantes azimutale et méridienne de ce champ. Ce choix d’inconnues permet d’exprimer simple-
ment les conditions de continuité sur l’axe de la cavité. Afin de supprimer les réflexions parasites sur les
limites du domaine de calcul, nous les revêtons de PMLs. La mise en œuvre de la méthode est facilitée
par la disponibilité de plusieurs outils d’open source, en particulier les bibliothèques Hermes (éléments
finis) [55, 56] et SLEPc [57–59] (solution des problèmes aux valeurs propres avec des matrices creuses).
Les tests de convergence présentés dans le paragraphe 5.3.4 montrent que la fréquence propre des
modes localisés d’une cavité magnéto-optique typique conçue de la manière décrite dans la section 4.6
peut être déterminée avec la précision relative de 10 5 dans un délai raisonnable sur un ordinateur de
bureau. Nous montrons également que les résultats sont très peu sensibles aux changements des para-
mètres qui contrôlent la troncature du domaine.
Chapter 1
Preliminaries
1.1 Introduction
The dawn of the second half of the 20. century was marked by the invention of electronic integrated cir-
cuits (ICs) fabricated in semiconductor thin films. Owing to their low cost and small size, ICs quickly all
but displaced older “bulk” electronic components: coils, glass tubes and so on. They provided the means
for the technological revolution that made compact electronic devices an integral part of modern life.
Shortly after the first experimental demonstration of the laser in 1960, the concept of optical ICs
appeared. In analogy to their electronic counterparts, they were to pave the way to the miniaturisation
of optical devices. Significant progress has been made from that time: numerous integrated photonic
components, such as splitters, couplers or multiplexers, are routinely used in commercially available
devices. However, it must be admitted that the development of the optical IC technology has been
incomparably slower than that of electronic ICs. Suffice it to say that while state-of-the-art processors
contain millions of transistors on a single chip, the most complex optical ICs realised to date consist of
barely several hundred components [1–4].
There seem to be two principal reasons for this difference. First, the wavelength of light at telecom-
munication frequencies, which is on the order of 0.1–1 µm in typical dielectric materials, is much larger
than the de Broglie wavelength of an electron at the Fermi level of a typical metal, 0.1–1 nm [5, p. 120].
The latter is so small that until recently the wave-like properties of electrons could be essentially ignored
in the design of electronic components, which could therefore be rather straightforwardly miniaturised.
In contrast, the wavelength of light is a real limit on the size of optical components.? Second, for specific
applications it is advantageous to use substrates having particular physical properties, for example ex-
hibiting strong electro-, magneto- or acousto-optical effects. Since these properties are difficult to obtain
simultaneously in a single material, the first optical ICs were built with the so-called hybrid approach:
their individual components were fabricated separately, possibly using different materials and technolo-
gies, and then bonded together to a single substrate [7, p. 9]. The advantage of this approach is that each
component can be optimised separately; the disadvantage lies in the inherent difficulty of aligning and
coupling the various elements. Thus, hybrid optical ICs hardly ever consist of more than a few compo-
nents. ICs of larger complexity can only be fabricated using the monolithic approach, where the whole
system is etched in a single substrate. Currently, the most advanced technology of this type seems to be
that based on indium phosphide.
A boost to the research on optical ICs was given by the introduction of the concept of photonic
crystals (PCs) in late 1980s [8, 9]. A PC is defined as a system in which the permittivity and permeability
are periodically dependent on the position; thus, it can be viewed as an electromagnetic analogue of a
? Plasmonic components, which are currently an area of active research, might enable further miniaturisation of optical
devices [6].
15
16 Chapter 1. Preliminaries
crystalline solid. The periodicity of the material properties can give rise to the appearance of band gaps,
i.e., frequency ranges in which no propagative (energy-carrying) states can exist in the crystal. It was
quickly recognised that linear defects in PCs can support localised eigenmodes with frequencies lying
in the band gaps, and thus they can serve as waveguides [10]. Simultaneously, point defects in PCs
were shown to act as resonant cavities with potentially very large quality factor–mode volume ratios
[10]. However, it was the discovery that modes in PC waveguides can propagate around extremely sharp
bends essentially without scattering losses [11] that led to an enormous increase of the interest in PCs as
a possible means for further miniaturisation of optical ICs. Indeed, the bending radii of standard rib or
ridge waveguides need be on the order of millimetres in order to keep the losses at a reasonable level [10].
Since then, an overwhelming number of optical components made of interconnected PC waveguides and
cavities have been proposed, and several of them have seen experimental realisation. For a relatively
recent review of the current state of research on PCs, see ref. 12.
While the early studies of PCs were focused primarily on the quest for structures providing the
widest band gap and on the design of components operating within band gaps, in the last decade more
and more attention has been devoted to the unusual properties of PCs outside band gaps. In contrast
to homogeneous dielectrics, in which the equifrequency surfaces (EFSs) have the form of ellipsoids,
the shape of the EFSs of PCs can be very complicated.? They can contain flat or even concave areas
separated by sharp corners or edges. In addition, the group velocity need not point away from the origin
of the reciprocal space. This richness of the dispersion relation gives rise to unusual phenomena [13],
such as negative refraction of light [14], appearance of supercollimated beams [15] and the superprism
effect [16]. Thus, it has been recognised that even defect-free (except for the presence of surfaces) PCs
can constitute useful devices, for instance flat lenses [17, 18] or beam splitters [19].
1.2 Outline of the thesis
This thesis naturally splits into three parts. In chapters 2 and 3 we study defect-free two-dimensional
(2D) PCs limited by one or two parallel surfaces. In particular, we are interested in the dependence of
their properties on the structure of the interfaces separating them from the adjacent homogeneous media.
In chapter 2 we introduce the single-mode approximation and use it as a mathematical foundation
for an effective-medium model of 2D PCs. In contrast to most previous work, we do not restrict our
considerations to the case of waves impinging perpendicularly to the PC surface. We show that our
model allows to reproduce the strong dependence of the effective material properties of a PC on the
position of its truncation plane, observed by previous authors [21]. In particular, we demonstrate that
the effective permittivity and permeability derived in the framework of the model are guaranteed to be
real and continuous only if the truncation plane is chosen in certain particular ways. We test the validity
of the model by comparing the values of the specular reflection coefficient it predicts for some specific
PCs against results of rigorous numerical calculations. Since there has been a lot of interest in using
PCs exhibiting the negative-refraction effect as lossless replacements of metamaterials, we pay particular
attention to the accuracy of the effective-index description of bands with negative group velocity. We find,
however, that it leaves much to be desired, especially for large incidence angles and in the evanescent-
wave region. By means of a qualitative theoretical analysis, we argue that this behaviour is not restricted
to the particular PC under study; instead, the low accuracy of the effective-index approximation is due to
the inherent structure of the field of PC modes responsible for negative refraction.
In chapter 3 we consider the problem of reducing the reflection losses occurring at an interface
between a semi-infinite PC and a homogeneous medium. This is an important issue, severely limiting
? This is analogous to what happens in solid-state theory: the Fermi’s surface in a free electron gas is spherical, but in a real
solid it can have a very complex form, sometimes called, fittingly, a monster.
1.3. Notational conventions 17
the performance of practical PC devices, especially those using “bulk” PCs (as opposed to components
based on PC waveguides). We propose to minimise these losses by superposing an additional structure—
antireflection (AR) grating—on the PC surface, and present in detail an algorithm for the design of
compact, wide-angle AR gratings for general 2D PCs. To assess its strengths and limitations, we apply
it to three specific PCs, exhibiting the negative refraction, beam supercollimation, and superprism effect,
respectively. In the first two cases, we obtain gratings ensuring a very significant decrease of the reflection
loss; in the last case, however, the design procedure fails due to the violation of certain assumptions
made in the derivation of our algorithm. The improvement brought by the proposed AR gratings to
the transmission through a PC flat lens (based on the negative-refraction effect) has been confirmed
experimentally [33].
In chapter 4, which constitutes the second major part of this thesis, we shift our attention to more
traditional, waveguide-based optical devices. We study the problem of miniaturisation of optical circula-
tors, one of the last important components whose integrated versions are not yet commercially available.
We build on the design of a magneto-optical PC-based circulator proposed in 2005 by Wang and Fan
[34, 37]. It consists of three PC waveguides coupled to a special PC cavity supporting a pair of modes
whose frequencies are split in the presence of a static external magnetic field (SEMF). The mode fre-
quency splitting of the original cavity from refs. 34 and 37 is negligible in a uniform SEMF; it can only be
augmented if the magneto-optical material in the cavity is divided into many oppositely polarised mag-
netic domains, each having the area of a fraction of µm2. Fabrication of such domains presents serious
experimental difficulties, as it requires a precise control of the applied SEMF on the nanometre scale.
Here, using an analytical model of an axisymmetric resonant cavity, we show how to design cavities
exhibiting maximum frequency splitting in a uniform SEMF. We present 2D numerical simulations of
two classes of circulators containing the proposed cavities: PC-based circulators, similar to those studied
in refs. 34 and 37, and circulators in which the PC coating is dispensed with and the cavity is coupled
directly to rib waveguides. This elimination of the PC lattice leads to a significant simplification of the
device geometry, without any deterioration of its performance. Subsequently, we comment briefly on the
results of the experimental tests of the proposed devices that have been done in Institut d’Electronique
Fondamentale (Orsay, France). They reveal a significant problem with the original design of the resonant
cavities: large out-of-plane radiation losses. In the final part of chapter 4 we report on the initial results
of full three-dimensional (3D) simulations of the cavities, which show that the above problem may be
overcome by an appropriate adjustment of the geometry of the cavity.
In the last part of this thesis, chapter 5, we present several numerical methods developed for the sake
of simulating some of the devices analysed in the earlier chapters. We start by discussing the extension
of the multiple-scattering method, widely used to handle the problem of light scattering by finite PCs,
to the case of 2D PCs containing gyrotropic materials. Next, we show how the band structures of 2D
PCs composed of circular cylinders can be calculated to great accuracy using Fourier-Bessel expansions;
remarkably, no lattice sum computations are necessary. Finally, we describe the implementation of the
finite-element method for the calculation of eigenmodes of open, axisymmetric, 3D cavities containing
gyrotropic materials.
1.3 Notational conventions
Throughout this thesis, symbols embellished with arrows (e.g., aE) will denote column vectors; with
bars (aN), row vectors; and with hats (aO), matrices, tensors or operators. Complex conjugation will be
indicated by an asterisk (), transposition by the symbol T, and Hermitian conjugation by a dagger ().
A unit vector in a given direction  will be written as eE . In particular, the unit vectors directed along the
axes of a Cartesian coordinate system will be denoted by eEx , eEy and eEz , and of a cylindrical coordinate
18 Chapter 1. Preliminaries
system, by eE, eE and eEz . Vector operators will be written using the nabla symbol; thus, rEa, rE  aE
and rE  aE will denote the gradient, divergence and curl of a or aE. Finally, unless otherwise noted, the
terms permittivity, permeability, impedance, admittance and immittancewill refer to relative permittivity,
permeability etc.
1.4 Maxwell’s equations
The electromagnetic fields in PCs and other optical systems are governed by Maxwell’s equations [60,
61]. For convenience, we shall gather here the forms of these equations that will be most often refer-
enced in later chapters of this manuscript. Since we shall only be concerned with the propagation of
electromagnetic waves with wavelength much larger than the atomic dimensions (typically  > 1 µm),
we shall be using the macroscopic (phenomenological) Maxwell’s equations, in which the effects of
light-matter interaction are taken into account by help of so-called material parameters.
The most general differential form of macroscopic Maxwell’s equations is [61, eq. (I.1a)]
rE  E  @B
E
E = E ; (1.1a)@t
rE  E @D
E
H = E C J
E; (1.1b)
@t
rE DE = ; (1.1c)
rE  BE = 0; (1.1d)
where EE denotes the electric field, HE the magnetic field, DE the electric displacement field, BE the mag-
netic induction,  the free charge density and JE the free current density. All quantities are, in general,
functions of the position rE and time t ; for conciseness, this dependence has not been written explicitly.
Throughout this thesis we shall assume all fields to be time-harmonic, i.e., to depend on time as e i!t ,
where i is the imaginary unit and ! the (angular) frequency. In this case, differentiation over t reduces
to multiplication by . i!/ and hence eqs. (1.1) become
rE EE = i!BE; (1.2a)
rE HE =  i!DE C JE; (1.2b)
rE DE = ; (1.2c)
rE  BE = 0: (1.2d)
The fields DE and BE are related to EE and HE by so-called constitutive relations. We shall be dealing only
with linear media, in which these relations take the form
E O  E Cp O˛  pD =   E   H and BE =   Oˇ0 0 0 0 0 E C 0O HE; (1.3)
where 0 and 0 denote the (absolute) permittivity and permeability of free space, O and O are the
dimensionless (relative) position-dependent permittivity and permeability tensors of the system under
study, and O˛ and Oˇ describe the strength of the magneto-electric coupling in this system. In the vast
majority of materials used in practice, the elements of the two latter tensors are very small and can be
neglected, as we shall do in the following. We shall also usually consider situations in which no free
1.4. Maxwell’s equations 19
charges or currents are present. Using all the above assumptions, eqs. (1.1) can be brought into the form
rE EE = i!0O HE; (1.4a)
rE HE =  i!0O EE; (1.4b)
rE  .O EE/ = 0; (1.4c)
rE  .O HE / = 0: (1.4d)
It should be noted that owing to the identityrE .rE FE/ = 0, valid for any vector field FE [60, eq. (A1.17)],
eqs. (1.4c)–(1.4d) follow automatically from eqs. (1.4a)–(1.4b) as soon as the field is not static (! ¤ 0),
and therefore can be omitted.
In a large part of this manuscript we shall analyse 2D systems, in which the material properties O
and O are invariant with respect to translations along a privileged axis, called  in the following. Under
the additional conditions that (i) the fields EE and HE are also independent from  (the case of in-plane
propagation) and (ii) the tensors O and O have the block form
" # " #
O 0E O 0E
O = tN and O =
t
N (1.5)0  0  ;
eqs. (1.4a)–(1.4b) split into a pair of uncoupled systems of equations. Specifically, denoting by EEt, HEt
and rE t the components of the vectors EE,HE and rE perpendicular to  , we obtain
rE t HEt =  i!0E ; (1.6a)
rE t  .EeE/ = i!0O t HEt (1.6b)
and
rE t EEt = i!0H ; (1.7a)
rE t  .HeE/ =  i!0Ot EEt: (1.7b)
It can be easily seen that eqs. (1.6) contain only the E and HEt field components, whereas eqs. (1.7)
contain solely EEt and H . A field satisfying eqs. (1.6) and having EEt = 0 and H = 0 will be called
s-polarised. Conversely, a field satisfying eqs. (1.7) and having E = 0 and HEt = 0 will be called
p-polarised.

Chapter 2
Effective-medium model of photonic crystals
2.1 Introduction
As mentioned in section 1.1, a crucial feature of photonic crystals (PCs) is the richness of their disper-
sion relation. The shape of PC equifrequency surfaces can be very complex: they can contain sharp
corners or edges separating flat or even concave areas. However, at specific frequencies, they can also
attain ellipsoidal shape, characteristic for homogeneous media. In consequence, the question arises if
the crystals can then be successfully described by the effective-medium model, in which they are ap-
proximated by a homogeneous material with specific values of permittivity  and permeability —or,
equivalently, refractive index n = ./1=2 and impedance  = .=/1=2. Since homogeneous materials
are incomparably easier to analyse than structured ones, an answer in the affirmative would facilitate the
development of PC devices, especially those using the negative-refraction effect [14]. Indeed, most com-
ponents employing this phenomenon, like the famous superlenses [17], have been designed essentially
with homogeneous negative-index materials, first analysed by Veselago [20], in mind.
Numerous papers dealing with this subject have already been published [21–32], giving rise to sev-
eral competing definitions of the effective parameters of PCs, which will be reviewed in subsection 2.2.2.
Unfortunately, as a rule, these definitions have been only heuristically motivated and lack a formal justifi-
cation. Moreover, the ultimate verification of each such a definition, the comparison of the true reflection
coefficient of the crystal with that of the corresponding effective medium, has so far been performed only
for normal [24–26] or near-normal [28] incidence. Yet many applications, including those involving neg-
ative refraction, rely on waves incident at large angles, as well as evanescent ones. The range of validity
of the effective-medium approximation is, therefore, still poorly known.
The aim of the work presented in this chapter is to address these shortcomings. In section 2.2 the
concept of the single-mode approximation is used to provide a mathematical justification for a particular
definition of the effective parameters of two-dimensional (2D) PCs. In section 2.3 we study the influence
of the symmetry of the crystal’s truncation plane and of the electromagnetic fields of its eigenmodes on
the behaviour of its effective parameters, generalising the theorems obtained by Pierre and Gralak [27]
in the one-dimensional (1D) case. To assess the accuracy of the effective-medium model, in section 2.4
we compare the values of the specular reflection coefficient predicted within the model’s framework with
the results of rigorous numerical calculations. These tests are done for two different crystals at a number
of frequencies and in the full range of incidence angles. This leads to a detailed discussion of the appli-
cability conditions of the single-mode approximation itself (section 2.5). We conclude that as far as the
bands responsible for negative refraction are concerned, the single-mode approximation is (moderately)
accurate only close to normal incidence. Thus, it does not make much sense to treat a PC exhibiting neg-
ative refraction as a homogeneous material for large incidence angles or in the evanescent-wave regime.
In consequence, the behaviour of systems containing homogeneous negative-index materials can change
21
22 Chapter 2. Effective-medium model of photonic crystals
z z
refracted excited
wave eigenmodes
O2; O 2
z0 z0
1; 1
diffracted
incident reflected incident waves
wave wave wave
x x
(a) (b)
Figure 2.1 Schematic diagrams of the fields generated by an s- or p-polarised plane wave incident from an
isotropic homogeneous medium on the surface of (a) another homogeneous medium and (b) a photonic crystal.
significantly if these materials are replaced with PCs, even if the equifrequency surfaces (and so the
phase refractive indices) of both media are the same.
A substantial part of the results presented in this chapter has previously been published in refs. 62
and 63.
2.2 Definition of the effective parameters of photonic crystals
2.2.1 Preliminaries: the homogeneous-medium case
In the effective-medium approximation, a lossless 2D PC is modelled by a lossless, homogeneous, pos-
sibly anisotropic medium with one optical axis oriented along the invariant direction of the PC, hereafter
taken to lie along the y axis. We shall begin with a brief analysis of the refraction of a plane wave inci-
dent on the interface between an isotropic medium, labelled 1, with permittivity 1 and permeability 1,
occupying the z < z0 half-space, and this anisotropic material, labelled 2, characterised by tensorial O2
and O 2, lying in the z > z0 half-space [fig. 2.1(a)]. The wave is taken to propagate in the xz plane.
For the sake of simplicity, we shall restrict our attention to PCs whose point group includes a mirror
plane perpendicular to the x or z axis or a three-fold rotation axis parallel to the y axis. In these cases,
by Neumann’s principle (“the symmetry elements of a physical property of a crystal must include the
symmetry elements of the crystal point group” [64, p. 14]), the tensors O2 and O 2 become diagonal in the
chosen coordinate system,
2 3 2 3
2x 0 0 2x 0 0
O2 = 4 0  5 42y 0 ; O 2 = 0 2y 0 5 : (2.1)
0 0 2z 0 0 2z
Maxwell’s equations (1.6) can then be used to derive the dispersion relation of, say, s-polarised plane
waves (with electric field perpendicular to the propagation plane) with wave vector kE = kxeEx C kzeEz
propagating in medium 2,
k2 k2 !2 2x C z = 1 with K2    and K2 !x 2y 2z z  2y2x ; (2.2)K2 K2 c2 c2x z
2.2. Definition of the effective parameters of photonic crystals 23
 pwhere ! denotes the frequency and c 1= 00 the speed of light defined in terms of the (absolute)
permittivity 0 and permeability 0 of free space. Thus, the equifrequency curve (EFC) of material 2 is
an ellipse with principal axes of length 2Kx and 2Kz .
When a plane wave with wave vector kE1 = kxeEx C k1zeEz falls on the interface separating media 1
and 2, reflected and refracted waves, with wave vectors kE01 = kxeEx   k1zeEz and kE2 = kxeEx C k2zeEz ,
respectively, are generated. By imposing the continuity conditions at z = z0 on the field components par-
allel to the interface, the well-known Fresnel’s formulas for the amplitude of the reflected and refracted
waves can be derived:
2x=k2z   1=k= 1zr C ; (2.3a)2x=k2z 1=k1z
22x=k= 2zt C : (2.3b)2x=k2z 1=k1z
These formulas can be written in a concise way by introducing the notion of transverse impedance of a
material, defined as
E
= j tZj .j = 1; 2/; (2.4)
p
Z0Hj t
where Z0 0=0 denotes the (absolute) impedance of free space, and Ej t (Hj t) is the amplitude of
the transverse, i.e., parallel to the interface, component of the electric (magnetic) field of a plane wave
E 0 Epropagating in the j th material in the given direction k . Since in our case E = E = E eikj rEj j t jy jy ,
H =  H = .i!  / 11t 1x 0 1 @E1y=@z = .k1z=!01/E1y , andH2t = .k2z=!02x/E2y , we obtain
! 
= jxZj (2.5)
c kjz
and
Z2  Z1 2Z
r = 2C ; t = C : (2.6)Z2 Z1 Z2 Z1
By the duality theorem [65, p. 72–73], analogous results for p-polarised waves can be obtained by
substituting  HE , EE, O and O for EE,HE , O and O , respectively. Equations (2.6) must then be replaced by
Y2   Y1 2Y
r = 2C ; t = C ; (2.7)Y2 Y1 Y2 Y1
where
! 
= jxYj (2.8)
c kjz
is the transverse admittance of j th material. Introduction of the notion of transverse immittance  of a
medium, defined as its transverse impedanceZ in the s-polarisation case and its transverse admittance Y
in the p-polarisation case, lets us write the Fresnel’s formulas (2.6) and (2.7) in a unified way:
2  1 2
r = 2C ; t = C : (2.9)2 1 2 1
2.2.2 Existing definitions
Several authors [24–26, 28, 66] have attempted to generalise the concept of transverse immittance to non-
homogeneous media, the main obstacle being, obviously, that in such media the ratio Et=Ht is spatially
dependent. The most straightforward is to define  as the ratio of the spatial field averages over the
24 Chapter 2. Effective-medium model of photonic crystals
surface unit cell, as proposed by Lu and Prather [26]; while this might seem an oversimplification, in
subsection 2.2.3 we shall show that this approach is in fact rigorous if the single-mode approximation,
defined in the same subsection, is valid. In an attempt to preserve more information from the detailed
field structure, other authors [24, 25, 28, 66] suggested empirical definitions of the transverse impedance,
expressed in terms of the average electromagnetic energy and Poynting vector of the dominant crystal
eigenmode. However, no mathematical justification of these definitions has been given.
Efros and Pokrovsky [23] and later Decoopman et al. [21] proposed an entirely different procedure.
They considered the perturbation of the incident electromagnetic field caused by a PC slab embedded in
a homogeneous medium whose permittivity  and permeability  were varied. The values of  and 
corresponding to minimum perturbation were taken as the effective parameters of the crystal. Contrary
to the approaches cited in the previous paragraph, this method is based on a full rigorous solution of
Maxwell’s equations. On the other hand, it requires a significant computational effort since, for each
value of the frequency and angle of incidence, simulations need to be performed for multiple, possibly
complex, values of  and  of the homogeneous medium. Therefore, it is not well-suited to the analysis
of the general behaviour of the effective parameters, for which an—even approximate—semianalytical
approach would be useful.
Finally, some authors [29–32] proposed definitions of effective parameters based on the extended
Maxwell’s-Garnett theory, where the crystal unit cell is replaced by a coated cylinder (or sphere) embed-
ded in a homogeneous host medium whose parameters are determined from the condition of vanishing
scattering, calculated by the Mie theory. This approach enabled them to reproduce the band structure
of PCs, usually composed of dispersive (e.g., polaritonic) materials, with good accuracy. Nevertheless,
the effective parameters they obtained are independent from the choice of the crystal truncation plane,
whereas one of the key observations of Decoopman et al. [21] was the strong variability of effective 
and  with the position of the crystal surface. Thus, the parameters introduced in refs. 29–32 could not
be used to determine accurately the reflection coefficient of a truncated PC.
2.2.3 Proposed definition
To arrive at the proper definition of the effective parameters of PCs, let us consider a semi-infinite 2D
PC invariant along the y axis, on whose surface, z = z0, an s- or p-polarised plane wave with wave
vector kE = kxeEx C kzeEz is incident [fig. 2.1(b)]. Owing to the system’s periodicity in the x direction,
the reflected field will comprise infinitely many diffraction orders. Similarly, the transmitted field will
be a superposition of infinitely many crystal eigenmodes (propagative and evanescent) characterised by
different wave vectors. In contrast, as we have seen in subsection 2.2.1, if the crystal were replaced
by a homogeneous material, only one transmitted plane wave would be excited. The effective-medium
approximation can therefore be reasonably expected to give a good picture of reality only when some
crystal eigenmode is excited with an amplitude significantly greater than the others. In other words, the
validity of the effective-medium approximation is constrained by that of the single-mode approximation,
which consists in neglecting all crystal eigenstates but the dominant one. We shall now show how this
approximation leads to a natural definition of the crystal’s effective parameters.
In the remaining part of this chapter we shall focus on s-polarised waves; formulas corresponding to
p polarisation can be derived using the duality theorem and will be omitted for brevity. For the chosen
polarisation, the electric field reduces to its component along the y axis, and Maxwell’s equations (1.6)
take the form
@Ey = i!0Hz; (2.10a)
@x
@Ey =  i!0Hx; (2.10b)
@z
2.2. Definition of the effective parameters of photonic crystals 25
@Hz   @Hx = i!0Ey : (2.10c)
@x @z
We shall solve these equations separately in the homogeneous region and in the PC, and then match the
solutions at the crystal surface by imposing the continuity of the Ey andHx components, in accordance
with Maxwell’s boundary conditions.
We assume the PC to be oriented so that a (not necessarily primitive) rectangular unit cell .ax; az/
can be defined. The whole system is periodic with respect to the variable x, so it is possible to perform
a Floquet-Bloch transform [13, 67] of the Maxwell’s equations (2.10). After this transform, as is well
known from grating theory, the solution of the Maxwell’s equations in the homogeneous region is given
by the Rayleigh’s expansion [68, 69]
Eh.x; z/ = eiŒkxxCˇ0.z 
X
z0/C r eiŒ.kxCGxn/x ˇn.z z0/y n ; (2.11)
n2Z
whereG  2 n=a and ˇ  Œ  .!=c/2 .k CG /21=2xn x n 1 1 x xn with the sign of the square root chosen
so that ReˇnCImˇn  0. In the crystal, we can expand the field in terms of the PC eigenmodes with the
x component of the Bloch vector equal to kx , taking into account (i) propagative modes carrying energy
in theCz direction and (ii) evanescent modes decaying in the same direction [13, 41–43, 70–72]. These
modes can be determined by several methods, most of which utilise some variant of the scattering-matrix
algorithm [73]; in the numerical calculations presented later in this chapter we have used the differential
method [69, 74–76]. The electric field of themth eigenmode with Bloch vector Em = kxeEx C mzeEz can
be written as a 2D Fourier expansion w npXith cXoefficients .um /n;p2Z:
E .x; z/ = unp eiŒ.kxCGxn/xC.mzCGzp/zmy m ; (2.12)
n2Z p2Z
where G  2 p=a .?zp z Thus, the total electric fiXeld in the crystal will be
Ecy.x; z/ = tmEmy.x; z/ (2.13)
m2N
with “transmission coefficients” tm denoting the amplitudes of individual modes.
The requirement of continuity of E andH =  .i! / 1y x 0 @Ey=@z at z = z0 leads to
X
eikxxC r ei.kxCGxn/xn
X n XX C C C (2.14a)= t np iŒ.kx Gxn/x .mz Gzp/z0m um e ;
m
iˇ X
n p
0 ik x   iˇe x n r ei.kxCGxn/xn
1 X X n X1 (2.14b)
= tm i.
np iŒ.kxCGxn/xC.mzCGzp/z0
mz CGzp/um e :
m n p
R
Using the identity 1 e2 inx0 dx = ın0, where ınm equals 1 if n = m and 0 otherwise, we arrive at the
? Since we shall be studying the influence of shifting the surface of the crystal with respect to the origin of its unit cell, it is
convenient to expand the field in the PC [eq. (2.12)] about the fixed point .0; 0/ rather than the point .0; z0/ anchored on
the surface.
26 Chapter 2. Effective-medium model of photonic crystals
following inhomogeneous system of linear equatioXns with unknowns .rn/n2Z and .tm/m2N:
ı C r = unn0 n mtm; (2.15a)
iˇ Xmn
.ın0   rn/ = vnmtm; n 2 Z; (2.15b)1 m
with the coefficient n nXs um and vm defined as X
un  unp ei.mzCGzp/z0 ; vn  i. CG /unp ei.mzCGzp/z0m m m mz zp m : (2.16)
p p
This system can be written in the matrix form
" O #" # " # I uO rE aE
Oˇ O E = E0 ; (2.17)i =1 v t a
where IO denotes the identity matrix, uO and vO are matrices with elements un and vn (the row and column
indices being denoted by super- and subscripts, respectively), Oˇ
m m
is the diagonal matrix of the coeffi-
cients ˇ , rE and tE are column vectors of the coefficients r and t , and the vectors aE and aE0n n m , whose
elements are given by
a  ı ; a0n n0 n  iˇ0ın0=1; (2.18)
represent the incident field.
If the crystal were replaced by a homogeneous medium, the only nonzero reflection coefficient would
be the specular one, r0. Using eqs. (2.15) corresponding to n = 0, the following relation between r0 and
the transmission coefficients of individual modes can be derived:
r0 = P
P
0 0
mŒum   .1=iˇ0/vmtm
C : (2.19)Œu0m m .1=iˇ0/v0mtm
As we have already seen, the effective-medium approximation relies on the assumption that the trans-
mission coefficient of a particular (dominant) mode is much larger than of all others; without loss of
generality, we can denote this mode with the index 1, so that our assumption reads jt1j  jt2j; jt3j; : : :
If it holds, expression (2.19) reduces to
 iu
0
1=v
0
1   1=ˇ0r0 C : (2.20)iu01=v01 1=ˇ0
Comparing eq. (2.20) to the Fresnel’s formula (2.3a) and noting that ˇ0 and k1z denote the same
physical quantity—the z component of the wave vector of the incident plane wave—we conclude that
iu0=v01 1 in eq. (2.20) corresponds to 2x=k2z in eq. (2.3a). In the homogeneous-medium case, k2z
is the z component of the wave vector of the refracted wave. Assuming that the EFC of the crystal
at the considered frequency can be approximated by an ellipse with semiaxes Kx and Kz and centre
KE0  .K0x; K0z/, as shown in fig. 2.2, it is natural to identify k2z in the PC case with the z component
of the Bloch vector of mode 1 measured from the centre of this ellipse, i.e., 01z  1z   K0z . In this
way, we arrive at the following definition of the effective x of the crystal:
0 u0 = i 1x 1z : (2.21)
v01
2.3. Influence of symmetries on the effective parameters 27
kz
E0
1
Kx
E1
Kz
KE0
kx
Figure 2.2 Relationship between the vectors KE , E and E00 1 1.
The dispersion relation (2.2) provides then the formulas for the effective z and y ,
K2x 1 K
2
z =  ;  =
z
x y ; (2.22)
K2  !2 2z x =c
and eq. (2.5), for the effective transverse impedance,
! iu0
Z = 1 : (2.23)
c v01
Thus, within the framework of the single-mode approximation the PC produces the same reflected wave
as the homogeneous medium with material parameters given by eqs. (2.21) and (2.22).
Finally, we note that the definition (2.23) of the effective transverse impedance agrees with that
given by Lu and Prather [26, section 3], since from eqs. (2.10b), (2.12) and (2.16) it follows that u01
and  v01=.i!0/ are the average periodic parts of the Ey and Hx fields of mode 1 on the PC surface;
substituting these values to eq. (2.4), we arrive at the expression (2.23).
2.3 Influence of symmetries on the effective parameters
“Standard” lossless homogeneous materials are characterised by purely real ,  and Z. From the
Fresnel’s formula (2.3a) it follows that the reflection coefficient of a plane wave incident on the interface
separating two such materials will also be purely real provided that both the incident and the transmitted
wave are propagative, i.e., k1z and k2z are real. These properties do not always carry over to the PC case.
Indeed, Pierre and Gralak [27] proved that for 1D PCs they are guaranteed to hold only if the crystal is
truncated along one of its mirror symmetry planes; otherwise, the effective material properties and the
reflection coefficient may take complex values.
Since the effective-medium description of PCs is an approximation, one might expect their effective
material properties to have some kx-dependence. This does no harm as long as the variation with kx is
fairly small. However, ref. 27 demonstrates that the effective parameters of a 1D PC cut elsewhere than
along a mirror symmetry plane may diverge at the value of kx where the crystal eigenmode turns from
propagative to evanescent. In consequence, the usefulness of the effective-medium model in this case is
rather limited.
In this section we shall extend the results from ref. 27 to the 2D case. It should be noted that in 1D
systems mirror planes are in fact identical with inversion centres and two-fold rotation axes, so that a
priori it is not obvious which of them turn out to be crucial in 2D.
28 Chapter 2. Effective-medium model of photonic crystals
2.3.1 Real-valuedness
We shall now prove the following sufficient condition for the real-valuedness of the effective parameters
and the specular reflection coefficient of 2D PCs.
The reflection coefficient r0 and the effective parameters x , z , y , and Z of a 2D PC are real if:
(i) both the incident wave and the dominant eigenmode are propagative, i.e., ˇ0 and 1z are real,
(ii) the truncation plane z = z0 contains an inversion centre of the infinite crystal,
(iii) the single-mode approximation is valid.
Simple inspection of eqs. (2.20)–(2.23) shows that if the assumptions (i) and (iii) are fulfilled, the
proposition is true provided the ratio i 0 0 is real. This expression involves the Fourier coefficients npu1=v1 u1
of the electric field of the dominant PC mode. By assumption (i), this mode is propagative, and therefore
the coefficients in question can be obtained with the standard plane-wave method as described in ref. 77.
Now, if the crystal is centrosymmetric with respect to a point .x0; z0/, the electric field of the mode can
be written as XX
E .x; z/ = uQnp eiŒ.kxCGxn/.x x0/C.z1CGzp/.z z0/1y 1 ; (2.24)
n p
where Qnpu1 are the elements of a vector equal to the product of a real diagonal matrix and an eigenvector
of a real symmetric matrix [77]; hence, they can be taken to be real. Comparing eq. (2.24) with the
general formula (2.13), we obtain
np = Qnpu u e iŒ.kxCGxn/x0C.z1CGzp/z01 1 ; (2.25)
and, using eqs. (2.16), we arrive at
P
0 P Q0piu u1 = p 1 : (2.26)
v0 0p1 p.1z CGzp/uQ1
Owing to the real-valuedness of Qnpu1 and 1z , the above expression is real, and the proposition follows.
On the contrary, if the interface contains no symmetry centres, a complex Hermitian eigenvalue
problem is solved in the plane-wave method, so that the eigenvector elements Qnpu1 need not be real, and
neither does iu0=v01 1 .
2.3.2 Continuity and boundedness
Preliminaries We proceed to the investigation of the behaviour of the effective permittivity and per-
meability of a 2D PC near a value of kx at which its dominant eigenmode turns from propagative to
evanescent, i.e., near a vertex KE = .K ˙ K ;K / of the elliptical EFC. At such a point, 0v˙ 0x x 0z 1z is
zero; according to eqs. (2.21) and (2.22), this implies  =  = 0 and j j ! 1 unless v0x z y 1 is zero at
the same time. In this subsection we shall study the circumstances in which this necessary condition for
the continuity and boundedness of y at the transition point is guaranteed to be met. The considerations
are necessarily somewhat technical; the reader not interested in mathematical details can skip to the last
paragraph of this subsection, where the obtained results are summarised.
We shall limit the discussion to PCs whose geometry is described by one of the symmorphic space
groups.? Eigenmodes with a given Bloch vector kE can then be classified in terms of the irreducible
? A symmorphic space group is a space group that contains all elements of its point group [78, p. 18]. This means, in
particular, that the set of its generators must consist solely of pure rotations and mirror reflections (no screw rotation axes
and glide planes are allowed).
2.3. Influence of symmetries on the effective parameters 29
representations of the largest common subgroup of the PC’s point group and the group of kE, i.e., the
group of symmetry operations leaving kE invariant or transforming it to a Bloch vector kE0 differing from
kE by a reciprocal-lattice vector [79, chap. 3; 80, chap. 8].
If a vertex KEv˙ is located at a general reciprocal-space point, whose group consists solely of the
identity operation I , no constraints on the symmetry of the corresponding eigenmode can be obtained.
However, if K0z = 0 or K0z =  =az—as, in practice, is very often the case—the group of KEv˙ contains
additionally the operation of mirror reflection with respect to the x axis,  .?x It follows that if the crystal
itself has mirror planes parallel to x, the electric field of an eigenmode with Bloch vector KEv˙ is either
symmetric or antisymmetric with respect to reflection about each of these planes. We shall assume the
origin of the coordinate system to be chosen so that the mirror planes lie at z = 1qaz for all q 2 Z (it2
is easy to see that there are always two parallel planes per a rectangular unit cell). Let us now consider
separately the cases of K0z = 0 and K0z =  =az .
The case of K 0 Setting 0 to K = 0 in the definition (2.16) of v00z = 1z 0z 1 and using the definition of
Gzp, we get
2 i X
v0 = 0ppu e2 ipz0=az1 1 : (2.27)az
p2Z
Consider first the case of an eigenmode whose electric field E1y.x; z/ is symmetric with respect to
reflection about the plane z = 0, i.e., E1y.x; z/ = E1y.x; z/. Expression (2.13) for E1y.x; z/ and the
orthogonality of the Fourier basis yield
n; p = npu1 u1 for all n; p 2 Z: (2.28)
It is easy to check that the above condition guarantees also the symmetry of E1y.x; z/ with respect to all
the other mirror planes z = 1qaz . Substituting eq. (2.28) into eq. (2.27), we obtain2
0  4 
X
= 0p
2 pz
v1 pu1 sin
0
: (2.29)
az az
p>0
Without further constraints on 0pu , the coefficient v01 1 is guaranteed to be null only if 2 z0=az is an
integral multiple of  , so that all the sine factors vanish. With z0 restricted to the first unit cell (0  z0 <
a ), this is equivalent to z = 0 or z = 1z 0 0 az . Thus, the crystal should be truncated along one of its mirror2
planes.
If the PC is based on a hexagonal or centred rectangular Bravais lattice, its primitive cell is two times
smaller than the rectangular unit cell .ax; az/ we are using. It can then be shown that half of the Fourier
coefficients npu1 , namely those with nC p odd, vanish. As a result, eq. (2.29) becomes
8  X0 =   0;2p 4 pzv1 pu1 sin 0 : (2.30)az az
p>0
It follows that all the sine factors, and hence the total sum too, will vanish on two more planes per unit
cell: z = 10 az and z0 = 3az .4 4
Let us now proceed to the case of electric field antisymmetric with respect to the plane z = 0. Instead
of eq. (2.28) we have then
n; p =   npu1 u1 for all n; p 2 Z: (2.31)
? Note in particular that the vector x.K0x ˙Kx ;  =az/ = .K0x ˙Kx ;  =az/ is equivalent to .K0x ˙Kx ;  =az/, since
they differ by the reciprocal-lattice vector .2 =az/eEz .
30 Chapter 2. Effective-medium model of photonic crystals
and the sines in eq. (2.29) are replaced by cosines. To ensure that 0 vanishes for all sequences 0pv1 .u1 /p2N,
to each p must correspond a q 2 such that 2 pz =a = .q C 1Z 0 z / . It is easy to see that this condition2
cannot be fulfilled for any value of z0. For a PC based on a hexagonal or centred rectangular Bravais
lattice, the condition becomes 4 pz =a = .q C 10 z / , which has no solutions, either.2
The case of K0z = pi/az Instead of eq. (2.27), we have
 i X0 = 0pv .2p C 1/u e i.2pC1/z0=az1 1 : (2.32)az
p2Z
Substitution of the expression (2.13) for E1y.x; z/ to the condition of symmetry/antisymmetry with
respXectXto plane z = 0, E1y.x; z/ = ˙E1y.x; z/, yields
unp eiŒ.kxC
XX
2n =ax/xC.2pC1/ z=az = ˙ unp eiŒ.kxC2n =ax/x .2pC1/ z=azm m ; (2.33)
n p n p
so that from the orthogonality of the Fourier basis we obtain
unp = ˙un; p 1m m for all n; p 2 Z: (2.34)
It can also be shown that a mode with kz =  =a that is symmetric with respect to the plane z = 0 must
be antisymmetric with respect to the plane z = 1az and vice versa; thus, without loss of generality, we2
can take the plus sign in the above equation. Substituting it into eq. (2.32), we get
 i X
v0 = .2p C 0p1/u Œei.2pC1/ z0=az   e i.2pC1/ z0=az1 1 az
p0X C (2.35) 2 i .2p 1/ z= C 0p.2p 1/u1 sin 0 :az  azp 0
Vanishing of v01 is thus ensured if sinŒ.2p C 1/ z0=az = 0 for all integer p  0, which is equivalent
to z0 = qaz with q 2 Z. This corresponds to placing the truncation plane along a symmetry plane of
the electric field of the crystal’s dominant eigenmode. The situation is the same if the PC is based on
a hexagonal or centred rectangular Bravais lattice: the condition for vanishing v01 takes then the form
sinŒ.4p C 1/ z0=az = 0 for all integer p  0, which is again equivalent to z0 = qaz with q 2 Z.
Conclusions From the above considerations we can establish the following rule:
The effective parameters x , z and y are continuous and bounded at the point of the propagative-to-
evanescent transition of the dominant PC eigenmode in the two following cases:
(i)  the transition occurs at kE = kxeEx ,
 the crystal has mirror planes parallel to x,
 the electric field of the dominant mode is symmetric with respect to these planes, and
 the crystal is truncated along one of these planes or, provided it is based on a hexagonal or
centred rectangular Bravais lattice, midway between these planes;
(ii)  the transition occurs at kE = kxeEx C  =azeEz ,
 the crystal has mirror planes parallel to x, and
 the crystal is truncated along a symmetry plane of the electric field of its dominant eigen-
mode.
2.4. Examples 31
a
0:5
0:4
0:3
plane 3 p
3a 3=8 0:2
plane 2 p
a 3=4
plane 1 0:1
0
  M K  
(a) (b)
Figure 2.3 (a) Geometry of the hexagonal-lattice PC analysed in the text. Horizontal lines mark the position of
truncation planes 1, 2, and 3; inversion centres of the PC located at these planes are marked with crosses. (b) Band
structure of the crystal shown in part (a). Horizontal lines mark the frequency values ! = 0:14  2 c=a and
0:259  2 c=a.
This rule is not a rigorous theorem. First, the sufficiency of the above conditions has not been proved.
Assuming that the Taylor expansions of u01.
0
1z/ and v
0 0
1.1z/ about 
0
1z = 0 exist, the formula (2.21)
for x can be written as
0 
0 u01z 1.0/C .0 2 0 0 01z/ .du1=d1z/ C   
 . / = i 1z
=0
x 1z C 0 0 C    : (2.36)v01.0/ 1z.dv01=d /01z 1z=0
The effective permeability x is then finite and different from zero if and only if exactly q   1 lowest
derivatives of u01 and q lowest derivatives of v
0
1 , where q 2 N, vanish at 01z = 0. We have proved that
in the two cases listed above v01.0/ vanishes; it can also be shown that in these cases u
0
1.0/ is in general
non-zero. However, the proof that .dv0 0 01=d1z/ =0 does not vanish is missing.1z
Second, the above conditions have not been proved to be strictly necessary. Indeed, the coefficients
0p
u1 can accidentally take such values that v
0
1 will vanish for some “random” truncation. This does not
seem to be a major problem, though, and one should probably treat these situations like, for instance,
accidental degeneracies in group theory.
These reservations notwithstanding, in the following section it will be shown that the effective pa-
rameters of two typical PCs at several distinct frequencies behave exactly as predicted by the above rule.
So far, the author has not found any counterexample to it.
2.4 Examples
In this section we shall apply the theory presented above to the cases of two specific PCs, one with a
hexagonal and one with a square lattice. In particular, the predictions of the effective-medium model will
be compared with the results of numerical calculations made with the differential method [69, 74–76].
2.4.1 Hexagonal lattice
To begin with, we consider the crystal shown in fig. 2.3(a): the hexagonal lattice of air holes of radius
0:35a, a being the lattice constant, embedded in a dielectric matrix with  = 16. Figure 2.3(b) presents
its Brillouin diagram. At the frequency ! = 0:14 2 c=a, the EFC of the single s-polarised propagative
crystal eigenmode has the shape of a circle centred at the   = .0; 0/ point [fig. 2.4(a), middle diagram,
solid line]. In figs. 2.5(a), (d) and (g) the specular reflection coefficient of this crystal at the quoted
!a=2 c
32 Chapter 2. Effective-medium model of photonic crystals
1:50
(a) (b)
1:25 n D  2
n D  2
1:00
0:75
n D  1
0:50 n D  1
0:25  D 4
 D 2
 D 1
0:50 n D 0
nD 1
0:25
n D 0
0:00
0:25
0:00 0:25 0:50 0:00 0:25 0:50
kxa=2  kxa=2 
Figure 2.4 The EFCs at frequency (a) ! = 0:14  2 c=a andp(b) ! = 0:259  2 c=a of three PCs of the
type shown inpfig.p2.3(a) with the same average refractive index h i = 2:67, but different values of the index
contrast  = b= h between the background and the holes: b = 16, h = 1,  = 4 (solid lines), b = 11:76,
h = 2:94,  = 2 (dotted lines), and b = h = 7:11,  = 1 (dashed lines). The middle part of the graphs shows
the EFCs of the real bands (Re kz ¤ 0, Im kz = 0), the bottom one, of the imaginary bands of thpe first kind [81]
(Re kz = 0, Im kz ¤ 0), and the top one, of the imaginary bands of the second kind (Re kz = 2 =a 3, Im kz ¤ 0,
i.e., lying on the edge of the first Brillouin zone). Only the three bands with lowest values of Im kz are shown in
each case. The bands of the empty lattice ( = 1) are labelled with the index n of the harmonic Gxn to which they
correspond. For each mode with wave vector kE visible in the graph, the crystal supports three additional modes
with wave vectors kE,  kE, and  kE [81].
Im kza=2  Re kza=2  Im kza=2 
2.4. Examples 33
1 0:06 1 0:10
(a) Im r0 (g)
0:04
0 ! 0 0:05
rel. error
Re 0:02 r0
 1 0:00  1 0:00
4 4
(b) (h)
2 2
0 0
1:0 14 20  =2
(c) (i)
0:9 y ! 13
10 0
0:8  12 10jx j jy jx
argx arg y
0:7 11 0   =2
0:0 0:1 0:2 0:3 0:4 0:5 0:0 0:1 0:2 0:3 0:4 0:5
kxa=2  kxa=2 
1 0:15
(d)
0:10
0
0:05
 1 0:00
4
(e)
2
0
1:5 10
(f)
1:4
9
1:3
8
1:2
1:1 7
0:0 0:1 0:2 0:3 0:4 0:5
kxa=2 
Figure 2.5 (a) The kx-dependence of the specular reflection coefficient r0 of the crystal from fig. 2.3(a) trun-
cated along plane 1, at ! = 0:14  2 c=a. Solid lines: results of rigorous calculations, rn0 ; circles: results of
calculations made in the single-mode approximation, rsm0 ; dashed line: relative error  of the single-mode approx-
imation. The vertical lines at kx = 0:14  2 =a and 0:447  2 =a mark where the incident wave and the single
propagating crystal eigenmode, respectively, turn from propagating to evanescent. (b) Amplitudes of the three
most slowly decaying crystal eigenmodes excited in the above conditions (solid, dashed, and dotted line, in order
of increasing Im kz). (c) Effective x (dark lines) and y (light lines) of the crystal. (d)–(f) and (g)–(i) The same
for planes 2 and 3.
x j j Re r0, Im r0, xtm j j Re r0, Im r0,tm
10jx j, jy j j j Re r0, Im r0,tm
argx , arg y
Relative error
Relative error Relative error
y y
34 Chapter 2. Effective-medium model of photonic crystals
1
0
 1
(a) (b)
Figure 2.6 Real part of the electric field Ey of the modes of the crystal shown in fig. 2.3(a) with (a) ! =
0:14 2 c=a, kx = 0:447 2 =a, and kz = 0, (b) ! = 0:259 2 c=a, kx = 0:259 2 =a, and kz = 0. A mirror
plane of the crystal parallel to its surface is marked with a horizontal line.
1 1:5 2 2
(a) rel.!error
(d)
1:0
 Im r0
0 0 1
 Re r 0:50
 1 0:0  2 0
4 10
(b) (e)
2 5
0 0
0:2 50 0:1 50
(c) (f)
0:0
0:0
y ! 0  0:1 0
 0:2  x  0:2
 0:4  50  0:3  50
0:0 0:1 0:2 0:3 0:4 0:5 0:0 0:1 0:2 0:3 0:4 0:5
kxa=2  kxa=2 
Figure 2.7 Same as fig. 2.5, at frequency ! = 0:259 2 c=a and for truncation planes (a)–(c) 1 and (d)–(f) 2.
Discontinuities in the plots of rsm0 appear at kx = 0:33  2 =a, because at this value of kx the two most slowly
decaying crystal eigenstates “swap places”, and the calculations of rsm0 are always done assuming the mode with
the smallest Im ky to be dominant. The domain of the plots of effective parameters has been restricted to the range
of kx in which the relative error of the single-mode approximation is less than 25%.
frequency is plotted against the x component of the wave vector of the incident plane wave for three
different positions, marked with horizontal lines in fig. 2.3(a), of the interface between the crystal and
the homogeneous medium, taken to be vacuum (1 = 1 = 1). In these graphs, the results of rigorous
numerical calculations (rn0 , solid lines) are juxtaposed with the values obtained from eq. (2.20) derived
in the framework of the single-mode approximation (rsm0 , circles). Evidently, for surfaces containing
inversion centres Im rn0 is very small in the whole range kx < 0:14  2 =a, in which the incident wave
is propagative [figs. 2.5(a) and (d)]. On the contrary, when the termination is chosen in an arbitrary way,
r0 acquires an appreciable imaginary part [fig. 2.5(g)]. This is in agreement with the rule formulated in
subsection 2.3.1.
x
j j Re r0, Im r0,tm
x jtmj Re r0, Im r0,
y
Relative error

Relati yve error
2.4. Examples 35
In all the three graphs, the relative error of the single-mode approximation, defined as   jrsm0  
rnj=jrn0 0 j, is plotted with a dashed line. It is clear that at the chosen frequency (corresponding to the mid-
dle of the first band of the crystal) the single-mode approximation is very accurate for kx corresponding
to propagative incoming waves (kx < !=c); for larger kx , the accuracy degrades slightly, but the relative
error seldom exceeds 10%.
Figures 2.5(c), (f) and (i) present the kx-dependence of the effective x and y at ! = 0:14 2 c=a
for the three different termination planes of the crystal. As shown in fig. 2.6(a), at the chosen frequency
(and in the whole first band) the electric field of the mode with kx = 0:447  2 =a and kz = 0 is
symmetric with respect to the horizontal mirror planes of the crystal. Thus, the conditions enumerated
in point (i) of the rule from subsection 2.3.2 are satisfied for truncation planes 1 and 2, and indeed, as
shown in figs. 2.5(c) and (f), the effective permittivity y is continuous and bounded for these truncation
planes. In contrast, y diverges at kx = 0:447  2 =a when the crystal is truncated along the arbitrarily
chosen plane 3 [fig. 2.5(i)].
It should be noted that shifting the truncation plane has a large influence on the numerical values
of the effective parameters. For instance, at normal incidence, the crystal truncated along plane 1 has
y = 14:0 and x = 0:73, whereas for the truncation plane 2 these values are y = 7:1 and x = 1:43—a
difference of a factor of two. This corroborates the earlier observations of Decoopman et al. [21].
As demonstrated above, at a frequency lying in the first band of the crystal under study the single-
mode approximation works well, and so the effective-medium model is well-founded. In the second
band, however, this approximation becomes much less accurate. We shall consider specifically the fre-
quency ! = 0:259  2 c=a, at which the EFC of the crystal is, again, centred at   , approximately
circular, and its radius corresponds to the effective index n   1 [fig. 2.4(b), middle diagram, solid
line]. In figs. 2.7(a) and (d) the rigorous value of the specular reflection coefficient of the crystal at this
frequency is juxtaposed with that calculated from eq. (2.20). The relative error grows with kx and is
usually greater than 20% (plane 1) and 10% (plane 2). In the evanescent region, the single-mode ap-
proximation is clearly irrelevant. The graphs of the amplitudes of the three most slowly decaying crystal
eigenmodes [figs. 2.7(b) and (e)] clearly show that the influence of the second mode is nonnegligible
in the whole range of kx , and for the first truncation plane even the third mode plays a significant part.
Close inspection reveals that the ratios jt2=t1j and jt3=t1j tend to grow with the incidence angle; thus,
the effective-medium model is a better approximation at near-normal than at grazing incidence (except
for the immediate neighbourhood of kx = !=c, where r0 becomes exactly  1).
In addition, as shown in fig. 2.6(b), the electric field of the mode with ! = 0:259  2 c=a, kx =
0:259  2 =a and kz = 0 is antisymmetric with respect to the mirror planes of the crystal. Thus, y is
divergent at kx = 0:259  2 =a regardless of the choice of the truncation plane [figs. 2.7(c) and (f)].
2.4.2 Square lattice
The second structure to be studied is the square lattice of air holes of radius 0:35a, where a is the lattice
constant, drilled in a dielectric matrix with  = 11:56 [fig. 2.8(a)]. Its Brillouin diagram is plotted in fig.
2.8(b). The analysis will be conducted at three discrete frequencies, ! = 0:13  2 a=c, 0:22  2 a=c
and 0:31  2 a=c, at which the EFCs of the crystal have an approximately circular or ellipsoidal shape,
as demonstrated in fig. 2.9.
Figures 2.10(a), (d) and (g) show the kx-dependence of the reflection coefficient r0 at the frequency
! = 0:13  2 a=c for the three positions of the truncation plane marked in fig. 2.8(a). Planes 1 and 2
contain inversion centres of the PC, while plane 3 does not. According to the theorem from subsec-
tion 2.3.1, for the former planes r0 should be real as long as both the incident wave and the dom-
inant crystal eigenstate are propagative, which is the case for kx < !=c = 0:13  2 =a. Figures
36 Chapter 2. Effective-medium model of photonic crystals
a
0:5
0:4
plane 3 0:3
3a=4
plane 2 0:2
a=2
plane 1 0:1
0
  X M  
(a) (b)
Figure 2.8 (a) Geometry of the square-lattice PC analysed in the text. Horizontal lines mark the position of
truncation planes 1, 2 and 3; inversion centres of the infinite PC located at these planes are marked with crosses.
(b) Band structure of the crystal shown in part (a). Horizontal lines mark the frequency values ! = 0:13 2 c=a,
0:22  2 c=a and 0:31  2 c=a.
0:50
(a) (b) (c)
0:25
0:00
 0:25
 0:50
 0:5 0:0 0:5  0:5 0:0 0:5  0:5 0:0 0:5
kxa=2  kxa=2  kxa=2 
Figure 2.9 The EFCs at frequency (a) ! = 0:13  2 c=a, (b) 0:22  2 c=a, and (c) 0:31  2 c=a of the PC
shown in fig. 2.8(a) (solid lines) and the corresponding “empty lattice”, i.e., the homogeneous medium of refractive
index 2:476 (dashed and dotted lines). The empty-lattice bands corresponding to the n = 0 harmonics are plotted
with dashed lines, the rest with dotted lines.
2.10(a) and (d) confirm that this is fulfilled with a very good accuracy. In fact, Im rn0 does not exceed
0.002, that is, 0.3% of the magnitude of rn0 ; this tiny imaginary part stems from the excitation of sec-
ondary crystal eigenmodes, which are neglected in the single-mode approximation. In turn, when the
PC is truncated along plane 3, r0 retains a large imaginary part also in the propagative-wave region
[fig. 2.10(g)].
The plots of the relative error show that when the incident wave is propagative, the single-mode
approximation is extremely accurate at the frequency in question (the relative error is less than 0.3%).
For larger kx , the error slowly grows, reaching   0:6–0:8 (planes 1 and 3) and   0:2 (plane 2)
at the Brillouin zone edge. However, it does not exceed 10% until kx = 0:43  2 =a for planes
1 and 3 and kx = 0:475  2 =a for plane 2, so that the single-mode approximation is still rele-
vant at kx = 0:39  2 =a, where 1z vanishes and the dominant eigenmode becomes evanescent.
We may then proceed to the analysis of the behaviour of the effective parameters at this value of kx .
The EFC of the dominant eigenmode is centred at   , and its electric field at kx = 0:39  2 =a
and kz = 0 is symmetric with respect to the horizontal mirror planes of the crystal, as evidenced by
fig. 2.11(a). In consequence, the effective parameters x = z and y are continuous and bounded
kza=2 
!a=2 c
2.4. Examples 37
1 0:75 1 1:0
(a) (g)
 0:50
Im r0
0 0 0:5
R e r0 0:25
!
rel. error
 1 0:00  1 0:0
4 4
(b) (h)
2 2
0 0
0:95 11 20  =2
(c) (i)
0:90
y ! 10 arg y
0:85 10 jy j 0
9 arg
 x0:80 x jx j
0:75 8 0   =2
0:0 0:1 0:2 0:3 0:4 0:5 0:0 0:1 0:2 0:3 0:4 0:5
kxa=2  kxa=2 
1 0:3
(d)
0:2
0
0:1
 1 0:0
4
(e)
2
0
1:4 7:5
(f) 7:0
1:2 6:5
6:0
1:0 5:5
0:0 0:1 0:2 0:3 0:4 0:5
kxa=2 
Figure 2.10 (a) The kx-dependence of the specular reflection coefficient r0 of the crystal from fig. 2.8(a) trun-
cated along plane 1, at ! = 0:13  2 c=a. Solid lines: results of rigorous calculations, rn0 ; circles: results of
calculations made in the single-mode approximation, rsm0 ; dashed line: relative error  of the single-mode approx-
imation. The vertical lines at kx = 0:13  2 =a and 0:367  2 =a mark where the incident wave and the single
propagating crystal eigenmode, respectively, turn from propagating to evanescent. (b) Amplitudes of the three
most slowly decaying crystal eigenmodes excited in the above conditions (solid, dashed and dotted line, in order
of increasing Im kz). (c) Effective x (dark lines) and y (light lines) of the crystal. (d)–(f) and (g)–(i) The same
for planes 2 and 3.

 xx j j Re r0, Im r0, j j Re r0, Im r0,tm tm
jx j, jy j j Re r0, Im r0,tmj
argx , arg y
Relative error
Relative error
y Relative error y
38 Chapter 2. Effective-medium model of photonic crystals
1
0
 1
(a) (b) (c)
Figure 2.11 Real part of the electric field Ey of the modes of the crystal shown in fig. 2.8(a) with (a) ! =
0:13  2 c=a, kx = 0:367  2 =a and kz = 0, (b) ! = 0:22  2 c=a, kx = 0:264  2 =a and kz =  =a,
(c) ! = 0:31  2 c=a, kx = 0:078  2 =a and kz = 0. Two nonequivalent mirror planes of the crystal parallel to
its surface are marked with horizontal lines.
1 1:0 1 0:2
(a) (d)
 0
Im r0
0 0:5  1 0:1
 Re r0  2
  rel. error!1 0:0  3 0:0
4 2
(b) (e)
2 1
0 0
3 1 50
(c) (f)
z
2
0 0
1 y
x
0  1  50
0:0 0:1 0:2 0:3 0:0 0:1 0:2 0:3
kxa=2  kxa=2 
Figure 2.12 Same as fig. 2.10, at frequency ! = 0:222 c=a and for truncation planes (a)–(c) 1 and (d)–(f) 2.
The vertical lines at kx = 0:22 2 =a and 0:264 2 =a mark where the incident wave and the single propagating
crystal eigenmode, respectively, turn from propagating to evanescent.
in the whole range of kx for the cuts 1 and 2, which coincide with mirror planes of the PC [figs.
2.10(c) and (f)]. In contrast, truncating the crystal along plane 3 leads to divergence of y at kx =
0:39  2 a=c.
We turn now to the study of the system at the frequency ! = 0:22  2 a=c. The EFC, shown in fig.
2.9(b), consists of two elliptical “branches” encircling the points X = .0;  =a/ and X 0 = . =a; 0/. In the
effective-medium model, we focus on the neighbourhood of the first EFC branch (jkxj < 0:39  2 =a)
and use the dimensions of the ellipse encircling the X point to calculate the effective parameters. The
electric field of the mode corresponding to the right vertex of this ellipse is plotted in fig. 2.11(b). It is
symmetric with respect to plane 1, which passes through the cylinder centres, and antisymmetric with
respect to plane 2, passing midway between the cylinders.
j j Re r0, Im r0,x , z , y tm
x , z j j Re r0, Im r0,tm

Relati yve error
Relative error
2.4. Examples 39
1 2 1 2
(a) (d)
 
Im r0
0 1 0 1
 Re r0
rel. error!
 1 0  1 0
20
(b) 20 (e)
10
0 0
 0:08  0:5  0:100  0:4
(c)  ! (f)y
   0:60:10  0:125  0:5
 0:7
 0:12     0:150  0:6x 0:8
 0:14  0:9  0:175  0:7
0:00 0:02 0:04 0:06 0:08 0:00 0:02 0:04 0:06 0:08
kxa=2  kxa=2 
Figure 2.13 Same as fig. 2.10, at frequency ! = 0:31  2 c=a and for truncation planes (a)–(c) 1 and (d)–
(f) 2. The vertical line at kx = 0:0782 =a marks where the propagating crystal eigenmode turns evanescent (the
incident wave is propagating throughout the kx range presented on the plot).
Figures 2.12(a) and (d) show the kx-dependence of the reflection coefficient r0 for these two crystal
terminations. As for ! = 0:13  2 c=a, the approximation accuracy is visibly better for plane 2 than 1:
in the former case, r0 is rendered faithfully well beyond the propagative-wave region. The superior
performance achieved for plane 2 is probably due to the uniformity of the crystal permittivity on this
plane, which leads to smaller spatial field variations, making fewer Fourier harmonics necessary to match
the field in the crystal with that in free space. However, the antisymmetry of the eigenmode’s electric
field with respect to plane 2 implies that the effective permittivity y diverges at kx = 0:26  2 =a [fig.
2.12(f)]. In contrast, if the other truncation plane is chosen, all effective parameters are continuous and
bounded [fig. 2.12(c)], but at the cost of a significant single-mode approximation error:   17% close
to normal incidence. (This time, the relative error is not very meaningful in the evanescent-wave region,
since the rigorous reflection coefficient passes through zero at kx = 0:29  2 =a, so that  blows up.)
Finally, we move on to the case of ! = 0:31  2 c=a. The EFC diagram shown in fig. 2.9(c)
comprises an approximately circular part located at the centre of the Brillouin zone and four curves
of irregular shape, together forming a closed path encircling the point M = . =a;  =a/. The circular
EFC represents a negative-refraction band. As seen from fig. 2.11(c), the electric field of the mode
with kx = 0:078  2 =a and kz = 0 is symmetric with respect to planes 1 and 2, which assures the
continuity of the effective parameters at kx = 0:078  2 =a, where the mode turns from propagating to
evanescent. This is in contrast to the negative-refraction band of the hexagonal crystal analysed in the
previous subsection, whose symmetry properties made y diverge at the transition point. However, there
is no improvement in the accuracy of the single-mode approximation: the comparison of the values of r0
calculated rigorously and from eq. (2.20) [figs. 2.13(a) and (d)] reveals that the approximation introduces
a significant error (above 33% for plane 1 and 11% for plane 2) due to the large excitation amplitude of
secondary crystal eigenmodes [figs. 2.13(b) and (e)].
x
jtmj Re r0, Im r0,
x
jtmj Re r0, Im r0,
y
Relative error
y
Relative error
40 Chapter 2. Effective-medium model of photonic crystals
2.4.3 Remarks
In the context of metamaterials containing resonant components, such as metallic split rings, it has been
observed that inside band gaps, the effective permittivity and permeability of these structures (defined at
normal incidence) have large imaginary parts of opposite sign, regardless of the location of the truncation
plane [82–85]. This is not in contradiction with our theory, since one of the assumptions of the condition
for real-valuedness of  and formulated in subsection 2.3.1 is the propagative nature of the fundamental
crystal eigenstate (real 1z). Of course, inside band gaps all modes are evanescent, and so the condition
in question is not applicable.
On the other hand, our results show that in general the effective parameters of a lossless PC can attain
complex values even outside band gaps, if the truncation plane does not exhibit certain symmetries. In
this case, the product  is real (due to the absence of losses), and either  or  has a negative imaginary
part. This is visible, for example, in fig. 2.5(i) showing the kx-dependence of the effective parameters
for the low-symmetric truncation plane 3 of the PC from fig. 2.3(a): it is clear that arg 2 Œ  x ; 0, so2
that Imx < 0. Only at specific truncation planes are effective  and  real. (It must be noted, though,
that precisely these special truncation planes have usually been chosen in previous calculations of the
effective parameters of PCs and metamaterials.)
2.5 Validity of the single-mode approximation
We have seen that the accuracy of the single-mode approximation for a given PC varies strongly with
frequency and incidence angle. In some cases, one of the crystal modes is clearly dominant; in others,
several eigenstates are excited with similar magnitude. In the following, we offer a qualitative argument
relating the ratios jtm=t1j of the excitation coefficients of the individual modes to the Fourier spectrum of
their electromagnetic fields on the crystal surface. This leads us to conclusions regarding, in particular,
the viability of the effective-medium description of negative-refraction bands.
Let us begin by writing the system (2.17) in a partitioned form, emphasising the rows corresponding
to the nonzero elements of the vectors representing the incident field, a and a00 0, as well as the columns
corresponding to the unknowns r0 and tk:
2 32 3 2 3
666
 IO 0E 0O uO<0 uE<0 uO<07766rE<077 66 0E<k k >k6 0N  1 0N
7
uN0 u0 uN0 r 76 <k k >k7766 066 0O 0E  IO uO>0 uE>0 uO>076rE 7
77 666 1 7770E
6 <k k >k777666 >0777 = 6Oˇ E O E 66 77E 7 : (2.37)6i = 0 0 vO<0 vE<0 vO<06 <0 1 t<k k >k7766 <k 04 N N 54 757 664 770 iˇ = 0 vN00 1 v0 vN0 t iˇ =<k k >k k 0 15
0O 0E i Oˇ>0= vO>01 vE>0 vO>0 tE>k 0E<k k >k
We remind the reader that the symbols embellished with arrows, bars and hats are column vectors, row
vectors and matrices, respectively, while those without any embellishment are scalars (see section 1.3).
The meaning of the indices should be clear; for example, uO<0 stands for the submatrix of the uO matrix
<k
corresponding to rows with negative indices and columns with indices less than k. From the Cramer’s
formula [86, p. 299], we have tl=tk = Dl=Dk , whereDj stands for the determinant of the matrix created
by replacing the j th column in the right half of the matrix of the system from eq. (2.37) by the right-
hand side of the system. After some algebra, where elementary properties of determinants are utilised,
2.5. Validity of the single-mode approximation 41
we arrive at ˇˇˇ ˇˇˇ
ˇˇˇ  IO 0O uO<0 uO<0<l >l
ˇˇˇ 0O  IO uO
ˇˇˇ
>0 uO>0
<l >l
Oˇ O O<0 O<0 ˇˇˇ
ˇˇˇˇ
i <0=1 0 v v<l >l
>0 >0ˇ
tl = . 1/l  0
O i Oˇ
k >0
=1 vO vO<l >l ˇˇˇ : (2.38)
tk ˇˇˇ  IO 0O uO<0 uO<0<k >k
ˇˇˇ 0O   O O
ˇˇˇ
I u>0 uO>0
<k >k
ˇi Oˇ = 0O
<0 <0 ˇˇˇ
<0 1 vO vO<k >k
0O i Oˇ>0= vO>0 vO>0ˇ1 <k >k
By means of the Laplace expansion [86, p. 259] of the determinants in the numerator and denominator
along the columns containing uEk and uEl , respectively, the ratio tl=tk can be written as the ratio of two
sums of terms proportional to the components of the Fourier expansion of the electric and magnetic fields
at the crystal surface of, respectively, the kth and l th eigenmode:
P
P ¤ .a un C b vntl = n 0 n n /k kn C n ; (2.39)tk n¤0.anu bnv /l l
where an and bn denote the appropriate coefficients resulting from the Laplace expansion. It is crucial
to observe that these sums do not contain the zeroth Fourier component of either field.
The PC bands can be treated as mixtures of the eigenstates of the empty lattice with “average” 
and ; for a fipxed kx , these eigenstates are the plane waves Eyn.x; z/ = expŒi.kx C Gxn/x C ikznz,
where k = .!=c/2   .k CG /2zn x xn . When the index contrast of the PC is low enough, in some
regions of the .!; kx/ space each of the PC eigenstates comprises a single dominant plane wave, the
perturbative components having low amplitude. This means that each of the sets of coefficients .unm/n2Z
corresponding to different modes m contains a single dominant component. From eq. (2.39) it follows
that, in general, the mode whose dominant component is the zeroth one (n = 0) is then excited the
most strongly. Indeed, labelling this mode with index m = 1, we see that in the expression (2.39) for
the ratio t =t (l ¤ 1) the sum in the numerator does not contain terms proportional to u0 and v0l 1 1 1 ,
which, by assumption, are the largest ones. On the contrary, the sum in the denominator contains two
terms proportional to the dominant components of the th mode, say, nl and nl u v l , since nl is necessarilyl l
different from zero. Thus, we see that the fraction tl=t1 is a ratio of a “small” and a “large” quantity—and
so jtl j  jt1j for all l ¤ 1, that is, the defining assumption of the single-mode approximation is fulfilled.
Conversely, if there is strong coupling between the zeroth harmonic and plane waves corresponding
to different values of n, so that no mode with highly dominant zeroth component exists, the numerator in
(2.39) for k = 1 is no longer a small quantity, and multiple eigenmodes can be excited with comparable
amplitude.
We conclude that the single-mode approximation should work best at those values of ! and kx for
which the mode originating from the n = 0 harmonic—the plane wave exp.ikxx C ikz0z/—does not
contain significant contributions of other plane waves. In practice, this usually means that when we
consider the transition from the empty lattice to the final PC, the fragment of the EFC of the PC around
a given value of kx should form mainly from the circle corresponding to the n = 0 harmonic of the
empty lattice. For example, as can be seen in fig. 2.4(a), the EFC of the single propagating mode of
the hexagonal-lattice PC at frequency ! = 0:14  2 c=a (solid line, middle diagram) is very similar to
the original EFC of the n = 0 harmonic of the empty lattice (dashed line). In addition, the imaginary
bands corresponding to n =  1 and n =  2 are very weakly perturbed (top diagram). We infer that the
42 Chapter 2. Effective-medium model of photonic crystals
1:0
(a) (b)
0:5
0:0
 0:5
1
(c) (d)
0
  u
n
1=u
0
1 1
vn=v0
  1 12
 2  1 0 1 2  2  1 0 1 2
n n
Figure 2.14 Values of the harmonics .un/2 and .vn 21 n= 2 1 /n= 2 of the propagative eigenmode of the crystal from
fig. 2.3(a) on the truncation plane 1 and at (a) ! = 0:14  2 c=a, kx = 0:10  2 =a, (b) ! = 0:14  2 c=a,
kx = 0:40  2 =a, (c) ! = 0:259  2 c=a, kx = 0:05  2 =a, (d) ! = 0:259  2 c=a, kx = 0:20  2 =a.
individual plane waves couple weakly, so that the zeroth harmonic of the field of the propagating crystal
eigenmode should be dominant, and the eigenmode itself should be strongly excited. These claims are
corroborated by figs. 2.14(a)–(b), where the amplitudes of several harmonics un n1 and v1 of this mode
at the truncation plane 1 are shown for two values of kx , and fig. 2.5(b), where the amplitudes jtmj of
individual eigenstates are juxtaposed.
Now let us turn our attention to fig. 2.4(b), where the evolution of the EFCs at the frequency ! =
0:259  2 a=c is shown; this frequency lies in the second band, which exhibits negative group velocity.
We can see that in this case the plotted quarter of the circular EFC of the single propagating crystal
eigenstate is formed by merging of the n = 0 and n =  1 harmonics of the empty lattice. Their strong
coupling is further indicated by the substantial alteration of the shape of the imaginary bands. We can
expect the contribution of the zeroth harmonic to be strongest at small values of kx , and so the accuracy
of the single-mode approximation to be highest near normal incidence and deteriorate with increasing kx .
This is again confirmed by figs. 2.14(c)–(d) and 2.7(b).
To help establish a broader picture of the single-mode approximation’s performance for the hexagonal-
lattice PC, in fig. 2.15(b) the relative error of the reflection coefficient r0 calculated in this approximation
is plotted for a mesh of 101  100 points of the .kx; !/ space. In turn, figs. 2.15(c) and (d) present the
amplitude variations of the zeroth harmonic of the electric and magnetic field, respectively, of the most
slowly decaying crystal mode (on the truncation plane 1). It can be seen that, although there is no one-to-
one correspondence, the areas of significant error generally match those in which the n = 0 component
of either the electric or magnetic field, or both, of the least-evanescent eigenmode has small amplitude.
(In fact, the dependence of the approximation’s accuracy on the Fourier spectrum of the magnetic field
seems more pronounced than that on the electric field.)
Finally, it should be noted that the EFC from fig. 2.4(b) is in fact typical for negative-refraction
bands. Indeed, the EFCs of the empty lattice are circular, with group velocity directed outwards, and the
negative bands arise from convex figures formed by arcs of three, four or six such intersecting circles,
necessarily including those corresponding to harmonics with nonzero Gxn (see fig. 2.16). Thus, the
resulting bands do not fulfil the validity condition of the single-mode approximation, or do it only in the
restricted range of kx close to zero. Consequently, attribution of effective permittivity and permeability
to negative-refraction bands makes sense at most for near-normal incidence, while in the evanescent
regime the effective-medium description is definitely inappropriate.
Normalized value
Normalized value
2.5. Validity of the single-mode approximation 43
0:5
0:4
0:3
0:2
0:1
(a)
0:0
0:5 1:00
0:4
0:75
0:3
0:50
0:2
0:25
0:1
(b)
0:0 0:00
0:5 1:00
0:4
0:75
0:3
0:50
0:2
0:25
0:1
(c)
0:0 0:00
0:5 1:00
0:4
0:75
0:3
0:50
0:2
0:25
0:1
(d)
0:0 0:00
0:0 0:2 0:4
kxa=2 
Figure 2.15 (a) Projection of the band structure of the PC shown in fig. 2.3(a) on the .kx ; !/ plane. Grey and
white areas denote photonic bands and gaps, respectively. The arrows mark the frequency values ! = 0:14 
2 c=a and 0:259  2 c=a. (b) The dependence of the relative error of the single-mode approximation of this
crystalP’s reflection coefficient on kx andP! for the truncation plane 1. (c) The corresponding dependence ofj 1=2 1=2u01j= njunj21 . (d) Same for jv0 n 21 j= njv1 j .
!a=2 c !a=2 c !a=2 c !a=2 c
0 0
Relative error Normalized ju1j Normalized jv1 j
44 Chapter 2. Effective-medium model of photonic crystals
(a) (b)
(c) (d)
Figure 2.16 Typical configurations of empty-lattice EFCs leading to formation of negative-refraction bands
after introducing sufficient lattice modulation. In each case, the direction of normal incidence is from the bottom;
circles corresponding to harmonics with Gxn = 0 are drawn in darker blue. Thin lines mark the boundaries of
the first Brillouin zone of each lattice, and black dots denote reciprocal lattice points. Top row: square lattice,
bands encircling (a) theM point of the first Brillouin zone, (b) the   point; bottom row: hexagonal lattice, bands
encircling (c) the K point, (d) the   point.
2.6 Conclusions
In this chapter, we have analysed in detail the effective-medium description of 2D PCs. Its validity has
been shown to be restricted by the accuracy of the single-mode approximation, and a definition of the
effective permittivity, permeability and transverse impedance, rigorous under this approximation, has
been given. In the framework of the single-mode approximation, we have studied the dependence of
the specular reflection coefficient r0 of the crystal on the position of the truncation plane, deriving the
conditions assuring r0, and consequently the effective parameters, to be real-valued. Continuity and
boundedness of the latter have been shown to depend on the symmetry of the dominant eigenmode of the
crystal.
Subsequently, the conditions of validity of the single-mode approximation have been studied. We
have established a link between the relative excitation amplitudes of individual crystal eigenmodes and
the Fourier spectrum of the electric and magnetic fields of these modes on the crystal truncation plane.
This link has been employed to formulate a criterion for estimating the accuracy of the single-mode
approximation by comparing the equifrequency diagrams of the PC and of the homogeneous medium
with refractive index equal to the average refractive index of the PC. Finally, we discussed the special
case of negative-refraction bands; we concluded that the effective-medium description of these bands is,
quite generally, inaccurate, since their Fourier-space structure entails simultaneous excitation of other
bands by plane waves incident at most angles, and so attributing a definite effective permittivity and
permeability to these bands is not physically meaningful.
Chapter 3
Antireflection gratings for photonic crystals
3.1 Introduction
As can be seen from the plots of the reflection coefficient of PCs presented in chapter 2 (figs. 2.5, 2.7,
2.10, 2.12, and 2.13), reflected waves of significant amplitude are often generated at PC surfaces. In
many applications, one strives after a perfect energy transfer between the incident plane wave and the
propagative PC eigenmode (or, more rarely, several such modes). Propagative reflected waves should
then be eliminated. This chapter concerns the design of antireflection (AR) structures that, placed on
a PC surface, significantly diminish the fraction of energy lost to reflected waves. After reviewing the
classes of these structures proposed to date (section 3.2), in section 3.3 we put forward a new method of
designing AR gratings operating in a wide range of angles of incidence. This algorithm is illustrated in
section 3.4 by means of several examples. We summarise the advantages and limitations of the proposed
approach in section 3.5.
3.2 Types of antireflection structures
3.2.1 Antireflection structures for homogeneous media
Since the design of AR structures for PCs is often guided by the experience gained from the long-
standing study of methods for eliminating reflections from interfaces separating homogeneous media,
we shall begin with a brief review of the AR structures employed in this simpler case.
They can be divided into two broad classes. The refractive index n of AR coatings depends only on
the coordinate z perpendicular to the interface; depending on whether n.z/ is piecewise-constant or not,
we speak of homogeneous-layer or inhomogeneous-layer AR coatings [87]. In turn, the refractive index
of AR gratings is also a function of the coordinates parallel to the interface. Figure 3.1 shows example
AR structures belonging to these three classes.
The simplest homogeneous-layer AR coating consists of a single thin film with refractive index n and
thickness d chosen so as to ensure destructive interference of waves reflected from its top and bottom
surfaces, excited by a plane wave with a certain frequency ! and angle of incidence  . The values of
n and d can be obtained analytically. In order to improve the angular and frequency tolerance of the
coating, one can increase the number of layers to make the transition between the refractive index of the
super- and substrate more gradual [87], thus reducing the amplitude of waves reflected on the individual
discontinuities of n.z/. In the limit of an infinite number of layers, one arrives at an inhomogeneous-
layer coating with a continuous monotonic profile n.z/. Several specific profiles have been proposed in
the literature (see ref. 88 for a review). Unfortunately, these “ideal” AR coatings, even the single-layer
one, cannot usually be realised because of the lack of suitable materials with the required values of n.
This is the case, in particular, for air-solid interfaces, where thin films with refractive index close to unity
45
46 Chapter 3. Antireflection gratings for photonic crystals
z z z
medium 2 medium 2 medium 2
AR
AR coating AR coating grat-
ing
medium 1 medium 1 medium 1
x x x
(a) (b) (c)
Figure 3.1 Example AR structures belonging to the three principal classes described in the text. Darker areas
denote regions with higher refractive index. (a) A homogeneous-layer AR coating. (b) An inhomogeneous-layer
AR coating. (c) A (binary lamellar) AR grating.
are needed. Short of using special ultra-low-index media, such as so-called Reststrahlen materials [87],
there are two basic ways of circumventing this problem.
One of them consists in abandoning completely the structures based on a “continuous transition”
between the super- and substrate refractive indices in favour of interference-based coatings [87]. In
these systems, the total reflected wave vanishes thanks to the destructive interference of partial waves
generated at interfaces between layers with contrasting values of n. For instance, so-called v-coatings
consist of two layers with prescribed refractive indices n1 and n2 (corresponding to realistic materials)
and thicknesses d1 and d2 adjusted so as to eliminate reflection at the desired values of ! and  . Note
that n1 and n2 must satisfy certain conditions in order that appropriate d1 and d2 can be found [89,
p. 96]. A disadvantage of v-type AR coatings is that their angular and frequency tolerance are usually
inferior even to those of the corresponding ideal single-layer coatings [89, p. 97; 90, p. 188].
The other solution consists in using subwavelength gratings to simulate AR coatings with arbitrary
n.z/ profiles. In many cases, the effective-medium theory of gratings can be employed to calculate
the grating profile mimicking the desired n.z/ dependence [88]. Several types of gratings, such as the
lamellar, trapezoidal, sinusoidal, triangular and pyramidal ones, have been studied in the literature and
shown to have good AR properties [88, 91–93]. A review of the experimental methods used to fabricate
such AR structures can be found in ref. 94.
3.2.2 Antireflection structures for photonic crystals
As pointed out in chapter 2, a distinguishing feature of PCs is the dependence of their reflection coeffi-
cient on the position of their truncation plane. One could hope then that a significant reduction of a PC’s
reflectance could be achieved without adding any AR structure, but simply by choosing an appropriate
cut. For some crystals, this has indeed proved to be possible [95, 96]. In particular, Botten et al. [96] have
shown that very low reflectance is a rather general feature of rod-type PCs truncated midway between
successive layers of rods. For many crystals, however, no truncation plane provides a sufficiently small
value of reflectance (see fig. 3.2). This method of reducing reflection is therefore not general enough,
and one often has to resort to introducing some AR structure. Several types of them have been proposed
in the literature. More often than not, they have much in common with one of the solutions developed
with homogeneous materials in mind, reviewed in the previous subsection.
3.2. Types of antireflection structures 47
0:4
z a
0:3
p
a 3
0:2
2
0
0:1
0:0 0:1 0:2 0:3 0:4 0:5
p
z0=.a 3/
(a) (b)
Figure 3.2 (a) The dependence of the reflectance jr 20j of the PC shown in part (b), placed in air, on the location
of the truncation plane z = z0. The impinging wave is normally incident, s-polarised and has frequency ! =
0:311  2 c=a. It can be seen that jr 20j does not fall under 0.13 for any truncation plane. (b) Geometry of the
PC under study: a hexagonal lattice of air holes with radius 0:365a, where a is the lattice constant, etched in a
dielectric matrix with permittivity  = 10:6.
The simplest approach has been proposed by Li et al. [97]. It consists in placing in front of the
crystal a v-type AR coating composed of two layers made of constituent materials of the crystal, usually
air and a dielectric. Their thicknesses can be determined analytically or graphically as soon as the
reflection coefficient of the semi-infinite uncoated PC at the selected operation frequency is known. This
frequency is assumed to be low enough that only the zeroth diffraction order be propagative in the layer
closest to the PC surface, so that all higher orders reflected by the crystal decay before reaching the
boundary between the two layers. If it is not the case, the structure may still work, but the optimum layer
thicknesses will not in general be given by the analytical formulas derived from the thin-film theory. The
basic disadvantage of this otherwise very attractive approach is the relatively low angular and frequency
tolerance of v-type AR coatings.
Another group has studied a similar approach, in which one of the homogeneous layers is replaced
by a grating of rods or holes [98, 99]. The performance of the resulting AR gratings was shown to be
similar to that of v-type coatings [99]. Related structures, albeit with only a single degree of freedom
(the radius of the outermost rods of a rod-type PC), were also analysed by Jin and He [100]. In turn,
Zhang and Li [101] proposed a more complex wide-angle AR grating for the interface between air and
a PC flat lens, whose fabrication would be seriously hindered, though, by the presence of extremely thin
air slits and dielectric veins.
In contrast to the above works, which concentrated on the low-frequency regime, the authors of refs.
102–104 endeavoured to eliminate the reflection from an interface between a PC and a semiconductor at
a frequency where multiple propagative diffraction orders existed in the latter medium. They proposed
an AR grating consisting of elongated drop-shaped air holes, this nonstandard form being motivated
by the desire of ensuring a gradual transition between the two media. In fact, the shape of the resulting
structure resembles closely the classical trapezoidal AR gratings studied, e.g., by Raguin andMorris [92].
The improvement brought about by these gratings has subsequently been demonstrated experimentally
[105]. Unfortunately, Baba et al. did not provide any analytical guidelines regarding the choice of the
geometrical parameters of the gratings, resorting instead to a time-consuming scan of the parameter space
in order to find the optimum structure [102, 103].
A very important contribution was made by Lawrence et al. [106, 107], who introduced the concept
of generalised matrix-valued effective immittance O of gratings and showed that their effective-medium
jr j20
48 Chapter 3. Antireflection gratings for photonic crystals
description can be made arbitrarily accurate by allowing O to have sufficiently large dimensions. Such
matrix-valued immittance cannot serve as a drop-in replacement of the corresponding scalar quantity in
standard formulas derived for homogeneous media [107]. Therefore, for instance, analytical determi-
nation of the optimum parameters of an AR structure for a given PC composed of layers described by
a matrix O is not possible. However, Lawrence et al. derived equations corresponding to the Fresnel
formulas (2.9) involving the generalised immittances of two adjacent gratings, and showed that the im-
mittance matrix of typical gratings can be truncated to 5 5 elements or less without a substantial loss in
accuracy. Since numerical calculations involving such small matrices are very fast, it becomes feasible
to design optimum AR gratings by performing a full scan of the available parameter space. Example AR
structures presented in ref. 107 include, for instance, a relatively wide-band AR coating of a superprism-
type PC at a frequency where multiple propagative diffraction orders exist in the adjacent dielectric. A
slight limitation of the approach of Lawrence et al. is that the generalised immittance has only been
defined for 2D gratings symmetrical with respect to a two-fold rotation axis parallel to the direction of
invariance. Therefore, it does not cover, for instance, triangular or trapezoidal gratings.
All the AR structures discussed so far are relatively compact, with thickness rarely exceeding one
or two lattice constants of the underlying PC. Some authors have advocated sacrificing compactness in
favour of potentially larger frequency and angular tolerance offered by thick stacks of gratings, whose
geometry changes gradually so as to ensure a smooth transition of the electromagnetic field of the in-
cident plane wave towards the Bloch mode of the semi-infinite PC. Several design principles for such
gratings have been proposed [108, 109]. In this work, we shall focus on compact AR structures, and
therefore we do not consider adiabatic AR gratings in detail.
3.3 Design procedure
We shall now present an alternative method of designing AR gratings for PCs. Compared to the ap-
proaches reviewed in subsection 3.2.2, it has the following distinguishing features:
1. Instead of performing a potentially time-consuming global scan of possible geometries, we use an
effective-medium model of PCs to calculate analytically the geometrical parameters of a “tenta-
tive” AR grating; then, if necessary, these parameters are refined with a numerical local-minimisa-
tion procedure. The end result of our procedure is a trapezoidal AR grating.
2. The resulting AR structures have good angular tolerance, which in some important applications
of PCs is more significant than the frequency tolerance. For instance, the quality of the image
produced by a PC flat lens with effective refractive index n   1 depends in the first place on
the angular range of incident propagative plane waves which are transmitted through the lens with
little or no energy loss. On the other hand, frequency tolerance is not vital since n can be close
to  1 only in a narrow frequency band.
We draw on the results of Raguin and Morris [92], who demonstrated that triangular and trapezoidal
gratings allow a significant reduction of reflectance at interfaces between homogeneous media in a wide
range of incidence angles. Let us now proceed to detailing the three constituent steps of the algorithm.
Step 1 We begin by using the classical theory of AR coatings to calculate the refractive index and
thickness of a single-layer coating that should minimise the reflection from the PC surface at a fixed
angle of incidence  and frequency !. The value of  should lie approximately midway the desired
angular operation range of the final AR structure.
Consider the system shown in fig. 3.3, in which a propagative plane wave with frequency ! = ck0
and wave vector kE1 = .kx; kz1/ = .n1k0 sin ; n1k0 cos / impinges from the dielectric 1 with refractive
3.3. Design procedure 49
z
medium 3
d2 medium 2
n2
E 
medium 1
k1
n1
x
Figure 3.3 System considered in step 1 of the AR grating design procedure.
index n1 on the surface of the homogeneous film 2 with thickness d2 and refractive index n2 coating the
PC 3. Let us assume that medium 2 supports exactly one propagative diffraction order and is sufficiently
thick for all the evanescent orders reflected from the PC surface to vanish at the interface between media
1 and 2. We can calculate the total amplitude of the reflected plane wave, r , by summing up all the
multiple reflections occurring in the system:
hX1 i 2
= C n r12 C .t12t21   r12r21/r= 23˚r r12 t12˚r23˚ .r21˚r23˚/ t21   ; (3.1)1 r 221r23˚
n=0
where rij and tij denote the amplitudes of the waves reflected from the interface between media i and j
and transmitted through it, respectively, and˚  eikz2d2 with k  .n2k2 k2/1=2z2 2 0 x . From the Fresnel’s
formulas [cf. (2.9)]
j  i 2
rij =
j
C ; tij = C (3.2)j i j i
it immediately follows that r21 =  r12 and t12t21   r12r21 = 1, hence
r C r ˚2
= 12 23r C : (3.3)1 r 212r23˚
The parameters of the antireflection coating, n2 and d2, can now be obtained by requiring the numerator
of the fraction in the above equation to vanish. If the coating is lossless, so that j˚ j = 1, the numerator
vanishes if and only if (i) the moduli of r12 and r23 are equal and (ii) the thickness d2 is such that
arg r23 C 2kz2d2 = arg r12 C .2mC 1/ ; (3.4)
where m 2 Z and arg z stands for the argument of the complex number z. Solving for d2, we get
arg r12   arg r23 C .2mC 1/ 
d2 = : (3.5)
2kz2
It is usually best to choose the value of m corresponding to the smallest positive admissible value of d2;
otherwise, internal resonances in the coating layer can spoil its antireflective properties for some angles
of incidence.
50 Chapter 3. Antireflection gratings for photonic crystals
We shall now use condition (i) to determine the refractive index n2 of the AR coating. Substituting
the Fresnel’s formulas (3.2) into the condition jr j2 = jr j212 23 , we obtain
.   /22 1 .3  2/.  2/
C =
3
C  C : (3.6).  /22 1 .3 2/.3 2/
Straightforward algebra leads to
 Re C j j22 = 3 3 =1 22   1 : (3.7)Re3 1
The s- and p-polarisation cases need now to be considered separately. Assuming materials 1 and 2 to be
nonmagnetic (1 = 2 = 1), in the s-polarisation case we have 2 = Z2 and eq. (2.5) gives
k0 k
Z2 = = q 0 ; (3.8)
kz2 n2 2 2 2 22k0   n1k0 sin 
hence
2 2 2 C 1n2 = n1 sin  : (3.9)
Z22
It can be seen that Z22 must be non-negative in order that kz2 be real, as we have assumed.
For p polarisation, 2 = Y2 and eq. (2.8) yields
n22k0 n
2
Y = = q 2k02 : (3.10)
kz2 n22k
2   n20 1k2 sin20 
This leads to the quadratic equation for n22,
n4   Y 2n2 C Y 2n2 sin22 2 2 2 1  = 0; (3.11)
which has real solutions  q 
1
n2 2 4 2 2 22 = Y2 ˙ Y2   4Y2 n1 sin  (3.12)2
provided that Y 4   4Y 2n2 sin22 2 1   0. It can be shown that this condition, together with the condition of
real-valuedness of kz2 [for both solutions of eq. (3.12)], is fulfilled if and only if
Y 2  4n2 sin22 1 : (3.13)
In practice, there are further constraints on the choice of the constituent material of the coating. Other
experimental issues aside, n2 is bounded from below by the refractive index of air, and from above, by
the index at which a second propagative diffraction order appears at the given value of kx . We shall now
show how such constraints of the general form
n2  n2  n2min 2 max (3.14)
can be transformed into equivalent constraints on the immittance of the PC, 3.
We begin by noting that the conditions (3.14) can always be rewritten in the form
2  2  2min 2 max (3.15)
3.3. Design procedure 51
Range of n2 , n2 and n2 Y 2 Y 2
min max x min max
2  n
2
2  2 n
4 4
0 < n min
n
; n n min maxx 2 min max n2  n2 n2  n2
min x max x
n2 4
min 2 2  2  2 n4 n< n < n n 2n max min
2 x min max x n2  n2 n2  n2max x min x
n2 22 2 2 2  n n2 n
4
min < n < n ; 2n < n min x 4n2 min
2 x min x max n2  n2 x n2  n2
min x min x
n2 n2 n2 4
min < n2 < n2 ; min x
n
< n2 4n2 max
2 x min n2  n2 max x n2  n2
min x max x
n2  n2 < n2  2 n42n maxx max x 2   2 1min nmax nx
n2  n2 ; 2n2 < n2x x max 4n2x 1min
Table 3.1 Minimum and maximum bounds on Y 22 sufficient and necessary for fulfilment of the condition (3.14)
together with the constraint (3.13) for at least one of the solutions (3.12) of eq. (3.11). The symbol n2x denotes
n2 sin21  .
with appropriate  and  . Specifically, for s polarisation, the formulas for Z2 and Z2min max min max
follow readily from eq. (3.9):
2 1 1Zmin =   ; Z
2
max =   : (3.16)n2max n2 21 sin  n2 n21 sin2 min
For p polarisation, due to the more complex form of eq. (3.12) and the presence of the supplementary
condition (3.13), several cases must be considered. The final formulas for Y 2 and Y 2max are given inmin
table 3.1.
To arrive at the form of the constraints on 3, we substitute eq. (3.7) into inequality (3.15) and
introduce reduced immittances Q i  i=1 (i = 3, min, max), obtaining
Q  ReQ C jQ j22  3 3Q  Q
2
min   max: (3.17)Re3 1
This expres"sion can be rewritten as Q   Q  #2 2 2 2
ReQ3  
1C 1  
min C .ImQ3/2   min .ReQ3   1/  0; (3.18a)
" 2 2Q   Q  #2 2 2 2
ReQ   1Cmax C 1  .ImQ /2   max .ReQ3 3 3   1/  0: (3.18b)
2 2
It follows that the constraints (3.14) are equivalent to the following conditions on Q3:
.Q3 2 extP  and Q3 2 extCmin and Q3 2 intCmax/
Q 2 Q 2 Q 2 (3.19)or .3 intP  and 3 intCmin and 3 extCmax/;
where P 
Q 
 
stands for the half-plane ReQ3 < 1, C 1 Q 2 1min, the circle of radius j1   j centred at .1C2 min 2
2 /; 0 , and C , the circle of radius 1 j1   Q 2 j centred at 1max max .1C Q 2max/; 0 . The symbols intAmin 2 2
and extA denote the interior and exterior of a region A, and the overbar denotes set closure. Thus, for
instance, intA stands for the interior of the set A together with its boundary.
To illustrate various possible geometries of the region of the complex Q3 plane determined by the
constraints (3.14) transformed into the form (3.19), fig. 3.4 shows the shape of this region for s polarisa-
tion and three distinct choices of the parameters nmin, nmax, n1 and  .
52 Chapter 3. Antireflection gratings for photonic crystals
1
(a) (b) (c)
Cmax
Cmin Cmin Cmin
Cmax
0 Cmax
 1
0 1 2 0 1 2 0 1 2 3
ReZQ Q3 ReZ3 ReZQ 3
Figure 3.4 Regions of the complex ZQ 3 plane determined by the condition (3.19) equivalent to the constraint
(3.14) for s polarisation and (a) n1 = 1, nmin = 1:5, nmax = 3,  = 0, (b) n1 = 1, nmin = 1, nmax = 3,  = 30ı, (c)
n1 = 1:5, nmin = 1, nmax = 3,  = 0. The circles Cmin and Cmax are defined in the text after eq. (3.19); note that
in the case (b) Cmax degenerates into the point .1; 0/.
Step 2 The coating obtained in step 1 is not practical, since its fabrication would call for integration
of the PC with a completely different solid; moreover, a suitable material with the required value of
refractive index might not be easily available. However, as noted in subsection 3.2.1, a homogeneous
thin film can often be replaced without adverse effects by a subwavelength grating. Such a grating could
be easily etched in the same process as the underlying PC; it would then naturally be composed of the
same materials as the PC, with permittivities, say, l and h (l < h).
In order to calculate the fill factor of a binary lamellar grating mimicking a layer with refractive
index n2 obtained in the previous step, one can resort to the classical second-order effective-medium
theory of gratings due to Rytov, described in ref. 92. According to this theory, the effective permittivity Qs
of a binary grating with period a and fill factor f (0  f  1), composed of materials with permittivities
l and h, and operating in the s polarisation is
 2
  
Q N C k0a
2
2   2 .h   l/
2
s = s 1 f .1 f / N ; (3.20)3 2  s
where
Ns = fh C .1   f /l: (3.21)
For p polarisation, the effective permittivity Qp is
 2 2  2
Q = N C   k0a 2   2   2 N Npp p 1 f .1 f / .h l/ s ; (3.22)
3 2  hl
where  
N f C 1   f
 1
p = (3.23)
h l
and Ns is given by eq. (3.21). Thus, the required fill factor can be obtained by setting Qs or Qp to n22 in eq.
(3.20) or (3.22) and solving it numerically for f .
It should be noted that in the domain of validity of Rytov’s theory (small k0a=2 ) the functions Qs.f /
and Qp.f / are monotonically increasing from l to h. Thus, a binary grating cannot simulate a material
with permittivity outside the range delimited by the permittivities of the grating’s constituent materials.
As a result, the bounds n2 and n2max mentioned in step 1 must fulfil n
2  l and n2min min max  h,
respectively.
ImZQ 3
3.4. Examples 53
0:50
PC
air
0:25
0:00
 0:25
 0:50
 0:5 0:0 0:5
kxa=2 
Figure 3.5 Solid line: EFC of the PC considered in subsection 3.4.1 at frequency ! = 0:311  2 c=a and for
s polarisation. Dashed line: EFC of air at the same frequency.
Step 3 The structure obtained at this stage should, in principle, ensure low reflectance for incidence
angles close to  . Nevertheless, owing to the applied approximations—neglect of higher diffraction
orders excited by the PC and the AR grating—its geometrical parameters might not be precisely optimal.
In addition, it is well known [91, 92] that trapezoidal and triangular AR gratings have larger angular
and frequency tolerance than lamellar ones. Therefore, it is advisable to apply a numerical optimisation
procedure to adjust the geometry of the grating, described by some small number of parameters, so as
to minimise a given objective function . The geometry obtained in step 2 can be expected to provide a
good starting point for a local search algorithm, such as the Nelder-Mead simplex method [110, section
10.4].
3.4 Examples
3.4.1 A photonic-crystal flat lens
Preliminaries The first PC we shall consider is a hexagonal lattice of air holes of radius r = 0:365a,
where a is the lattice constant, etched in a dielectric matrix of permittivity  = 10:6. These parameters
correspond to the structure whose fabrication was reported in ref. 18. For s polarisation, at frequency
! = 0:311  2 c=a, the effective refractive index n =  1 can be attributed to the crystal, since its
EFC takes an approximately circular shape (fig. 3.5) with radius K  !=c and group velocity directed
inwards. (Unless otherwise noted, all calculations whose results are presented in this subsection have
been made with the differential method [69, 74–76].)
Veselago [20] predicted that a slab of material with n =  1 should act as a flat lens: an image of
an object placed near one of the surfaces of the slab should be produced on the other side of the slab.
Figure 3.6 shows the map of the modulus of the electric field generated by a wire source with current
1A (ampere) located above a slab of the PC in question.? The parts (a) and (b) refer to slabs truncated
in the ways shown in figs. 3.7(a) and (b), respectively; from now on, these two structures will be referred
to as S1 and S2. In accordance with the theoretical predictions, images are formed below the slabs.
? The field maps shown in figs. 3.6 and 3.12 have been produced with the finite-element method using the RF module of
the COMSOL program. The computational domains were rectangles of width 55a and height 30a surrounded by perfectly
matched layers of thickness 3a. The meshes consisted of about 225,000 second-order triangular Lagrangian elements
of maximum size 0:2a (refined further in the neighbourhood of the point source). Numerical convergence was tested by
comparing the results of a representative calculation against those obtained after refining the mesh by dividing each element
into four. This produced no visible changes in the field map and the maximum amplitude of the image produced by the
lens changed by less than 1%.
kza=2 
54 Chapter 3. Antireflection gratings for photonic crystals
200
(a)
10
150
0 100
50
 10
0
200
(b)
10
150
0 100
50
 10
0
 20  10 0 10 20
x=a
Figure 3.6 Modulus of the electric field generated by an s-polarised wire source with current 1A located above
a slab of the PC studied in subsection 3.4.1 truncated along a plane (a) lying midway between two neighbouring
rows of holes, (b) crossing the centres of holes.
However, their amplitude is low (67 and 79V=m for structures S1 and S2, respectively) and intense
beams reflected from the top of the lenses are visible in the upper part of the plots. This suggests that
only a small fraction of energy is transmitted through the lenses. Indeed, as shown in fig. 3.7(a), the
reflectance of structure S1, jr 20./j , where r0 is the specular reflection coefficient, exceeds 29% for all
angles of incidence. Structure S2 performs better for low incidence angles, but degrades quickly with
increasing  . We shall now apply the algorithm presented in section 3.3 to design an AR grating for
this PC.
Step 1 We have seen in section 2.4 that the effective-medium model of PCs tends to be more accurate
for crystals truncated along a plane with constant permittivity profile, as is the case, for instance, for
structure S1. Therefore in the first step of the design procedure we shall calculate the effective transverse
impedance Z3 of this structure. We consider two ways of obtaining this quantity. First, we calculate it
from eq. (2.23), derived in the framework of the model presented in chapter 2. At frequency ! = 0:311
2 c=a and angle of incidence  = 45ı (corresponding to kx = 0:220  2 =a) we get Z1 = 1:414 and
Z3 = 0:319. We should now check whether ZQ 3  Z3=Z1 = 0:225 lies within the region determined by
the conditions (3.19) equivalent to the constraints (3.14) with nmin = 1 and nmax = 2:51 (the maximum
index of a medium in which only a single propagative diffraction order exists). Figure 3.8, in which
z=a z=a
jEy j (V=m) jEy j (V=m)
3.4. Examples 55
1:00
S1
0:75 S2
0:50
(a) S1
0:25
0:00
0 30 60 90
Angle of incidence  (deg)
(b) S2
(c)
Figure 3.7 Geometry of the PC studied in subsection 3.4.1 truncated along a plane (a) lying midway between
two neighbouring rows of holes, (b) crossing the centres of holes. (c) Angular dependence of the reflectance of
the structures shown in parts (a) and (b).
1
Cmin
B
0 C
A max
 1
0 1 2
ReZQ 3
Figure 3.8 Shaded circle: region of the complex ZQ 3 plane determined by the condition (3.19) equivalent to the
constraint (3.14) for s polarisation, n1 = nmin = 1 and nmax = 2:51. Points A and B: reduced impedances ZQ 3 of
structure S1 calculated in two different ways described in the text.
the value of ZQ 3 cited above is marked with point A, shows that this is indeed the case. Therefore eqs.
(3.5) and (3.9) can be used to calculate the parameters of the AR coating of the crystal: refractive index
n2 = 1:649 and thickness d2 = 0:540a. The geometry of this structure, called S3 from now on, is shown
in fig. 3.9(a) and its reflectance is plotted in fig. 3.9(e) with a solid black line. It can be seen that the
application of the coating reduces significantly the reflectance of the crystal, especially for small angles
of incidence. However, the parameters of S3 are certainly not optimal, since its reflectance at the “design
angle”  = 45ı is as large as 9%. This is due to the relatively large error introduced by the single-mode
approximation for negative-refraction PC bands, as pointed out in chapter 2.
We shall evaluate, therefore, an alternative method of obtaining Z3, which consists in calculating
it directly from the rigorous specular reflection coefficient r0 of the uncoated crystal at the chosen !
and kx . In other words, we assume that r0 can be expressed in the form r0 = .Z3  Z1/=.Z3CZ1/ [cf.
eq. (3.2)] and invert this formula to obtainZ3 = Z1.1Cr0/=.1 r0/. Of course, the effective impedance
defined in this way depends on the material properties of medium 1. Nevertheless, at least for the PC in
question, this dependence is weak for sufficiently small n1: we obtain Z3 = 0:258C 0:175i for n1 = 1
and the effective impedance does not change by more than 10% up to n1 = 2:25. As shown in fig. 3.8, the
reduced impedance ZQ 3 = 0:182C 0:124i corresponding to the above value of Z3 (marked with point B)
also lies within the allowed region of the ZQ 3 plane. Taking this value of Z3, from eqs. (3.5) and (3.9)
ImZQ 3
Reflectance jr j20
56 Chapter 3. Antireflection gratings for photonic crystals
n2 = 1:649
d2 = 0:540a
(a) S3
1:00
S3
n2 = 1:884 0:75 S4
d2 = 0:565a S5
0:50 S6
(b) S4
0:25
f = 0:192 0:00
d 0 30 60 902 = 0:565a
Angle of incidence  (deg)
(c) S5
(e)
f = 0:192
d2 = 0:565a
(d) S6
Figure 3.9 (a)–(b) Geometry of AR coatings S3 and S4, characterised by refractive index n2 and thickness d2
specified next to the drawings. (c)–(d) Geometry of binary lamellar AR gratings S5 and S6, characterised by
fill factor f and thickness d2 specified next to the drawings. (e) Angular dependence of the reflectance of the
structures shown in parts (a)–(d).
we get n2 = 1:884 and d2 = 0:565a. The angular dependence of the reflectance of the PC covered with
this coating, shown in fig. 3.9(b) and called S4 in the following, is plotted in fig. 3.9(e) with a solid grey
line. It is evident that this structure has much better angular tolerance than S3; moreover, its reflectance
at  = 45ı is only 0.05%. Therefore we choose S4 as a basis for the further steps of the algorithm.
Step 2 Numerical inversion of eq. (3.20) gives the fill factor f = 0:192 of the binary grating mimick-
ing a medium with n = 1:884. Since we would like the angular dependence of r0 to be symmetric with
respect to  = 0, the grating should be positioned so as to preserve the vertical mirror symmetry axes of
the underlying PC. This can be done in two possible ways, shown in figs. 3.9(c) and (d). The reflectance
of these two structures, called S5 and S6, is plotted in fig. 3.9(e). Clearly, grating S5 reproduces fairly
faithfully the original reflectance curve of the AR coating S4. On the other hand, grating S6 behaves
better in the high- region.
Step 3 The lamellar gratings obtained in step 2 provide already a remarkable improvement over the
uncoated PC and, in contrast to the AR coatings from step 1, should be manufacturable. Nevertheless,
their geometry can be further ameliorated. To this end, as mentioned in the last paragraph of section 3.3,
we use the Nelder-Mead simplex algorithm to find the optimum values of the dimensions wi, wo, hi, and
ho parametrising the trapezoidal grating shown in fig. 3.10. The objective function  is defined as the
average of the numerically calculated reflectance of the given structure over the desired angular tolerance
Reflectance jr j20
3.4. Examples 57
a
p
a 3=4
hi
ho
wo
wi
Figure 3.10 Definition of the geometrical parameters wi, wo, hi, and ho of a trapezoidal grating superposed on
the surface of structure S1.
interval Œmin; max, Z
1 max
 =   jr0./j
2 d: (3.24)
max min min
The integral in eq. (3.24) is calculated with the 20-point Gauss-Legendre quadrature algorithm [110,
section 4.5], whose typical relative accuracy, 10 5, is better than that of the reflectance calculations,
10 3. The initial shape of the grating is taken to correspond to one of the lamellar gratings obtained in
step 2, i.e., wi = wo = fa, hi = 0, and ho = d2. The search routine is terminated when the size of the
simplex, defined as the average distance of its vertices from its geometric centre, falls below 10 5. The
final values of the geometrical parameters of the grating are determined by selecting the best among the
16 structures obtained by rounding each of the parameters delivered by the simplex algorithm upwards
or downwards to a multiple of 0:01a.
Application of this procedure with  = 0ı,  = 90ımin max to grating S5 yields grating S7 shown in
fig. 3.11(a). The plot in fig. 3.11(e) (solid black line) demonstrates the excellent antireflective properties
of this structure (note the scale of the vertical axis). Its average reflectance is as low as 2.8%; in fact,
jr ./j2 does not exceed 5.5% until  = 87ı0 . The structure does not seem to present special fabrication
difficulties—e.g., acute angles—except possibly for the relatively thin dielectric veins separating the
circular holes from the surface. Should this pose a real experimental difficulty, one can increase the
value of hi at the expense of a slight performance deterioration. For example, grating S8 with hi = 0:08a
has average reflectance of 4.8%.
Figure 3.12 shows the map of the modulus of the electric field produced by a point source placed
above a PC slab coated with AR gratings of type S7 from above and below. The comparison with fig. 3.6
reveals the significant improvement brought about by the AR grating: not only are the reflected beams
prominent in the upper part of the latter figure suppressed, but the amplitude of the image formed by the
lens grows to 159V=m, which is two times better than in the situation from fig. 3.6(b).
Optimisation of structure S6 leads to gratings with average reflectance comparable to that of S7 and
S8 but composed of “narrower” trapezoids (wiCwo  0:2a), thus less suitable for fabrication. Therefore
we omit the detailed discussion of these structures.
Other structures In refs. 111 and 112 two other trapezoidal AR gratings, here denoted S9 and S10,
were presented. Their geometrical parameters, shown in figs. 3.11(c) and (d), were obtained by minimis-
58 Chapter 3. Antireflection gratings for photonic crystals
wi = 0:40a
wo = 0:16a
hi = 0:05a
ho = 0:55a
(a) S7
0:20
wi = 0:28a S7
wo = 0:28a 0:15 S8
hi = 0:08a S9
ho = 0:50a 0:10 S10
(b) S8
0:05
wi = 0:50a
wo = 0 0:00
hi = 0:01a 0 30 60 90
ho = 0:69a Angle of incidence  (deg)
(c) S9
(e)
wi = 0:29a
wo = 0:22a
hi = 0:08a
ho = 0:53a
(d) S10
Figure 3.11 (a)–(d) Geometry of AR gratings S7–S10 characterised by parameters wi, wo, hi, and ho specified
next to the drawings. (e) Angular dependence of the reflectance of the structures shown in parts (a)–(d). To help
visualise the details of the jr 20./j dependence, the y axis has been truncated at jr 20j = 0:2.
200
10
150
0 100
50
 10
0
 20  10 0 10 20
x=a
Figure 3.12 Modulus of the electric field generated by an s-polarised wire source with current 1A located above
a slab of the PC studied in subsection 3.4.1 with S7-type gratings placed on its horizontal surfaces.
z=a
Reflectance jr j20
jEy j (V=m)
3.4. Examples 59
max wi wo hi ho
90ı 0:378–0:424a ( 22 nm) 0:151–0:170a ( 9 nm) 0:045–0:055a ( 5 nm) 0:543–0:557a ( 7 nm)
80ı 0:330–0:463a ( 63 nm) 0:132–0:186a (26 nm) 0:033–0:062a (14 nm) 0:530–0:569a (19 nm)
60ı 0:192–0:533a (162 nm) 0:084–0:208a (59 nm) 0 –0:082a (39 nm) 0:497–0:586a (42 nm)
Table 3.2 Ranges of geometrical parameters of grating S7 for which its average reflectance at frequency 0:311
2 c=a in the angular range 0    max does not exceed 5%. The numbers in parentheses are the lengths of the
tolerance intervals for a = 476 nm, which corresponds to operation wavelength  = a=0:311 = 1530 nm. Note that
the tolerance intervals correspond to perturbations of one parameter at a time (not all parameters simultaneously).
R
ing the objective function 2  =20 jr0./j d (average modulus of the specular reflection coefficient r0) 
calculated with a less accurate quadrature algorithm. The average reflectance of structure S9 in the full
0ı–90ı range, 2.8%, matches that of S7; in a more restricted range, say, 0ı–80ı, the performance of
grating S9 is even slightly better. Nonetheless, its disadvantage lies in the presence of very thin dielectric
veins at the surface. Grating S10, with hi = 0:08a, is devoid of this problem. However, it is superseded
by structure S8 with identical hi, which has somewhat lower average reflectance.
Tolerance to fabrication imperfections A fabrication process invariably perturbs the geometrical
parameters of the manufactured structure. To assess the sensitivity of the proposed gratings to fabrication
errors, we have determined the maximum perturbation of each of the four geometrical parameters of
grating S7 for which the grating’s average reflectance in the angular range 0    max did not exceed
5%. Three values of  were considered: 90ı, 80ı, and 60ımax . The results of this test are summarised
in table 3.2. It can be seen that the grating is more sensitive to variations of the height of the trapezoids
(via the h and h parameters) than of their width (w and w ). The constraints for  = 90ıo i o i max and
 = 80ımax are rather stringent and unlikely to be met in practice. In contrast, fabrication of a structure
satisfying the constraints for  = 60ımax seems well within reach of current technology.
We have also tested the frequency tolerance of grating S7, finding that the its average reflectance stays
below 5% for 0:3094  !a=2 c  0:3113 ( = 90ı), 0:3048  !a=2 c  0:3122 ( = 80ımax max ),
and 0:2511  !a=2 c  0:3173 ( = 60ımax ). This tolerance seems quite sufficient for applications
related to lensing.
3.4.2 A supercollimating photonic crystal
Preliminaries The second example to be considered is a PC composed of a square lattice of air
holes of radius r = 0:3a, where a is the lattice constant, etched in a dielectric matrix of permittivity
 = 12:25. Near the frequency ! = 0:265  2 c=a its EFCs for p polarisation take a square-like
shape (cf. fig. 3.13. In consequence, supercollimated beams [16, 113] can propagate in the crystal.
All calculations reported in this subsection have been made with a frequency-domain finite-difference
method with subpixel smoothing implemented along the lines of ref. 114.
Figure 3.14(c) shows the angular dependence of the reflectance of this PC at ! = 0:265  2 c=a;
two different truncation planes, shown in figs. 3.14(a)–(b) and called S11 and S12 in the following, are
considered. It is seen that the crystal cut through hole centres has fairly low reflectance: about 10% at
normal incidence and decreasing for larger angles up to   65ı. This level of power losses might in
fact be already sufficient for practical applications. Nevertheless, for the sake of illustration, we shall
present the design procedure of AR gratings that help to decrease even further the reflectance of the PC
in question.
60 Chapter 3. Antireflection gratings for photonic crystals
0:50
0:25
0:00
 0:25
 0:50
 0:5 0:0 0:5
kxa=2 
Figure 3.13 EFC of the PC studied in subsection 3.4.2 at frequency ! = 0:265  2 c=a. The shaded region
corresponds to the range   45ı (jkxj  0:187  2 =a), where the EFC is approximately flat and for which the
minimisation of the PC’s reflectance is made.
1:00
S11
0:75 S12
0:50
(a) S11
0:25
0:00
0 30 60 90
Angle of incidence  (deg)
(b) S12
(c)
Figure 3.14 Geometry of the PC studied in subsection 3.4.2 truncated along a plane (a) lying midway between
two neighbouring rows of holes, (b) crossing the centres of holes. (c) Angular dependence of the reflectance of
the structures shown in parts (a) and (b).
Step 1 We are mostly interested in coupling the incoming light to modes lying on the flat horizontal
part of the PC’s EFC. As shown in fig. 3.13, at frequency ! = 0:265  2 c=a this corresponds roughly
to the range j j  45ı, i.e., jkxj  0:187  2 =a. Therefore we choose  = 22:5ı as the design
angle of the AR coating. As in the previous subsection, we test two different ways of calculating the
effective immittance (in this case, admittance) of the crystal cut along a constant-permittivity plane, i.e.,
structure S11. The effective-medium model presented in chapter 2 yields Y3 = 6:138. In turn, the
effective admittance calculated from the rigorous reflection coefficient of structure S11 embedded in air
is Y3 = 6:075   1:191i. Figure 3.15 shows that the reduced admittances corresponding to both these
values lie within the region of the complex YQ3 plane determined by the conditions (3.19) equivalent to
the constraints (3.14) with n1 = nmin = 1, nmax = 3:391 (the refractive index for which the second
propagative diffraction order appears) and  = 22:5ı. The parameters of the AR coatings determined
from these two values of Y3 are (n2 = 2:548, d2 = 0:374) and (n2 = 2:595, d2 = 0:391), respectively.
Figure 3.16 shows the geometry of these coatings, henceforth referred to as S13 and S14, and the angular
dependence of their reflectance. As in the PC lens case, the AR coating S14 designed using the value of
Y3 obtained from the rigorous reflection coefficient of the crystal performs slightly better than the other
one. Therefore structure S14 shall be used in the subsequent design step.
kza=2 
Reflectance jr j20
3.4. Examples 61
5 Cmax
0 Cmin A
B
 5
0 5 10
ReYQ3
Figure 3.15 Shaded circle: region of the complex YQ3 plane determined by the condition (3.19) equivalent to the
constraint (3.14) for p polarisation, n1 = nmin = 1 and nmax = 3:391. Points A and B: reduced admittances YQ3 of
structure S11 calculated in two different ways described in the text.
1:00
= S13n2 2:548
0:75 S14
d2 = 0:374a
0:50
(a) S13
0:25
n2 = 2:595 0:00
d = 0:391a 0 30 60 902
Angle of incidence  (deg)
(b) S14 (c)
Figure 3.16 (a)–(b) Geometry of AR coatings S13 and S14, characterised by refractive index n2 and thick-
ness d2 specified next to the drawings. (c) Angular dependence of the reflectance of the structures shown in parts
(a) and (b).
Step 2 From numerical inversion of eq. (3.22) it follows that the fill factor of the binary grating mim-
icking a medium with n = 2:595 for p polarisation is f = 0:812. Figures 3.17(a)–(b) show the geometry
of the two gratings, called S15 and S16, with this fill factor and a mirror symmetry plane perpendicular to
the direction of periodicity. From the juxtaposition of their reflectance curves [fig. 3.17(c)] it follows that
structure S15 has somewhat better performance than S16. Incidentally, there is some similarity between
the geometry of grating S15 and the truncated crystal S12, which also exhibited fairly low reflectance:
The surface of both these structures contains “teeth” shifted by 1a in the horizontal direction with re-
2
spect to the positions of the circular holes. Therefore, one could view the crystal S12 as an imperfect
realisation of the AR grating S15.
Step 3 The lamellar grating S15 can be further ameliorated by adjusting its thickness d2 and fill
factor f to minimise the objective function  defined in eq. (3.24). We take min = 0, max = 45
ı and,
as before, perform the optimisation with the Nelder-Mead simplex algorithm. This leads to structure S17
with d2 = 0:37a and f = 0:73, shown in fig. 3.17(c). Its reflectance curve is plotted in fig. 3.17(d) (solid
line). In the angular range 0    45ı, the reflectance never exceeds 0.6%, on average amounting
to only 0.12%. The structure does not seem to present any special fabrication problems. It is possible
to continue the grating’s optimisation by allowing it to take a trapezoidal rather than a lamellar shape;
however, in view of its already very good AR properties, this appears unnecessary.
ImYQ3
Reflectance jr j20
62 Chapter 3. Antireflection gratings for photonic crystals
f = 0:812
d2 = 0:391a 1:00
S15
(a) S15 0:75 S16
S17
0:50
f = 0:812
d2 = 0:391a 0:25
(b) S16 0:00
0 30 60 90
Angle of incidence  (deg)
f = 0:730
(d)
d2 = 0:370a
(c) S17
Figure 3.17 (a)–(c) Geometry of binary lamellar AR gratings S15, S16 and S17 characterised by fill factor f
and thickness d2 specified next to the drawings. (d) Angular dependence of the reflectance of the structures shown
in parts (a)–(c).
3.4.3 A photonic-crystal superprism
We have also attempted to design an AR grating for the unidirectional mirror proposed by Vanwolleghem
et al. [115]. This device, which will be analysed in some more detail in subsection 5.2.3, is slab of the PC
shown in fig. 3.18(a). The PC consists of a hexagonal lattice of triples of adjacent circular holes etched
in a magneto-optical (MO) matrix characterised by a gyrotropic permittivity tensor
2 3
O = 4.2:5/
2 0 0:1i
0 .2:5/2 0 5 : (3.25)
 0:1i 0 .2:5/2
The presence of this MO material lifts the time-reversal symmetry of Maxwell’s equations; the spatial
inversion symmetry is also broken owing to the particular choice of the motif. As a result, the crystal
becomes nonreciprocal, i.e., the usual property of the dispersion relation, !.kE/ = !. kE/ [79, pp. 22–23],
no longer holds. The p-polarisation EFC of this crystal at frequency ! = 0:3915  2 c=a, calculated
with the method described in section 5.2, is shown in fig. 3.18(b). It can be seen that a plane wave
impinging at the angle of about 58ı (corresponding to kx   =3a) on the top surface of a slab made
from this PC will be coupled to its propagative mode, and thus will be partially transmitted. However,
a wave travelling in the opposite direction, incident from the bottom, will be totally reflected, since the
crystal has no propagative modes with kx    =3a. This behaviour justifies the name unidirectional
mirror.
The problem with the presented device is its large forward loss: even waves propagating in the
“allowed” direction undergo a significant reflection on the surfaces of the slab. Currently we do not
have a reliable code allowing to calculate accurately the reflection coefficient of the MO PC from fig.
3.18(a) in p polarisation. Therefore we shall study instead the non-MO crystal in which the original motif
composed of three circles is replaced by three overlapping squares, as shown in shown in fig. 3.19(a). The
permittivity of the matrix is taken as  = .2:5/2. [This modified geometry is due to K. Postava (Technical
Reflectance jr j20
3.5. Conclusions 63
(b)
(a) 0:50
a a 0:25
r
0:00
 0:25
 0:50
a
 0:5 0:0 0:5
kxa=2 
Figure 3.18 (a) Geometry of the PC composed of a hexagonal lattice of groups of three adjacent circular holes
with radius r = 0:20a, where a is the lattice constant, etched in a magneto-optical matrix. (b) p-polarisation EFC
of this crystal at frequency ! = 0:3915  2 c=a.
University of Ostrava, Czech Republic).] The EFC of this crystal at frequency ! = 0:4548  2 c=a,
calculated with the differential method, is shown in fig. 3.19(b). Clearly, its shape in the regions marked
by dashed circles is similar to that seen in fig. 3.18(b). Fig. 3.19(c) shows a magnification of this EFC
near its inflection point kx = 0:309 2 =a, together with the kx-dependence of the crystal’s reflectance.
It can be seen that the latter is very high. Therefore, to be useful in practice, the unidirectional mirror
would need to be coated with some AR structure.
Unfortunately, the design of an appropriate AR grating using the procedure described in section 3.3
turns out to be impossible. For instance, at the inflection point of the EFC, the reflection coefficient of
the uncoated PC is r0 = 0:969   0:086i, which corresponds to YQ3 = 6:50   20:5i. As evidenced by
fig. 3.19(d), this lies far outside the region of the complex YQ3 plane determined by the conditions (3.19)
equivalent to the constraints (3.14) with n1 = nmin = 1 and nmax = 1:52 (the refractive index of the
least optically dense coating in which the second propagative diffraction order would appear). In fact, if
we blindly apply eqs. (3.7) and (3.12) to calculate the refractive index of the optimum AR coating, we
obtain n2 = 12:4 or 0:68. It is obvious that none of these indices can be simulated by any binary grating
composed of the constituent materials of the PC. Therefore, an AR structure for the unidirectional mirror
will probably need to be designed with some purely numerical method. In particular, Lawrence et al.
[107] have shown their approach to give good results for a superprism that, uncoated, has an extremely
high reflectance (jr j20 = 0:996).
3.5 Conclusions
In this chapter we have presented a new method of designing gratings that, superimposed on surfaces
of PCs crystals, will minimise their reflectance. The design algorithm consists of three steps. First, the
parameters of a homogeneous-layer AR coating are calculated from an effective-medium approximation
of the PC in question. Second, an analytical effective-medium theory of gratings is used to find the
parameters of a binary lamellar grating composed solely of the constituent materials of the crystal and
approximating the coating obtained in the previous step. Third, the shape of the grating is refined with
a numerical local-search routine so as to minimise the reflectance of the structure in the desired angular
kya=2 
64 Chapter 3. Antireflection gratings for photonic crystals
a 0:746a
(a) (b)
0:4a 0:50
0:25
0:00
0:3a
0:4a  0:25
p
p 3
3 a  0:50
a 2
2
truncation plane  0:5 0:0 0:5
kxa=2 
1:0 0:60 1:0
(c) (d)
0:9 0:55 0:5
Cmax
0:8 0:50 0:0 Cmin
0:7 jr0j2 0:45  0:5
kza=2 
0:6 0:40  1:0
0:250 0:275 0:300 0:325 0:350 0:0 0:5 1:0 1:5 2:0
kxa=2  ReYQ3
Figure 3.19 (a) Geometry of the PC composed of a hexagonal lattice of non-centrosymmetric motifs etched
in a dielectric matrix. (b) p-polarisation EFC of this crystal at frequency ! = 0:4548  2 c=a. (c) Solid line:
kx-dependence of the reflectance jr 20j of this crystal, placed in air and truncated in the way indicated in part (a).
Dashed line: a fragment of the EFC from part (b). (d) Shaded circle: region of the complex YQ3 plane determined
by the condition (3.19) equivalent to the constraint (3.14) for p polarisation, n1 = nmin = 1 and nmax = 1:52. The
reduced admittance of the crystal, YQ3 = 6:50   20:5i, lies far beyond the range of the graph.
or frequency range. This last step is necessary owing to the approximations made in the analytical
derivations used in the first two steps of the procedure.
This algorithm of AR grating design can be viewed as complementary to the method proposed by
Lawrence et al. [106, 107]. While their approach is based on an exhaustive scan of the whole parameter
space (made very efficient by the application of the matrix-valued effective immittance of gratings), ours
rests on approximate analytical considerations used to find a starting point for a local search procedure.
In section 3.4 the proposed method has been applied to three example crystals with EFCs of different
curvature: a supercollimating crystal with a very flat EFC, a crystal exhibiting negative refraction, with
almost circular EFC, and a PC superprism, whose EFC has a kink. In the two first cases, the design
process succeeded in producing AR gratings ensuring very low reflectance in a wide angular range.
The obtained structures are quite compact and apparently rather straightforward to fabricate. In the
last case, the procedure broke down owing to the violation of the constraints (3.19) on the effective
immittance of the crystal that must be satisfied in order that the AR coating produced in the first step can
be approximated with a binary grating made of realistic materials. The existence of these constraints is
the basic limitation of the presented procedure.
jr 20j
kza=2 
ImYQ3
kza=2 
Chapter 4
Magneto-optical circulators
4.1 Introduction
4.1.1 Basic characteristics of isolators and circulators
This chapter will be devoted to the design of magneto-optical circulators optimised for operation at in-
frared frequencies in a uniform static external magnetic field (SEMF). Circulators and (closely related)
isolators are devices widely used both in the optical and microwave domain. Their operation can be
most easily explained with the formalism of scattering matrices. Consider the junction of waveguides
W1, W2; : : : , Wn shown in fig. 4.1. On any cross-section Pj (called a port) of waveguide Wj located
sufficiently far from the junction, the field can be represented solely in terms of the waveguide’s prop-
agative eigenmodes. Let us assume all the waveguides to be single-mode and denote the amplitudes of
the incoming and outgoing mode of Wj on the port Pj by sj;in and sj;out. If the system under study
is linear, the amplitudes of the outgoing modes can be linked with those of the incoming ones by the
scattering matrix SO of the junction [116, p. 249]:
sEout = SOsEin; (4.1)
where sE = Œs ; s ; : : : ; s T and sE = Œs ; s ; : : : ; s Tin 1;in 2;in n;in out 1;out 2;out n;out . An ideal isolator is a two-
port device that passes a wave coming from waveguideW1 to waveguideW2, but blocks the transmission
in the opposite direction. It is described by the scattering matrix [117, p. 523]
 
0 0
SO = : (4.2)
1 0
In turn, a circulator is an n-port device that couples a wave coming from waveguideW1 to waveguideW2
only, a wave coming from W2 to W3 only, and so on [116, p. 468]. The simplest, 3-port circulator is
described by the scattering matrix [117, p. 536]
2 3
0 0 1
SO = 41 0 05 : (4.3)
0 1 0
It is worth noting that a circulator can be used as a replacement of an isolator if we ensure that no
incoming waves ever reach one of its ports. This can be easily achieved by connecting that port to a
matched load, which does not generate reflected waves.
The above devices have several important applications. They can be used to eliminate waves reflected
from imperfectly matched components of complex circuits; the presence of such waves can give rise to
undesired interferences and parasitic couplings [34]. They are also employed in signal routing in devices
65
66 Chapter 4. Magneto-optical circulators
Wn
Pn
: : :
P1
W1
P2
W2
Figure 4.1 An n-port device.
such as multiplexers [35]. In the optical domain, possibly the most important application of isolators
is the protection of lasers from back-reflected light, which disturbs the standing-wave pattern in a laser
cavity and may cause the device to become unstable [36].
From the Lorentz reciprocity theorem it follows that the scattering matrix of a reciprocal system is
symmetric provided that the amplitudes sj;in and sj;out are normalised so that any mode with unitary
amplitude carries unitary power [116, pp. 235–236 and 249]. By a reciprocal system, we understand
a system consisting of time-invariant, linear media whose material properties [cf. eq. (1.3)] satisfy the
relations [118, p. 10]
O = OT; O = OT and O˛ =   OˇT: (4.4)
Since the scattering matrices from eqs. (4.2) and (4.3) are not symmetric, isolators and circulators must
by necessity contain nonreciprocal materials.
4.1.2 Routes to nonreciprocity
Among the possible ways of building nonreciprocal systems, by far the most common is the introduc-
tion of ferro- and ferrimagnetic materials. The propagation of low-amplitude microwaves in these media
placed in a sufficiently strong SEMF is usually described by considering them to have a tensorial perme-
ability of the form 2 C C   3
O = 41 y z iz iy i 5z 1C x C z ix ; (4.5)
iy  ix 1C x C y
where i and i (i = x; y; z) are proportional to the i th component of the magnetisationME induced by
the SEMF [119, p. 92; 117, p. 503]. For lossless media, O is Hermitian, so that all the parameters i and
i are purely real. Therefore the diagonal part of the tensor defined in eq. (4.5) is real and (obviously)
symmetric, while its off-diagonal part is imaginary and antisymmetric. Tensors with these properties are
called gyrotropic.
Near the ferromagnetic resonance frequency, which for sub-tesla SEMFs falls in the microwave
range, the magnitude of the off-diagonal components of O is comparable to that of the diagonal ones.
This can lead to very strong nonreciprocal effects.
4.1. Introduction 67
At optical frequencies, the propagation of electromagnetic waves in ferro- and ferrimagnetic media
is more commonly handled by attributing them an anisotropic permittivity
2   3 igz igy
O = 4 ig 5z  igx ; (4.6)
igy  igx 
where gi = KMi and the parameter K describes the magneto-optical (MO) properties of the material
[35; 119, p. 236]. MO effects are usually weak; therefore the SEMF-induced perturbation of the diagonal
elements of O is commonly neglected. The real part of K is related to the specific Faraday rotation F
by
F = p
 
Ms ReK; (4.7)
 
where  is the free-space wavelength and Ms denotes the characteristic saturation magnetisation of the
medium. The imaginary part ofK, in turn, is responsible for the effect of circular dichroism. In low-loss
ferrimagnetic materials this imaginary part is often small and therefore in the rest of this chapter we shall
assume K to be real. We shall also introduce the symbol g MsK.
The most commonly used MO materials are (ferrimagnetic) synthetic garnets, of which the most
well-known is yttrium iron garnet (YIG). It is usually grown on substrates made of gadolinium gallium
garnet (GGG). The atoms of yttrium can be substituted by other elements, including bismuth and cerium.
The specific Faraday rotation of partially cerium-substituted yttrium iron garnet (Ce:YIG) at  = 1550 nm
has been measured to be  0:45ı=µm, which corresponds to g =  0:01 [120]. Bismuth iron garnet
(BIG), which is reputed to outperform Ce:YIG [121], has been found to have as large as  30ıF =µm at
 = 540 nm, i.e., g =  0:22 [122]. Unfortunately Vertruyen et al. [122] do not report on measurements
of the specific Faraday rotation of BIG in the infrared range. The available data indicate that F of
this material diminishes with increasing wavelength, but the effect of this decrease on g is partially
compensated by the growth of . It seems realistic to expect that g  0:05–0:1 can be obtained at
infrared frequencies. It is also worth noting that another (non-garnet) material, europium oxide, has been
reported to have g = 0:4 in this frequency range [123]; however, its magneto-optical properties disappear
above the Curie temperature of 69K [124].
There are a few other methods of obtaining nonreciprocal behaviour. In the microwave domain it
is possible to introduce off-diagonal imaginary components to the permittivity tensor of standard non-
magnetic metals, such as gold, by placing them in a strong SEMF. Unfortunately, this method cannot be
applied easily to optical systems because the strength of the necessary SEMF increases with frequency,
reaching several teslas in the optical range; another obstacle consists in the relatively large losses ex-
hibited by metals in this segment of the electromagnetic spectrum. Another possibility consists in using
so-called Tellegen’s media, in which the relation O˛ =   OˇT does not hold; however, in known materials
of this type the magnitude of the real component of the tensors O˛ and Oˇ is very small, and therefore this
method of inducing nonreciprocal behaviour remains so far largely unexplored. Finally, instead of using
materials whose parameters do not meet conditions (4.4), one can violate the other conditions of valid-
ity of the standard Lorentz reciprocity theorem: introduce a time-dependent modulation of the material
properties of the system or employ nonlinear effects.
4.1.3 Experimental realisations of optical isolators and circulators
Bulk magneto-optical isolators A basic feature of MO materials is the phase velocity difference
between right- and left-circularly polarised plane waves propagating parallel to the magnetisation direc-
tion. As a result of this difference, the polarisation plane of a linearly polarised plane wave propagating
68 Chapter 4. Magneto-optical circulators
along the direction ofME gradually rotates; moreover, the direction of this rotation (clockwise or counter-
clockwise), when viewed in the laboratory frame, does not depend on whether the wave propagates par-
allel or antiparallel to ME [116, p. 460–464]. This phenomenon, known as Faraday’s effect, is the basis
of the operation of the archetypical “bulk” optical isolator, shown schematically in fig. 4.2(a). It consists
of a slab of a MO material sandwiched between two polarisers rotated by 45ı with respect to each other
[35]. The slab, magnetised perpendicularly to the planes of the polarisers, has thickness d such that the
polarisation plane of waves traversing the medium rotates by 45ı. Let us assume that this happens in
the clockwise direction. Then a wave coming in through polariser 1 will eventually find its polarisation
plane aligned with the axis of polariser 2. In contrast, the polarisation plane of a wave coming in through
polariser 2 will become perpendicular to the axis of polariser 1. As a consequence, the former wave will
be transmitted, whereas the latter will be absorbed.
As noted in subsection 4.1.2, the specific Faraday rotation (rotation angle per unit length) of com-
monly used MO materials is small. Therefore, optical isolators built in the way presented in the previous
paragraph need to be rather thick (d  0:1–1mm). It is, however, possible to reduce d to tens of mi-
crometres by replacing the single MO layer by a Fabry-Perot resonator composed of a stack of dielectric
and MO thin films, at the cost of a reduced operation bandwidth [125].
Another way of reducing the thickness of a bulk isolator consists in the application of PCs. As
noted first by Figotin and Vitebsky [126], a PC with both the spatial inversion symmetry and the time-
reversal symmetry broken has a dispersion diagram that lacks inversion symmetry. From this it follows
in particular that at a given frequency a band gap can exist for waves propagating in a direction kE, but
not for those propagating in the direction  kE; thus, at such a frequency the PC behaves as an isolator. An
example 1D PC of this type was presented in ref. 127. In this structure, the spatial inversion symmetry
was lifted by the presence of MO layers polarised in opposite directions (but always parallel to the layers,
unlike in Faraday rotators). Since fabrication of such layers might be difficult, Khanikaev and Steel
[128] proposed to break the inversion symmetry by the introduction of a third material into the periodic
lattice. They showed also an alternative resonator-type design, in which a single MO layer is sandwiched
between two different dielectric Bragg mirrors. In turn, the isolator proposed by Vanwolleghem et al.
[115] consists of a 2D PC composed of a lattice of holes drilled in a MO matrix magnetised in the
out-of-plane direction. The shape of holes is chosen so that the system’s spatial inversion symmetry is
lifted.
Owing to their large lateral dimensions, bulk, non-planar structures are difficult to combine with
integrated optical circuits. Therefore, in the last two decades there has been a lot of activity devoted to
the design of isolators and circulators suitable for on-chip manufacturing. Most of these structures are
intended for fabrication in MO garnet layers grown on GGG substrates, although methods of bonding
garnet layers to semiconductor (e.g., silicon) substrates have also been developed. With respect to their
geometry, the proposed devices can be divided into two broad classes: waveguide- and resonator-type
components.
Waveguide-type devices The operation of the earliest waveguide-type isolators was based on the
nonreciprocal conversion between quasi-TE and quasi-TMmodes of rib waveguides, induced by a SEMF
parallel to the waveguide axis. This phenomenon is analogous to Faraday’s effect [35]. However, it
must be noted that in this case the conversion occurs between states whose polarisation planes differ by
90ı rather than 45ı. Therefore, a 45ı-long nonreciprocal Faraday rotator must be connected in series
with a 45ı-long reciprocal rotator. The presence of this additional element, together with the necessary
polarisers at the input and output ports, complicates the fabrication procedure. The main deficiency of the
design based on Faraday’s effect, though, is that while in a bulk MO material the phase velocities of all
plane waves polarised perpendicularly toME are identical, the effective indices of quasi-TE and quasi-TM
4.1. Introduction 69
W3
P2
P1
W1 cavity
P3
W2
(a) (b)
ME
P nonreciprocal section2 P1
(c)
P2 P4
ME
nonreciprocal section
P1 P3
(d)
Figure 4.2 Selected types of optical isolators and circulators. (a) Bulk isolator based on Faraday rotation (after
ref. 35). (b) Three-way resonator-type circulator. (c) Mach-Zehnder interferometer with one nonreciprocal arm.
(d) Nonreciprocal coupler acting as a four-port circulator. The arrows indicate the directions of energy transfer.
70 Chapter 4. Magneto-optical circulators
waveguide modes are, in general, different. For high isolation, the waveguide geometry should therefore
be adjusted to force a close match of these indices. In practice, this is not easy to obtain without post-
fabrication etch-tuning or deposition of an additional dielectric layer [129, 130]. It is worth mentioning,
however, that Dammann et al. [131] showed that the stringent requirements for index matching can be
somewhat relaxed, at the cost of incurring a modest additional forward loss, if the polarisation plane of
the input mode is rotated by 22:5ı from the vertical direction.
The drawbacks listed in the previous paragraph are eliminated in devices exploiting the difference
in the phase velocity of forward- and backward-propagating modes of MO waveguides lacking a mirror
symmetry plane parallel to their axis and placed in a SEMF perpendicular to that axis. The simplest
isolator based on this effect has the form of a Mach-Zehnder interferometer [fig. 4.2(c)] with its two
arms designed so as to introduce a nonreciprocal phase shift of 90ı and a reciprocal shift of the same
value [120, 132, 133]. For a forward-propagating wave, these shifts cancel out, so that the waves coming
from the two arms interfere constructively at the output; for a backward-propagating wave, the shifts add
up, which leads to a destructive interference. Analogous structures based on PC waveguides have also
been investigated [134]. In a different scheme, so-called nonreciprocal multi-mode imaging, a single
multi-mode waveguide is used instead of two single-mode ones [135].
A related type of device is a four-port circulator composed of two coupled MO waveguides [fig.
4.2(d)], whose parameters are chosen so that the phase velocities of forward-propagating modes differ,
while those of backward-propagating ones match. This leads to a difference in the coupling strength of
the two pairs of modes. As a result, a forward-propagating mode stays in the original waveguide, while
a backward-propagating one gradually leaks to the neighbouring waveguide. Both rib-waveguide-based
[136] and PC-waveguide-based [137] designs have been proposed.
Another way of achieving isolation is to employ nonreciprocal absorption. This phenomenon occurs
primarily in ferromagnetic metals, which are usually highly lossy at optical frequencies. The concept
of an isolator based on the difference of the decay rates of forward- and backward-propagating waves
was originally proposed by Zaets and Ando [138] and Takenaka and Nakano [139]. The first success-
ful demonstration of such a device was made by Vanwolleghem et al. [140], who fabricated a system
containing a layer of a cobalt-iron alloy embedded in indium phosphide. Improved version of this iso-
lator were reported on in refs. 141 and 142 (the latter authors used manganese arsenide instead of the
cobalt-iron alloy). In turn, Takeda and John [123] proposed the device consisting of a MO PC waveguide
designed so that its forward- and backward-propagating eigenmodes have significantly different group
velocities. Since the slower mode experiences a longer effective optical path, in the presence of absorp-
tion its decay rate exceeds that of the faster mode. In all these designs current injection is normally used
to compensate for the undesired absorption of the forward-propagating mode.
Certain MO waveguides are characterised by a difference in the cut-off frequency of forward- and
backward-propagating modes. Therefore, in the range between these two frequencies guided-wave prop-
agation is possible in one direction only. As pointed out by the authors of refs. 143, 144 and 145, this
effect can also be used for the construction of an isolator.
Wang et al. [146] have shown that a SEMF can lift degeneracies in the band structure of high-
symmetry PCs containing materials with gyrotropic permittivity or permeability, thus leading to the
creation of band gaps. They also predicted that unidirectional waveguide modes with frequencies lying
within such band gaps can propagate along interfaces separating the just described PCs from dielectric
PCs or metals. This has been subsequently confirmed experimentally [147]. However, these effects have
so far been demonstrated only at microwave frequencies, where the permeability tensor can have off-
diagonal components with magnitude comparable with that of the diagonal ones. The MO effects are
much weaker, and it is not certain whether the band gaps generated in the optical regime will be robust
against disorder [147].
4.1. Introduction 71
Resonator-type devices More suitable for integration than their bulk counterparts, waveguide-type
MO devices must still be rather long in order to provide a satisfactory isolation. For instance, arm lengths
of 1mm are used in the state-of-the-art Mach-Zehnder interferometers whose fabrication was reported
on in ref. 120. According to the review of Dötsch et al. [35], this value is typical. Isolators are thus
much larger than other standard components used in integrated circuits. A possible way of miniaturising
them consists in employing resonant cavities to lengthen the time during which light interacts with the
MO material. Of course, a drawback of this approach is the reduction of the operation bandwidth of the
devices.
Circulators based on resonant cavities are commonly used in the microwave domain [117]. A typical
device of this type is composed of three identical reciprocal waveguides Wi (i = 1; 2; 3) coupled to a
single resonant cavity containing a ferrimagnetic material and, in the absence of SEMF, supporting two
degenerate localised modes of frequency !0 [fig. 4.2(b)]. In a SEMF perpendicular to the plane of the
system, this degeneracy is lifted: the modes couple and form two linear combinations corresponding to
left- and right-rotating modes with frequencies !  and !C [34, 148]. At the frequency 1.!  C !C/, a2
wave incoming from, say, waveguideW1 excites such a superposition of these two eigenmodes that they
interfere constructively in front of one output waveguide (say,W2), and destructively in front of the other
(W3). As a result, an outgoing mode with a significant amplitude appears only in waveguide W2, while
W3 is isolated from the incoming power. Analogously, owing to the three-fold rotational symmetry of
the device, energy transfer occurs in the directions W2 ! W3 and W3 ! W1. The scattering matrix
of the system is then given by eq. (4.3). If the SEMF polarisation is flipped, the direction of the energy
transfer reverses, too.
In 2005 Wang and Fan [34, 37] proposed an analogous device intended for operation at optical
frequencies, composed of a 2D PC cavity coupled to three PC waveguides. Using a model based on
the coupled-wave theory [149], they showed the bandwidth of the circulator to grow with the frequency
splitting !  j!C   ! j. This frequency splitting, in turn, was demonstrated to be proportional to
the integral of the out-of-plane component of the cross product of the electric fields of the cavity modes,
weighted with g, over the area of the cavity.
The authors of ref. 34 observed that in a typical PC cavity the sign of the cross product mentioned
above oscillates rapidly, leading, as a result, to a severe diminution of !. To remedy this, they pro-
posed to divide the MO material in the cavity into several domains polarised in opposite directions, thus
flipping locally the sign of g and forcing the overall sign of the integrand to be constant everywhere.
Unfortunately, the resulting structure is almost impossible to manufacture with the current technology,
since the creation of the necessary magnetic subdomains would require the application of a SEMF inho-
mogeneous on the scale of hundreds of nanometres, with the inhomogeneities precisely aligned with the
geometric structure of the cavity.
In a follow-up paper [150] the same authors presented a design of a four-port circulator composed of
two straight PC waveguides coupled to a single MO cavity with a subdomain structure determined along
analogous principles. In turn, Kono and Koshiba proposed a rib-waveguide-based circulator consisting of
a Mach-Zehnder interferometer coupled to an exterior ring [151], and, subsequently, a device similar to
that from ref. 150, but built from rib waveguides coupled to a MO microdisk [152]. Another contribution
of the latter paper was the introduction of a method of increasing the circulator’s bandwidth by including
several coupled resonators instead of just one. In all these designs, however, division of the MO material
into oppositely-polarised domains is still required.
It is worth noting that in ref. 34 a solution alternative to the introduction of magnetic domains was
also considered, namely the inclusion of a single MO rod in an standard dielectric PC. In principle, it
is possible, but it would also pose serious technological problems related to the growth of two different
materials on a single substrate and the necessity of aligning precisely the structures obtained in two
72 Chapter 4. Magneto-optical circulators
etching processes. In any case, to the best of our knowledge, none of the devices proposed in refs.
34, 37, 150, 151 and 152 has ever been fabricated.
Non-magneto-optical devices As has been noted before, introduction of ferro- and ferrimagnetic
materials is not the only method of making a system nonreciprocal. Therefore a number of isolator and
circulator designs based on the alternative approaches have also appeared in the literature. For instance,
Gallo et al. [153] described optical analogues of diodes employing nonlinear optical processes. Yu and
Fan [154] proposed an isolator based on a time-dependent modulation of the refractive index of parts of
a dielectric waveguide. In turn, Yu et al. [155] showed that the SEMF-induced gyrotropy of metals in the
microwave domain can lead to the creation of unidirectional waveguide modes at the interfaces of these
metals and dielectric PCs.
4.1.4 Outline of this chapter
The aim of the research reported on in this chapter was to design a three-port MO circulator of the
type shown schematically in fig. 4.2(b), suitable for operation in a uniform SEMF, i.e., with all the MO
material magnetised in the same direction. The plan of the text is as follows. In section 4.2 we set the
stage by extending the coupling-wave model of the device in question, introduced by Wang and Fan [34],
to include the influence of direct coupling between the three waveguides and the effect of radiation loss.
These results are used later. In section 4.3 we derive an analytical axisymmetric model of a 2D MO PC
cavity and use it to formulate a design principle of cavities exhibiting maximum frequency splitting in
the presence of a uniform SEMF. This is the key result of this chapter.
Section 4.4 is devoted to PC-based circulators. Having shown how to convert an axisymmetric cavity
designed along the rules established in section 4.3 to a component liable for integration with a periodic
lattice, we demonstrate numerical simulations of a complete circulator embedded in a 2D PC. In sec-
tion 4.5 we investigate rib-waveguide-based devices, which should be simpler to fabricate than PC-based
ones, but present design problems of their own due to imperfect in-plane light confinement. We begin by
detailing the design process of a rib-waveguide-based circulator intended for fabrication in a GGG-BIG
heterostructure. This design is based on 2D finite-element simulations with the influence of the third di-
mension taken into account by help of the effective-index approximation. In subsection 4.5.4 we report
briefly on the outcome of the first attempts to manufacture and characterise this device, made at Institut
d’Electronique Fondamentale (Orsay, France). The measurements indicate that the vertical confinement
provided by the cavity is insufficient. Therefore, in section 4.6 we describe the results of rigorous three-
dimensional (3D) simulations of axisymmetric cavities designed by the method presented in section 4.3
and discuss various methods of improving the vertical confinement. Finally, in section 4.7 we summarise
the results of our work on MO devices.
Some of the results presented in sections 4.3 and 4.4 have appeared previously in ref. 148.
4.2 Extension of the coupled-wave model
4.2.1 Inclusion of direct coupling between waveguides
Let us consider a circulator composed of three identical single-mode waveguides, W1, W2, and W3,
weakly coupled with a resonant cavity and arranged so that the whole system has C symmetry,?3v as
shown schematically in fig. 4.2(b). We assume that in the absence of SEMF the cavity supports a pair of
degenerate orthonormal eigenmodes belonging to the unique two-dimensional irreducible representation
? The symmetry elements of the group C3v are a three-fold rotation axis and three mirror planes intersecting each other at
the angle of 120ı along this axis [80, p. 325].
4.2. Extension of the coupled-wave model 73
of the C3v point group and having frequency !0. They can be classified as even or odd, according to
their symmetry with respect to reflection about the axis of waveguide W1, which is assumed to lie along
the  x axis. The circulator’s operation at frequency ! is described by the coupled-mode equations [149]
 i!aE =  .i O˝ C  O /aE CDO TsEin; (4.8a)
sEout = CO sEin CDO aE; (4.8b)
where the vector aE = .a ; a /T contains the cavity mode amplitudes, sE = .s ; s ; s /Te o in 1;in 2;in 3;in and sEout =
.s ; s ; s /T1;out 2;out 3;out , the amplitudes of the in- and outgoing waveguide modes, the matrix CO describes
the direct coupling between waveguides,DO the cavity-waveguide coupling, O˝ the mode eigenfrequencies
and their coupling, and  O their decay. These matrices are subject to the fundamental constraints [149]
DO DO = 2 O; (4.9a)
CODO  =  DO : (4.9b)
Together with those following from the system’s symmetry, these constraints can be used to reduce the
number of independent parameters necessary for the characterisation of the device. We shall now con-
sider each of the matrices occurring in eqs. (4.8) in turn.
Owing to the three-fold symmetry of the circ O2ulator, the3C matrix must have the form
r t t
CO = 4t r t5 ; (4.10)
t t r
where t  jt j ei and r  jr j ei.C/ are the transmission and reflection coefficients of waveguide modes
in the absence of the cavity. If the system is lossless, as we shall assume in this subsection, we can use
the condition of unitarity of CO to express t and r as
2 cos ei i.C/
t =  p C ; r = p
e
C : (4.11)1 8 cos2 1 8 cos2
Note that the case of no direct coupling, considered in ref. 34, corresponds to  =   and  =   .
2 2
TheDO matrix has the general form 2 3
d1e d1o
DO = 4d d 52e 2o ; (4.12)
d3e d3o
where dim (i = 1; 2; 3; m = e; o) describes the coupling of mth cavity mode with i th waveguide. These
coupling parameters are proportional to the values of the electromagnetic field of the modes along the
waveguide axes. Making use of the assumed symmetry of the mode fields, it can be shown that these six
parameters can be expressed in terms of a single complex co iı2 3upling constant d  jd j e :
1 0
DO = 46 p 7d  1 3p 5 : (4.13)2 2
 1   3
2 2
Substituting this formula into eq. (4.9a),we obtain
1 0
 O =  ; where   3 jd j2: (4.14)
0 1 4
74 Chapter 4. Magneto-optical circulators
The second constraint, eq. (4.9b), yields
.t   r/d = d: (4.15)
Noting that from eq. (4.11) we have
   p2 cos   e
i
i 3 cosC i sint r = e = ei. C/ = eiŒ CCarg.3 cosCi sin/C j C j (4.16)1 8 cos2 3 cos i sin
and writing d in its polar form, we obtain the expression for ı:
ı = 1 Œ.2nC 1/ C  C arg.3 cosC i sin/; (4.17)
2
where n is an integer. Lastly, since the coupling between the cavity modes is assumed to result solely
from their interaction with the SEMF, the O˝ matrix takes the form [34]
 j jO˝ !0 i V=   j j ; (4.18)i V !0
where V is the mode coupling strength. The eigenvalues of this matrix, !˙  !0 ˙ jV j, are the
frequencies of the eigenmodes of the cavity in isolation (uncoupled to waveguides). The frequency
splitting!  !C !  = 2jV j is proportional to the mode coupling strength. As noted in ref. 148, it is
often convenient to write jV j as jV j = g!0v, where g is the magnitude of the off-diagonal component of
the permittivity tensor of the MO constitutive material of the cavity, and v, called reduced mode coupling
strength, depends solely on the geometry of the cavity.
Substituting eqs. (4.10), (4.11), (4.13), (4.14), (4.17), and (4.18) to the coupled-mode equations (4.8),
taking W to be the input waveguide by setting sE = .1; 0; 0/T1 in , and solving for sEout, we obtain
i  
p e i 4.3 cosC i sin/ Œ   i.!   ! /s1;out = C e
0
    C j j ; (4.19a)1 8 cos2 3 Œ i.! ! /2 V 20
p
i  C   j j     p 2 e 3 cos i sin Œ V 3 i.! !0/s2;out =
1C   cosC ; (4.19b)8 cos2 2 2 3 Œ   i.!   !0/ C jV jpi 
p 2 e   C 3 cosC i sin Œ C jV j 3   i.!   !0/s3;out = C cos     C j j : (4.19c)1 8 cos2 3 Œ i.! ! /2 V 20
This solution is valid provided that the matrix i. O˝  !IO/C O , where IO denotes the 22 identity matrix,
is invertible. This is the case if
! ¤ !0 ˙ jV j and  ¤ 0: (4.20)
It is easily seen than the reflectance R  js j2 and transmittances T  js j21;out i i;out (i = 2; 3) are
independent of  and  -periodic in . Moreover,
jsE .; !/j2 = jsE .   ; 2!   !/j2i;out i;out 0 for i = 1; 2; 3: (4.21)
Therefore it is sufficient to study the properties of R and T in the interval  2 Œ0;  i .2
We are primarily interested in the behaviour of the isolation factor of the circulator, defined as I 
T3=T2. Figure 4.3 shows the dependence of I on the frequency shift .!   !0/ and the waveguide-
cavity coupling parameter  for a few representative values of  and a fixed mode coupling strength
4.2. Extension of the coupled-wave model 75
log10I for D = 0 log10I for D = Π4
0.2 0.2
1
1
0.1 01 0.1 0
2 -1-
0.0 -34 0.0-
-2
-3-4
-0.1 -111 0 -0.1
0
-0.2 -0.2
0.00 0.05 0.10 0.15 0.20 0.00 0.05 0.10 0.15 0.20
Γ Γ
log10I for D = Π3 log10I for D = Π2
0.2 0.2
1
1
0.1 02 0.1
0.0 -1 0.0 4
3
2
-2
-0.1 -0.1
-0.2 0 -0.2
0.00 0.05 0.10 0.15 0.20 0.00 0.05 0.10 0.15 0.20
Γ Γ
Figure 4.3 Isolation I as a function of  and !   ! for  = 0,   ,  0 and   (logarithmic scale).4 3 2
jV j = 0:1. It can be conjectured that for any ¤   infinite isolation factor can be obtained for a specific
3
value of ! and  . However, in practice one is more concerned with the maximum bandwidth B.Imin/,
defined as the maximum range of frequencies for which the isolation factor or its inverse exceeds a
predetermined threshold Imin. Figure 4.3 shows that this bandwidth is particularly large for vanishing
( =   ) and maximum ( = 0) direct waveguide-to-waveguide coupling. In these cases,pthe isolation2
factor is anpeven function of .!   !0/, and infinite isolation occurs at ! = !0 and  = jV j 3 ( =   )2
or  = jV j= 3 ( = 0). It is also at these “optimum” values of  that maximum bandwidth is obtained.
Figure 4.4 illustrates the frequency dependence of the transmittances and the isolation factor for
 =   and 0, with  set to the respective “optimum” values cited above. In the first case, I > 1 every-
2
where: for the chosen SEMF polarisation, waveguide W3 receives more power than W2 at all operation
frequencies. In contrast, the device with  = 0 acts as a switch: transmission occurs preferentially to
Ω-Ω0 Ω-Ω0
Ω-Ω0 Ω-Ω0
76 Chapter 4. Magneto-optical circulators
1:00
(a) T2 ( D  =2)
0:75 T3 ( D  =2)
0:50
0:25
0:00
1:00
(b) T2 ( D 0)
0:75 T3 ( D 0)
0:50
0:25
0:00
104
3 (c) I ( D  =2)10
1=I ( D 0)
102
101
100
10 1
 0:50  0:25 0:00 0:25 0:50
!   !0
Figpure 4.4 (a) Frequency dependence of the transmittapnces T2 and T3 for a circulator with  =   and  =2jV j 3. (b) Same for a circulator with  = 0 and  = jV j= 3. (c) Frequency dependence of the isolation factor I
of the two circulators. In both cases jV j = 0:1.
waveguide W2 for j!   !0j < jV j and to W3 outside this frequency range. In consequence, the band-
width of the system with maximum coupling ( = 0) is inferior to that of the one with no direct coupling
( =   ) regardless of the chosen threshold Imin. However, fig. 4.4(c) shows that the difference in band-2
width becomes less and less pronounced as Imin grows: for very high isolation factors, the bandwidths
of both structures are virtually indistinguishable.
The conclusions from the previous two paragraphs, based in part on an analysis of plots made for
several specific cases, can also be reached in a rigorous manner. We shall first derive the values of
! and  at which the isolation factor or its inverse becomes infinite. By definition of I , this will be
the case provided that exactly one of s2;out and s3;out vanishes. Rewriting the condition s2;out = 0 as
(Re s2;out = 0 and Im s2;out = 0) and using assumption (4.20), we obtain
p
3ŒjV j2 C  jV j 3   .!   ! 20/  cos   .!  p!0/ sin = 0; (4.22a)
Œ3.!   !0/ cosC .   jV j 3/ sin = 0: (4.22b)
One solution of these equations, ! = !0 ˙ jV j and  = 0, is obviously incompatible with assumption
(4.20). The other can be obtained by solving eq. (4.22b) for ! and substituting the result into eq. (4.22a).
Isolation factor Transmittance Transmittance
4.2. Extension of the coupled-wave model 77
This yields
C 2 sin.2/
p
j j 1   4 cos
2 p
! = !0 C V 3 and  = C jV j 3: (4.23)1 8 cos2 1 8 cos2
Comparing the expressions (4.19b) and (4.19c) for s2;out and s3;out, one immediately sees that the con-
dition for s3;out = 0 is given by formula (4.23) with jV j replaced by  jV j. Noting further that, by
definition (4.14),  cannot be negative, we arrive at the following conclusion.
The isolation factor I of a lossless circulator is infinite if and only if
j j 1 C 2 sin.2/
p
j j 1   4 cos
2 p
cos < ; ! = !0 C V 3 and  = C jV j 3: (4.24a)2 1 8 cos2 1 8 cos2
The factor I is zero if and only if
j j 1   2 sin.2/
p
j j 4 cos
2   1 p
cos > ; ! = !0 C V 3 and  = C jV j 3: (4.24b)2 1 8 cos2 1 8 cos2
Restricting to the interval Œ0;   , we see that jcosj < 1> if and only if <>   . It should be noted that2 2 3
for  =   there exist no solutions of eq. (4.22) compatible with assumption (4.20).
3
It is convenient to introduce the reduced frequency
Q  !   !0 ˙ 2 sin.2/
p 1
! 3 for jcosj ><j j C : (4.25)V 1 8 cos2 2
It can be shown that the isolation I at the optimum level of coupling  quoted in conditions (4.24) can
be written solely as a function of and !Q . The plot of this function is shown in fig. 4.5(a). It can be seen
that for any Imin the bandwidth B.Imin/ depends strongly on the value of , and it is always the largest
for  =   . The behaviour of B.Imin/ in the interval  2 Œ0;    is quite interesting. For sufficiently low2 3
values of Imin, maximum bandwidth is obtained for some value of lying in the interior of this interval.
However, as soon as Imin exceeds 55, the optimum value of  in the interval in question becomes
equal to 0. As noted earlier, the difference in bandwidth at  = 0 and  =   diminishes as Imin grows.2
This effect is demonstrated in fig. 4.5(b), in which the ratio of B.I ; =  min / and B.Imin;  = 0/ is2
plotted as a function of Imin.
In summary, direct waveguide-to-waveguide coupling has a detrimental effect on a circulator’s oper-
ation bandwidth, and therefore should be minimised in a properly designed device. Nevertheless, a little
paradoxically, devices with maximum direct coupling also provide a comparatively large bandwidth,
exhibiting, in addition, an interesting switching effect.
4.2.2 Inclusion of radiation loss
Another effect that can play an important part in the operation of rib-waveguide-based circulators and
three-dimensional (3D) PC circulators alike is the loss of energy to the free space surrounding the device.
This loss can be fairly easily handled by the coupled-wave theory. We shall limit our discussion to the
case without direct coupling ( =   ), which in the previous subsection was found to yield maximum
2
bandwidth. We shall also assume the energy to be lost solely owing to radiation of the cavity mode into
free space, neglecting the energy radiated when the incident waveguide mode is reflected from the end
of the input waveguide.
Following ref. 156, pp. 208–212, we incorporate the
O O C O O   cavity radiation loss in the coupled-wave equa-tions (4.8) by replacing   by    l, where   1 0l l 0 1 and l is the decay constant related to radiation
78 Chapter 4. Magneto-optical circulators
5
(a) (b)
2 2
4
0 0 3
2
 2  2
1
0:0 0:2 0:4 1 10 100 1000
=  Imin
Figure 4.5 (a)Dependence of the isolation I on and !Q when the coupling level  is maintained at its optimum
value given by eqs. (4.24). The visible discontinuity of I at  =   is due to the fact that at this value of  we
3
switch from the conditions for zero isolation [eq. (4.24b)] to those for infinite isolation [eq. (4.24a)]. (b) Ratio
of the maximum bandwidths B.Imin/ of the two circulators with  =
  and  = 0 as a function of I
2 min
. The
coupling level  is still maintained at its optimum value.
loss. Proceeding analogously as before, we solve the coupled-wave equations for the amplitudes of the
outgoing modes in the three waveguides:
s1;out =  1C
4 Œ C l   i.!   !0/
C     C j j ; (4.26a)3 Œ l i.! !0/2 V 2
p
 2 Œ C l   jV j 3   i.!   != 0/s2;out ; (4.26b)
3 Œ   i.!   ! 2 20/ C jV j
p
 2 Œ C l C jV j 3   i.!   !0/s3;out =     C j j : (4.26c)3 Œ i.! ! /2 20 V
From eqs. (4.26b) and (4.26c) it can be immediately seen that despite the presence of loss, infinite
isolation I can still be obtained at frequency ! = !0 provided that the coupling coefficient  is taken as
p
 = jV j 3   l: (4.27)
Interestingly, when  is chosen in this way, the isolation I.!/ becomes independent from l:
C 12jV j
2
I.!/ = 1 : (4.28)
.!   ! /20
However, the power transmitted to the ‘hot’ waveguide, T3, obviously decreased when the loss coeffi-
cient l increases. With  given by eq. (4.27), the expression for the maximum value of T3 takes the
form p
. 3    =jV j/2
T3.! = !0/ =
l
: (4.29)
3
This formula is important because it allows to determine the minimum quality factorQl  !0=.2l/
of a cavity with a given SEMF-induced relative frequency splitting !=!0 that can be used to build a
circulator with a prescribed minimum level of transmitted power, T3;min. (Note thatQl describes solely
the decay caused by radiation to free space, rather than that due to interaction with waveguide modes.)
Indeed, expressing l in eq. (4.29) in terms ofQl and using therelation ! = 2jV j, we obtain that
  !
p p  1
T3.! = !0/ Tmin if and only if Ql .1   Tmin/ 3 : (4.30)
!0
!Q
B. D  2 /=B. D 0/
log10 I
4.3. Cavities with circular symmetry 79
Thus, a circulator built with a cavity having !=!0 = 0:001 (a typical value) can provide 50-percent
peak transmission if Ql  1970. A quality factor Ql  11;250 is needed for 90-percent efficiency, and
Ql  115;000 for 99-percent.
4.3 Cavities with circular symmetry
Wang and Fan [34] used the perturbation theory to derive a formula for the mode coupling strength V ,
introduced in the previous subsection, of a cavity containing a MO material polarised in the z direction.
From eq. (4.6) it follows that such a material is characterised by the permittivity tensor
2 3
 ig 0
O = 4 ig  05 ; (4.31)
0 0 
where g  KM . From now on we shall assume g to be real. The authors of ref. 34 obtained?z R
i
V =   qR! g.rE/ eE E

z  ŒEe .RrE/ EEo.rE/ drE ; (4.32)2
.rE/jEEo.rE/j2 drE .rE/jEEe.rE/j2 drE
where the integrals run over the whole cavity volume, EEe and EEo are the electric fields of the even
and odd modes of the cavity unperturbed by the SEMF, and ! is their frequency (denoted !0 in the
previous section). Thus, the magnitude of V is proportional to the cross product of the electric fields
EEe and EEo weighted by the off-diagonal component of the permittivity tensor, ig. To understand better
the behaviour of this cross product and to formulate a design principle for resonant cavities with large
frequency splitting in a uniform SEMF, we shall now study the restricted class of 2D cavities having
perfect rotational symmetry. In contrast to general PC cavities, circularly symmetric cavities can be
handled analytically, which makes it possible to get a better insight into their properties.
We consider, then, a system of concentric rings [see fig. 4.6(a)], described by a piecewise-constant
relative permittivity ./ independent from the azimuthal coordinate  and the vertical coordinate z. The
relative permeability  is taken to be 1 everywhere. In the p-polarisation case [waves propagating in the
.; / plane with the magnetic field parallel to the z axis] the Maxwell’s equations
1 @Hz =  i!0E; (4.33a)
 @
@Hz = i!0E ; (4.33b)
@
@E C 1   1 @EE = i!0Hz; (4.33c)
@   @
reduce to the Helmholtz equation for the z component of the magnetic field,H :
  z
@ 1 @Hz C 1 @H
2 2
z
 C 1 @ Hz C ! Hz = 0: (4.34)
@  @  @ 2 @2 c2
Hepre ! denotes the frequency, 0 and 0 the permittivity and permeability of free space, and c =
1= 00 the speed of light in vacuum. By the usual method of separation of variables one can show
? The difference in sign between eq. (6) from ref. 34 and eq. (4.32) is caused by the difference in the convention chosen for
harmonic time-dependence (e i!t here vs. ei!t in ref. 34).
80 Chapter 4. Magneto-optical circulators
that the eigenmodes of the system occur in degenerate pairs of “even” and “odd” modes with magnetic
field of the general form
Hze.; / = R./ cos.l/ and Hzo.; / = R./ sin.l/; (4.35)
respectively, where the azimuthal order l is an integer. (Of course, the exception is the modes with l = 0,
which are not degenerate.) Within an arbitrary ring, the radial dependence R./ of the magnetic field of
a mode with azimuthal order l can be expressed as a superposition of the Bessel functions of the first and
second kind:
R./ = amJl.nmk0/C bmYl.nmk0/; (4.36)
where m is the ring’s number, nm its refractive index, am and bm constant coefficients, and k0  !=c
the free-space wave number.
From eq. (4.35) and the Maxwell’s equations (4.33) we can derive the general expressions for the
cross product of the electric fields corresponding to a pair of degenerate modes with azimuthal order l ,
E  E  E lR./R
0./
ez .Ee Eo/ = ; (4.37)!2 ./2
and their norm,
Z Z Z
E E 1 l2ŒR./2 C 2ŒR0./2.rE/jEe.rE/j2 drE = .rE/jEo.rE/j2 drE = d; (4.38)
0  ./
with R0./ denoting the derivative of R./. Substituting eqs. (4.37) and (4.38) to the general formula for
the coupling strength (4.39), we obtain
Z 1 g./R./R0./
V =  Z i!l d20 ./1 C 0 : (4.39)l2ŒR./2 2ŒR ./2
d
0  ./
Clearly, the sign of the integrand in the numerator of the above expression depends on the sign of the
product g./R./R0./. In general, this sign will oscillate due to the oscillatory behaviour of the func-
tion R./ itself. Therefore, to avoid unnecessary cancellations in the integral in question, the ring
boundaries need to be placed so that the product g./R./R0./ be always nonnegative (or nonposi-
tive). Excluding the possibility of introducing inversely-magnetised domains, this can only be achieved
by ensuring that the boundaries between the MO and non-MO material coincide with the zeros of the
product R./R0./, i.e., the zeros and extrema of R./. With this design principle in mind, we offer
the following method for the determination of the radii of the alternating MO and non-MO rings making
up a cavity supporting a pair of degenerate modes with azimuthal order l  1 at a particular frequency
! = k0c.
As a first step, we determine the radius 0 of the central rod (“zeroth ring”), assumed to have refrac-
tive index n0. In this rod, the radial field dependence is expressed solely by means of the Bessel function
of the first kind Jl.n0k0/, since the Yl.n0k0/ function has a singularity at the origin. Hence, b0 = 0
and, since the global mode amplitude is arbitrary, a0 can be set to 1. It is then evident that the product
R./R0./ in the central rod will not change sign until the first extremum of the Jl.n0k0/ function.
Therefore, we set the rod’s radius, 0, to the value of  corresponding to the location of this extremum.
The amplitudes a1 and b1 of the Bessel functions in the first ring, having refractive index n1, can
now be determined from the condition of continuity ofHz and E . The outer radius of the first ring, 1,
4.3. Cavities with circular symmetry 81
(a) y
magneto-optical
air
x
1:0
R.r/
rzO E0:5 e Eo
0:0
(c)
 0:5
0:0 0:5 1:0 1:5
r=
Figure 4.6 (a) The geometry of a cavity composed of a sequence of rings made of air and a MO material with
refractive index 2.25. (b) The magnetic fieldHz of the even eigenmode of azimuthal order l = 1 supported by the
cavity at frequency ! = 2 c=. (c) Radial dependence of the magnetic field Hz of the cavity eigenmodes and of
the cross product of their electric fields. Both functions are normalised to their maximum values. The areas filled
with the MO material are shaded.
should then be chosen so as to coincide with the first zero of the function a1Jl.n1k0/C b1Yl.n1k0/
located in that ring, as which point the product R./R0./ will again change sign. By repeating this
process, we obtain the radii of the subsequent rings. The outer radii of the even rings (with refractive
index n0) coincide with the extrema of the function R./, and those of the odd rings (with refractive
index n1), with its zeros. Thus, the cavity designed in this way resembles an annular Bragg grating
[157], with each layer a quarter-wavelength thick (in the sense of the Bessel-function quasi-periodicity).
We need now to make sure that the field of the mode constructed in this way is localised, i.e., that
R./ decays as  tends to infinity. Let us estimate the ratio ofR./ at its two successive extrema, located
at 2n and 2nC2, where n 1. The Bessel functions of large arguments can be approximated by [158,
82 Chapter 4. Magneto-optical circulators
eqs. (9.2.1) and (9.2.2)]
r  
 2    Jl.x/ cos x l  
 
; (4.40a)
r x  2 4
 2        Yl.x/ sin x l : (4.40b)
 x 2 4
By construction, the field in the .2nC1/th ring, located between 2n and 2nC1, behaves approximately
as
R./  c C  1=22n 1 cosŒn1k0.   2n/; (4.41)
and in the .2nC 2/th ring as
R./  c C  1=22n 2 sinŒn0k0.   2nC1/; (4.42)
where c2nC1 and c2nC2 are constant coefficients. Since the rings are supposed to be a quarter-wavelength
thick, the expressions n k . C    / and n k . C    C / are approximately equal to  1 0 2n 1 2n 0 0 2n 2 2n 1 and2
the successive extremal values of R./ are
 C  1=2R.2n/ c2n 1 2n (4.43a)
and   
    1 1  1=2
R.2nC 1=22/  c2nC2 2nC2  c2nC2 2n C C : (4.43b)2k0 n0 n1
From the requirement of continuity of E / R0 ./=./ at  = 2nC1 it follows that c2nC2=c2nC1 =
 n0=n1. Hence,
ˇˇˇ ˇˇˇ   
R. C / n   1 1  1=2ˇ 2n 2 ˇ  0 C C  n !  1! n01 : (4.44)R.2n/ n1 2k02n n0 n1 n1
Thus, a localised mode is obtained only if the refractive index of the central rod, n0, is chosen smaller
than that of the first ring, n1.
Figure 4.6(a) shows the geometry of an example cavity constructed with the above algorithm. The
system consists of an alternating sequence of rings made of air (refractive index n0 = 1) and a MO
material with refractive index n1 = 2:25. It supports a pair of degenerate localised eigenmodes of
azimuthal order l = 1. The magnetic field of the even mode is plotted in fig. 4.6(b); the field of the odd
mode can be obtained by rotating the map from fig. 4.6(b) by 90ı in the counter-clockwise direction. In
fig. 4.6(c), the radial dependence of these magnetic fields,R./, is juxtaposed with the radial dependence
of eE EE EE calculated from eq. (4.37). Clearly, R./R0z e o ./ is negative throughout the MO rings and
positive elsewhere; as a result, no cancellations in the upper integral in eq. (4.39) occur. The reduced
coupling strength of this pair of modes is v = 0:00874.
4.4 Photonic-crystal-based circulators
The insight gained in the previous section is valuable not only in the design of axisymmetric cavities
with maximum frequency splitting induced by a uniform SEMF, but also of PC-based ones. Figure
4.6(c) shows that the cross product EEe  EEo in a well-designed axisymmetric cavity has a significant
amplitude only within the rings closest to the cavity centre. Thus, one can conclude that the frequency
4.4. Photonic-crystal-based circulators 83
(a) (b)
(c) (d)
0
r
in
Figure 4.7 Adjustment of an axisymmetric cavity for integration into a PC lattice. (a) Superposition of the
cavity and a hexagonal block of the PC. (b) Structure obtained by combining the central air hole and the innermost
air ring of the cavity with the external region of the PC block. (c) The result of shifting the circular air holes of
the cavity from part (b) in the radial direction, according to the mapping described in the text. (d) The cavity from
part (c) with its air ring approximated by a string of circular air holes.
splitting of the cavity modes depends mostly on the geometry of the innermost region, whereas the
primary function of the external rings is to provide a sufficient isolation from the surrounding free space.
TheMO properties of the cavity should not suffer, therefore, if the inner air rings were preserved, whereas
the outer ones were replaced by a regular photonic lattice.
In practice, some difficulties related to geometric constraints can arise. Consider, for instance, a
2D PC made up of a hexagonal lattice of circular air holes with radius 0:30a, where a is the lattice
constant, etched in a matrix of a MO material with refractive index n = 2:5 (close to that of BIG
at infrared frequencies). This crystal has a band gap for p-polarised waves with frequencies between
! = 0:285 and 0:350  2 c=a. In fig. 4.7(a) its geometry is juxtaposed with the contours of the BIG
rings of the axisymmetric cavity composed of BIG and air and supporting a pair of eigenmodes with
azimuthal order l = 1, frequency ! = 0:320  2 c=a and reduced coupling strength v = 0:0062. The
dimensions of the rings are listed in table 4.1. It can be seen that no matter how many inner rings are
preserved, a wide gap will appear between them and the surrounding PC. Its presence will certainly shift
the eigenfrequencies of the cavity modes and diminish the frequency splitting between them: the modes
will be more weakly localised, and hence the denominator of expression (4.32) for V will increase,
while the numerator will stay roughly the same. In order to overcome this difficulty, we propose to
adjust the positions of the PC holes using an appropriate coordinate transform. While its optimum
form remains an open problem, we obtained satisfactory results with a simple mapping whose principle
is illustrated in figs. 4.7(b) and (c). The mapping has the form .; / 7! .a./ C b./; /, where
the coefficients a./ and b./ are chosen so that the centres of the holes hatched horizontally in fig.
4.7(b) move onto a circle of radius 0 , as shown in fig. 4.7(c), while the position of the ones hatched
in
vertically does not change. We have found the value of 0 = 2:60a to be approximately optimal for the
in
considered system.
84 Chapter 4. Magneto-optical circulators
Ring number Inner radius Outer radius
1 0:916a 1:255a
2 1:995a 2:319a
3 3:068a 3:387a
4 4:143a 4:461a
5 5:221a 5:538a
Table 4.1 Radii of the high-index rings of the cavity with  = .2:5/2h = 6:25 and l = 1 supporting a resonant
mode with azimuthal order l = 1 at frequency ! = 0:32  2 c=a.
# x=a y=a r=a # x=a y=a r=a # x=a y=a r=a
1 0.000 0.000 0.92 8 2.967 3.426 0.30 15 4.000 3.464 0.30
2 1.403 0.810 0.40 9 3.001 1.733 0.30 16 4.451 0.857 0.30
3 1.620 0.000 0.40 10 3.433 0.849 0.30 17 4.500 2.598 0.30
4 1.965 1.702 0.30 11 3.496 2.595 0.30 18 4.867 0.000 0.30
5 2.452 2.548 0.30 12 3.500 4.330 0.30 19 5.000 1.732 0.30
6 2.457 0.851 0.30 13 3.733 0.000 0.30 20 5.500 0.866 0.30
7 2.600 0.000 0.30 14 3.995 1.730 0.30 21 6.000 0.000 0.30
Table 4.2 Cartesian coordinates .x; y/ and radii r of the circular air holes making up the cavity shown in fig.
4.7(d). For brevity, only the holes lying in the sector 0   < 60ı are included.
To simulate PC-based cavities and circulators, we have been using the multiple-scattering method
extended to systems containing MO materials (see section 5.1). At present, our code cannot handle
scatterers composed of several concentric layers. Therefore we have approximated the preserved air ring
with a string of air holes with radius 0:4a arranged on a circle of radius 1:62a, in the hope that this will
not seriously deteriorate the MO properties of the cavity. In this way we arrived at the final geometry
of the proposed PC-based cavity, shown in fig. 4.7(d). For completeness, the positions and radii of its
constituent air holes are listed in table 4.2.
By means of the multiple-scattering method we have found that in the absence of SEMF the cavity
in question supports a pair of degenerate dipolar modes at the complex frequency ! = .0:31241  
0:00037i/  2 c=a [148]. Figures 4.8(a) and (b) show the magnetic field Hz corresponding to these
modes, and fig. 4.8(c), the cross product of their electric fields weighted with g.rE/ taken to be 1 in the
MO material and 0 in air. It can be seen that the cross product remains positive practically everywhere
in the MO material. The reduced mode coupling strength is v = 0:0048, which is slightly less than
the value obtained for the initial axisymmetric cavity. This deterioration could probably be reduced
by a more careful optimisation of the transition between the inner region, approximately axisymmetric,
and the surrounding PC lattice. However, the obtained value of v is still eight times larger than that
of the cavity from ref. 34, figs. 2 and 3(a)–(b), placed in a uniform SEMF, i.e., without introduction of
oppositely-magnetised domains. For the sake of comparison, the map of geE  .EEz e  EEo/ of that cavity
is shown in fig. 4.8(d). It can be seen that the cross product changes sign inside the defect, so that the
contributions of the areas with positive and negative eE  .EEz e Eo/ almost cancel out.
The next step in the design of a PC circulator is the determination of the geometry of waveguides.
The simplest would be to make them by removing a single row of holes from the chosen hexagonal-lattice
PC. Yet, as can be seen on the dispersion diagram in fig. 4.9(a), such waveguides, while being technically
single-mode at the resonant frequency of the cavity, !0 = 0:312412 c=a, support another mode, whose
cut-off frequency, 0:314 2 c=a, is barely higher than !0. Its decay constant can therefore be expected
to be small. As a result, even relatively long waveguides of this type might still exhibit multi-mode be-
4.4. Photonic-crystal-based circulators 85
1:0
5:0 (a) 5:0 (b)
0:5
2:5 2:5
0:0 0:0 0:0
 2:5  2:5  0:5
 5:0  5:0
 1:0
 5 0 5  5 0 5
x=a x=a
1:0
5:0 (c) 2 (d)
0:5
2:5 1
0:0 0 0:0
 2:5  1  0:5
 5:0  2
 1:0
 5 0 5  2 0 2
x=a x=a
Figure 4.8 (a)–(b) Magnetic field Hz of the degenerate eigenmodes of the cavity from fig. 4.7(d). (c) Distri-
bution of geE  .EE  EE / of the same cavity. (d) Distribution of geE  .EE  EEz e o z e o/ of the cavity from ref. 34, figs.
2 and 3(a)–(b). All plots show the real parts of the respective quantities normalised to the interval Œ 1; 1; with the
chosen global phase of eigenmode fields, the imaginary parts are negligible.
haviour. This problem can be eliminated by bringing the holes nearest to the waveguide axis even closer
to it, which causes a blueshift of the dispersion curves of both the modes. The dispersion curve of the
lower-frequency mode must not be allowed to move up too much, though, since this would lead to a sub-
stantial decrease of its group velocity at frequency !0. Such a decrease would be accompanied by an in-
crease of absorption [123] and scattering losses [159] in the presence of structural defects, unavoidable in
an experimentally manufactured device. The waveguide obtained by shifting its innermost holes by dw =
0:09a towards its axis seems a reasonable compromise; its dispersion diagram is shown in fig. 4.9(b).
We can now proceed to simulations of a complete circulator. The device to be considered, shown
schematically in fig. 4.10, is composed of the cavity from fig. 4.7(d) and three waveguides designed
as described in the previous paragraph. The holes marked by hatching, located near the ends of the
waveguides, will be modified for reasons explained in what follows. The wapveguides comprise N = 12
unmodified unit cells and the total thickness of their cladding is dclad = 5 3a. The whole system is
embedded in the MO material, assumed to have g = 0:1. The system is excited by a point source placed
close to the inlet of waveguide W1. As in the case of the isolated cavity, the simulations are done with
the multiple-scattering method.
We have tested two ways of measuring the power transmitted through thpe circulator. The first consists
in integrating the Poynting flux over the “ports” Pj (j = 2; 3) of length 4 3a, shown in fig. 4.10. The
results obtained in this way would be severely perturbed by reflections occurring at the outlets of the
waveguides W2 and W3. To eliminate them, we have modified the radius rh of the holes lying closest
to waveguide ends, hatched horizontally in fig. 4.10. Using the method described in ref. 160, we have
y=a y=a
y=a
y=a
jHz j geE  .EEz EEe o/
86 Chapter 4. Magneto-optical circulators
0:4
0:3
0:2
0:1
(a) (b)
0:0
0:0 0:1 0:2 0:3 0:4 0:5 0:0 0:1 0:2 0:3 0:4 0:5
ka=2  ka=2 
Figure 4.9 Dispersion relation of p-polarised modes of (a) a waveguide created by removing a row of air holes
from the PC studied in section 4.4, (b) the waveguide from part (a) after shifting the holes nearest to the waveguide
axis by 0:09a towards it. The regions of the .k; !/-space in which bulk PC modes exist have been shaded. Dashed
horizontal lines mark the resonant frequency of the cavity from fig. 4.7(d), ! = 0:31241 2 c=a. All calculations
have been done with the method described in section 5.2.
verified that if rh is reduced from to 0:17a, the modal reflectance of the waveguide outlet at frequency !0
decreases to barely 0.04%.
The second technique for obtaining the scattering matrix of the system consists in fitting the field
in the waveguides with a linear combination of their forward- and backward-propagating guided modes.
Since there are practically no reflections at the waveguide outlets, we can approximate the magnetic field
at pointsQj;n marked in fig. 4.10 by
H .Q / = H ˚n C rH ˚2N nz 1;n inc inc ; (4.45a)
Hz.Q
NCn
2;n/ = t2Hinc˚ ; (4.45b)
Hz.Q3;n/ = t3Hinc˚
NCn; (4.45c)
where˚  eika, k denotes the wave number of the waveguide eigenmode,Hinc stands for the excitation
amplitude, r is the reflection coefficient of the circulator, and t2 and t3, the transmission coefficients into
waveguides W2 and W3. Since the wave number k is known from the dispersion diagram shown in fig.
4.9(b), we can find the coefficients r , t2 and t3 simply from a linear least-squares fit of formulas (4.45)
to the data obtained in simulations. To avoid perturbations induced by the presence of evanescent modes
near the waveguide ends, in the fitting procedure we have disregarded the pointsQj;n with indices n < 3
and n > N   3. The spirit of this approach is similar to that advocated in ref. 160. In contrast to the
method based on Poynting flux integration, it allows to calculate not only the transmittances T 2j  jtj j
(j = 2; 3), but also the reflectance R  jr j2 and the amount of power lost to non-guided modes,
1   .RC T2 C T3/.
Figure 4.11 shows a juxtaposition of the values of the isolation coefficient I  T2=T3 obtained with
the two above methods for the circulator from fig. 4.10. Clearly, there is an excellent match between the
two sets of data. Therefore in the following we shall limit our discussion to the results obtained with the
second, more powerful approach.
Figure 4.12(a) presents the frequency dependence of the transmittances T2 and T3 of the same cir-
culator, along with the total power passed to guided modes, P  R C T2 C T3. It can be seen that in
the neighbourhood of !0 the amount of power not accounted for by the guided modes increases to about
10%. We believe this power deficit to be primarily a consequence of radiation occurring from the cavity,
and possibly also from the waveguides, into free space. These losses might conceivably be reduced if the
thickness of the cladding were increased.
!a=2 c
4.4. Photonic-crystal-based circulators 87
dclad
P3
2r
Waveguide W h3
: : Q
3
: N
: :
: : : :
: : :: : :
a .N   1/a
Q3
2
Q3
: : : 1
: : :
: : :
: : :
: : :
Q1 Q1 Q1  
1 2 : : : N
: : :
: : :
: : :
: : :
Q2
1
Q2Waveguide W1 2
: : :: : :
: : : :
Point source : :
: : :
Q2
N
Waveguide W2 P2
 p 
3
  dw a2
Figure 4.10 Schematic of the PC circulator described in the text.
: : :
: : :
: : :
: : :


: : : 
: : :
: : :
: : :
: : :
: : :



88 Chapter 4. Magneto-optical circulators
100
Method 1
Method 2
10
1
0:3110 0:3115 0:3120 0:3125 0:3130
!a=2 c
Figure 4.11 Comparison of the isolation I of the circulator from fig. 4.10 calculated by integrating the Poynt-
ing fluxes through ports P2 and P3 (“method 1”, crosses) and by fitting the data obtained in multiple-scattering
simulations with formulas (4.45) (“method 2”, circles).
1:00 100
(a)
0:75
T2
T3
0:50 10
P
I
0:25
0:00 1
0:3110 0:3115 0:3120 0:3125 0:3130
!a=2 c
1:00 10000
(b)
0:75 1000
T2
T3
0:50 100
P
I
0:25 10
0:00 1
0:3115 0:3120 0:3125 0:3130 0:3135
!a=2 c
Figure 4.12 Frequency dependence of the transmittances T2 and T3, isolation I , and the sum P  RCT2CT3
of the circulator shown in fig. 4.10 with the vertically hatched holes shifted by (a) dh = 0 and (b) dh =  0:038a
in the radial direction with respect to their original position. All the quantities were calculated by fitting the data
obtained in multiple-scattering simulations with formulas (4.45).
T2, T3, P T2, T3, P
Isolation I
I
I
4.4. Photonic-crystal-based circulators 89
# x=a y=a r=a # x=a y=a r=a # x=a y=a r=a
1 0.000 0.000 0.92 32 5.922 8.705 0.30 63 8.422 13.035 0.30
2 0.810 1.403 0.40 33 6.000 0.000 0.30 64 8.500 6.062 0.30
3 1.403 0.810 0.40 34 6.000 1.732 0.30 65 8.500 7.794 0.30
4 1.620 0.000 0.40 35 6.000 3.464 0.30 66 8.500 9.526 0.30
5 1.965 1.702 0.30 36 6.000 5.196 0.30 67 8.500 11.258 0.30
6 2.452 2.548 0.30 37 6.000 6.928 0.30 68 8.922 13.901 0.30
7 2.457 0.851 0.30 38 6.422 9.571 0.30 69 9.000 6.928 0.30
8 2.600 0.000 0.30 39 6.500 0.866 0.30 70 9.000 8.660 0.30
9 2.967 3.426 0.30 40 6.500 2.598 0.30 71 9.000 10.392 0.30
10 3.001 1.733 0.30 41 6.500 4.330 0.30 72 9.000 12.124 0.30
11 3.422 4.375 0.30 42 6.500 6.062 0.30 73 9.500 7.794 0.30
12 3.433 0.849 0.30 43 6.500 7.794 0.30 74 9.500 9.526 0.30
13 3.496 2.595 0.30 44 6.922 10.437 0.30 75 9.500 11.258 0.30
14 3.733 0.000 0.30 45 7.000 0.000 0.30 76 9.500 12.990 0.30
15 3.922 5.241 0.30 46 7.000 1.732 0.30 77 10.000 8.660 0.30
16 3.995 1.730 0.30 47 7.000 3.464 0.30 78 10.000 10.392 0.30
17 4.000 3.464 0.30 48 7.000 5.196 0.30 79 10.000 12.124 0.30
18 4.422 6.107 0.30 49 7.000 6.928 0.30 80 10.000 13.856 0.30
19 4.451 0.857 0.30 50 7.000 8.660 0.30 81 10.500 9.526 0.30
20 4.500 2.598 0.30 51 7.422 11.303 0.30 82 10.500 11.258 0.30
21 4.500 4.330 0.30 52 7.500 0.866 0.30 83 10.500 12.990 0.30
22 4.867 0.000 0.30 53 7.500 2.598 0.30 84 10.500 14.722 0.30
23 4.922 6.973 0.30 54 7.500 4.330 0.30 85 11.000 10.392 0.30
24 5.000 1.732 0.30 55 7.500 6.062 0.30 86 11.000 12.124 0.30
25 5.000 3.464 0.30 56 7.500 7.794 0.30 87 11.000 13.856 0.30
26 5.000 5.196 0.30 57 7.500 9.526 0.30 88 11.500 11.258 0.30
27 5.422 7.839 0.30 58 7.922 12.169 0.30 89 11.500 12.990 0.30
28 5.500 0.866 0.30 59 8.000 5.196 0.30 90 12.000 12.124 0.30
29 5.500 2.598 0.30 60 8.000 6.928 0.30 91 12.000 13.856 0.30
30 5.500 4.330 0.30 61 8.000 8.660 0.30 92 12.500 12.990 0.30
31 5.500 6.062 0.30 62 8.000 10.392 0.30 93 9.422 14.767 0.17
Table 4.3 Cartesian coordinates .x; y/ and radii r of the circular air holes making up the optimised circulator
shown in fig. 4.13. For brevity, only the holes lying in the sector 0    60ı are included.
The maximum isolation obtained with the circulator from fig. 4.10, I  50, is somewhat unsatis-
factory. According to the coupled-wave model from section 4.2, low maximum I may be caused by
a suboptimal coupling level between the cavity and the waveguides. This level can be controlled by
fine-tuning the positions of the holes in the neighbourhood of the cavity. We have found that by shifting
the holes hatched vertically in fig. 4.10 by dh =  0:038a in the radial direction, the maximum isolation
can be boosted to about 2600, as shown in fig. 4.12(b). The isolation I stays above 100 in a frequency
band of width B.100/ = 0:00011  2 c=a, which corresponds to 81GHz for the operation wavelength
 = 1300 nm. The level of power losses to radiative modes, 1   P , does not change appreciably with
respect to the case from fig. 4.12(a). Figure 4.13 shows the map of the magnetic field excited by a point
source placed close to the entrance of waveguideW1 of the “optimised” circulator with dh =  0:038a at
frequency ! = 0:3124  2 c=a, where maximum isolation is obtained. The standing-wave ratio in the
input waveguide is very small, which reflects the good quality of the match between the waveguides and
the cavity. Table 4.3 lists the positions and radii of the air holes making up the optimised circulator.
90 Chapter 4. Magneto-optical circulators
1:0
20
0:8
10
0:6
0
0:4
 10
0:2
 20
0:0
 20  10 0 10
x=a
Figure 4.13 Magnitude of the magnetic fieldHz in the circulator with dh =  0:038a, excited by a point source
of frequency ! = 0:3124  2 c=a.
4.5 Rib-waveguide-based circulators
4.5.1 Introduction
In section 4.4 we have shown how an axisymmetric cavity designed along the rules derived in section 4.3
can be adapted for embedding in a PC lattice and coupling with PC waveguides. One could well ask,
however, whether the introduction of a periodic lattice is strictly necessary. At first sight, the answer is
no. Having the form of a circular Bragg grating, the cavity is by itself well isolated from the surrounding
medium (at least in-plane), so there is little to be gained by embedding it additionally in a PC exhibiting
a band gap. The PC waveguides can also be straightforwardly replaced by rib waveguides with constant
cross-section, whose operation is based on the index-guiding mechanism. To obtain a working circulator,
however, one needs also to ensure the appropriate level of coupling between the localised cavity and
waveguide modes and to minimise the power lost to free space during the energy transfer between these
two families of modes. The latter objective is much easier to fulfil in a PC-based circulator, which
operates in the band gap of the periodic lattice surrounding all the functional elements. Nevertheless, in
this section we shall study a class of non-PC-based systems that allow to achieve the two goals mentioned
above, at least to a certain degree.
The general geometry of the structured to be considered is shown in fig. 4.14. The depicted circulator
consists of a resonant cavity, composed of nf full and ns split rings with inner and outer radii determined
by the procedure described in section 4.3, and three identical waveguides of width dwg. The distance
from the centre of the cavity to the ends of the waveguides is wg, while the widths of the slits in the split
rings are denoted by dn with n = nfC 1, nfC 2, : : : , nfC ns. The rings and waveguides are made of a
y=a
jHz j
4.5. Rib-waveguide-based circulators 91
dwg
d6 d5 d4 d3
rwg
Figure 4.14 Geometry of an example rib-waveguide-based circulator with nf = 2 full and ns = 4 split rings.
MO material with permittivity 2 3
h ig 0
O = 4 5h  ig h 0 (4.46)
0 0 h
and are embedded in an isotropic medium with permittivity l.
The level of coupling between the cavity and waveguide modes, and hence the circulator’s perfor-
mance, will of course depend on the values of all the geometrical parameters, which should therefore
be optimised. The space spanned by them is rather large, and it is not possible to scan it exhaustively.
Therefore our optimisation of the presented structure has been somewhat heuristic. We have chosen the
material parameters as  = .2:25/2h = 5:0625, l = 1 and g = 0:1; the quoted value of h corresponds
approximately to the effective index of the fundamental s-polarised guided mode of a planar waveguide
composed of a BIG layer of thickness 340 nm sandwiched between GGG and air. The waveguide width
dwg was fixed to 250 nm. The radii of the rings, listed in table 4.4, were determined with the procedure
described in section 4.3 to ensure the existence of a pair of cavity modes with the azimuthal order l = 1
at the wavelength  = 1300 nm.
92 Chapter 4. Magneto-optical circulators
Ring number Inner radius (nm) Outer radius (nm)
1 381 539
2 847 998
3 1309 1457
4 1772 1919
5 2236 2382
6 2700 2846
7 3165 3310
Table 4.4 Radii of the high-index rings of the cavity with  = .2:25/2h = 5:0625 and l = 1 supporting a
resonant mode with azimuthal order l = 1 at wavelength  = 1300 nm.
With the chosen value of g, the relative frequency splitting of the cavity is!=!0 = 2gv = 0:00175.
From eq. (4.27), in the absence of losses the optimum value of =!0 is 0.00151, i.e., the quality factor
Q  !0=.2/ describing the cavity-waveguide coupling should be Q = 330. The quality factors of
the chosen cavity with 3 and 4 rings are 163 and 829, respectively. Therefore one can expect that the
waveguides of an optimally designed circulator should end somewhere close to the third innermost ring—
or possibly even inside it, since the coupling to waveguides is doubtlessly less efficient that to the whole
surrounding free space.
The total number of rings necessary for ensuring a prescribed level of peak transmission Tmin could
in principle be estimated from eq. (4.30): for instance, for Tmin = 0:9 the quality factor Ql describing
radiation loss should be greater than 6430. This is already ensured by a cavity composed of 6 rings,
whose quality factor reaches 21,140. However, the quality factors of cavities with split outer rings will
necessarily be smaller than of those with full rings; therefore, a larger number of rings might be necessary
to ensure a 90-percent efficiency. In our calculations, we restricted our attention to systems with at most
7 rings.
The results of the optimisation process will be reported on in subsection 4.5.3. In the meantime,
we shall describe the numerical method used to analyse these systems and evaluate the accuracy of
calculations.
4.5.2 Numerical calculations
The calculations of the transmission through the circulators studied in this section, and shown schemati-
cally in fig. 4.14, have been performed with the finite-element method (FEM) using the RF module of the
COMSOL program. In contrast to the multiple-scattering method used to analyse PC-based circulators in
ref. 148, FEM can easily handle structures composed of scatterers with complex (especially elongated)
shapes. On the other hand, unlike that method, it requires a finite computational domain. Since the
system shown in fig. 4.14 is, in principle, infinite, it must be truncated for the sake of FEM calculations.
Problems involving light scattering by finite objects are routinely handled with FEM by letting the
computational domain consist of a finite region enclosing the objects in question and surrounded by
a perfectly matched layer (PML) of finite thickness, which ideally behaves as a perfect non-reflecting
absorber [53]. In our case, the situation is complicated by the presence of infinite waveguides; the
scatterer to be modelled obviously cannot fit within any finite contour. To circumvent this problem, we
construct the computational domain in the way shown in fig. 4.15. The region surrounded by the dashed
line is a fragment of the physical system shown in fig. 4.14. The parts of its boundary lying “far” from
the waveguide ends are covered with PMLs of thickness dPML. We have used standard PMLs adapted
4.5. Rib-waveguide-based circulators 93
Circulator n n  (nm) d (nm)  (ıf s wg  cone )
C1 3 3 1250 1570 —
C2 3 4 1240 1770 —
C3 3 4 1210 — 35.1
Table 4.5 Geometrical parameters of the circulators analysed in the text. The ring radii are listed in the first
.nf C ns/ rows of table 4.4.
for cylindrical coordinates, implemented in COMSOL by means of the coordinate transform?
!7    in sPML.1   i/; (4.47)
dPML
where  is the radial coordinate measured form the centre of the cavity, in denotes the radius of the
inner PML boundary, and sPML, called the PML strength, influences the field decay rate inside the PML
[161, p. 44]. On the other hand, the electromagnetic fields on the segments Pn (n = 1; 2; 3) perpendicu-
lar to the waveguides are constrained to be a superposition of the incoming and outgoing guided modes
of the corresponding waveguides, which are assumed to be single-mode. The profile of these modes is
calculated analytically and normalised to unitary power, and the amplitude of the incoming mode is set
to unity on P1 and to zero on P2 and P3. Physically, these constraints correspond to the assumption
that all the radiative waveguide modes excited by the cavity decay before reaching the ports Pn. Math-
ematically, they reduce to Robin’s boundary conditions and are implemented as COMSOL’s matched
boundary conditions. On the remaining part of the computational domain’s boundary (solid line in fig.
4.15) perfect-electric-conductor boundary conditions are imposed. The domain is divided into triangular
Lagrangian elements of order p. The mesh density is controlled by fixing the mpaximum allowed size
of individual elements in each subdomain with constant permittivity  to hmax= , where hmax is a
constant. The mesh in areas with higher permittivity is made finer, since the fields is these regions are
expected to vary faster.
In our calculations we are primarily interested in the isolation factor I = T2=T3, where T2 and T3
are the powers transmitted through ports P2 and P3. We can see that the numerically calculated value
of I of a given circulator at a fixed free-space wavelength  depends on the following six parameters:
 maximum element size in air, hmax,
 element order, p,
 PML thickness, dPML,
 PML strength, sPML,
 length of the part of the waveguides extending past the outermost ring, dsep,
 port height, dport.
To determine the values of these parameters sufficient for obtaining satisfactory accuracy, we have stud-
ied the influence of their variation on the isolation I of a particular circulator, denoted henceforth as C1,
whose parameters are listed in the first row of table 4.5.
We tested first the dependence of I on hmax and p for fixed values of the remaining parameters.
Figure 4.16(a) shows the values of I obtained for p = 2 and five different values of hmax, whereas
fig. 4.16(b) presents the dependence of I on the element order p with hmax fixed to 500 nm. We see
that the convergence with increasing p is much faster than with decreasing hmax. Therefore in future
calculations we have taken hmax = 500 nm and p = 5.
? In COMSOL simulations the ei!t convention for time-harmonic dependence is used, opposite to that employed here.
94 Chapter 4. Magneto-optical circulators
PML
P3
PML
dsep dPML
dport P1
P2
PML
Figure 4.15 Geometry of the domain used in FEM calculations.
400
(a) (b)
300
200
100
0
500 250 125 62:5 2 3 4 5
hmax (nm) p
Figure 4.16 Influence of the finite-element expansion parameters, hmax and p, on the calculated value of the
isolation I of circulator C1. The parameters related to the truncation of the computational domain are fixed to
dsep = 5000 nm, dPML = 600 nm, sPML =  and dport = 2250 nm. The wavelength  = 1299:5 nm was chosen to
lie in the proximity of the maximum of I./, but not exactly at it. (a) Convergence of I with decreasing maximum
element size in air, hmax, at fixed element order p = 2. (b) Convergence of I with increasing element order p at
fixed hmax = 500 nm.
I
4.5. Rib-waveguide-based circulators 95
86
84
82
sPML D 
sPML D 2
80
0 250 500 750 1000
dPML (nm)
Figure 4.17 Convergence of the isolation I of circulator C1 with increasing PML thickness dPML. Two PML
strengths, sPML =  and 2, are considered; the wavelength  = 1299:5 nm. The other parameters are fixed as
hmax = 500 nm, p = 5, dsep = 5000 nm and dport = 2250 nm.
(a) (b)
Figure 4.18 Change of the mesh structure in the PML with dPML increasing from (a) 400 nm to (b) 500 nm.
Note that in the former case the mesh of the PML consists of two interleaving rows of triangles, whereas in the
latter case the number of rows increases to four.
We proceeded to the study of the influence of the PML parameters, dPML and sPML. Figure 4.17
shows the dependence of I on the PML thickness for two different PML strengths, sPML =  and 2.
It can be seen that the values obtained with sPML =  (which is COMSOL’s default) are very stable
with respect to dPML: the difference between the maximum and minimum value of I does not exceed
0.15%. On the other hand, the I.dPML/ curve corresponding to sPML = 2 has a noticeable jump
between dPML = 400 and 500 nm. This jump is due to a change in the mesh structure: as illustrated in
fig. 4.18, for dPML = 400 nm the mesh in the PML region consists of two rows of triangles, while for
dPML = 500 nm two more rows appear. For dPML  600 nm the isolation factor obtained with both
PML strengths are very similar; moreover, the subsequent appearance of another pair of rows, occurring
between dPML = 800 and 900 nm, does not have any discernible effect on the I.dPML/ curves. All
in all, the detailed choice of the PML parameters does not seem very important for the accuracy of the
calculations. Therefore, we continue to take dPML = 600 nm and sPML = .
We studied next the sensitivity of I to dsep. The I.dsep/ curves shown in fig. 4.19, corresponding
to two different wavelengths, exhibit irregular oscillations of amplitude roughly equal to 3% of the mean
value. We interpret them as stemming mainly from the interference of the fundamental waveguide mode
with slowly decaying radiative modes excited by the cavity. Another culprit might be the mesh modifi-
cations induced by changes of the location of the domain’s boundary. Elimination of these oscillations
would be difficult without considerable enlargement of the computational domain, which would neces-
I
96 Chapter 4. Magneto-optical circulators
88
(a)  D 1299:5 nm (b)  D 1300:5 nm
21:0
87
86
20:5
85
84 20:0
3000 4000 5000 6000 7000 8000 3000 4000 5000 6000 7000 8000
dsep (nm) dsep (nm)
Figure 4.19 Dependence of the isolation I of circulator C1 on the value of dsep for two different wavelengths 
located in the neighbourhood of a maximum of I./. The other parameters are fixed as hmax = 500 nm, p = 5,
dPML = 600 nm, sPML =  and dport = 2250 nm.
sarily lead to a drastic increase of the time of calculations. Therefore, we decide to leave unchanged the
value dsep = 5000 nm taken previously.
The choice of dport is definitely the most difficult. In principle, the value of dport=2 should corre-
spond to the distance from the waveguide axis at which the magnitude of the field of the guided mode
becomes comparable to that of the radiative modes excited by the cavity. Unfortunately, it is not easy to
determine this distance a priori. The value dport = 2250 nm taken so far corresponds to the width of a
port at whose ends the magnetic field of the waveguide mode with  = 1300 nm decays to 1% of its
maximum value.
Figure 4.20 shows the dependence of I on dport at four different wavelengths. For ease of compar-
ison, the plots have been normalised to the values of I obtained for dport = 3000 nm. The curves have
several interesting features. First, the isolation factor varies very rapidly for small values of dport. This
is not surprising: for such small port lengths, the incident field is not represented accurately, since the
profile of the waveguide mode is severely truncated in the direction perpendicular to the waveguide axis.
Second, for large port lengths we observe a steady, seemingly linear decay of I . In fact, a look on the
plots of the field excited on these long ports reveals that in the port regions lying far from the waveguide
axis the field shape does not resemble that of the guided mode any more; this effect is especially pro-
nounced in the isolated waveguideW3. This indicates that the optimum port length might be close to the
value of dport at which the linear decay emerges; however, this value varies with the wavelength. Third,
the dependence of I on dport is visibly strongest at  = 1300:0 nm, which is the wavelength closest to
the peak of I./. This indicates that the maximum value of I./ observed for a given circulator might
be strongly influenced by the choice of dport. Unfortunately, this proves to be the case: the maximum
isolation factors of circulator C1 obtained for dport = 1700, 2000 and 2250 nm are 2130, 3560 and 6140,
respectively. The extreme values differ, then, by nearly a factor of three. On a more positive note, the
bandwidth B.Imin/, a quantity much more important from the experimental point of view, turns out to
be significantly less sensitive to the choice of port length, as long as Imin is not too large. For instance,
the range of wavelengths in which C1 provides an isolation factor better than 100 has width 0:610, 0:615
and 0:618 nm according to simulations performed with the three values of dport quoted previously. We
conclude that while the maximum isolation factors calculated with the present technique do not have
absolute significance, and can at most be used for the purposes of comparison between different struc-
tures, the bandwidths are robust against changes of the domain truncation parameters. Lacking reliable
guidelines on the selection of the optimum port length, we stick to the value chosen previously, i.e.,
dport = 2250 nm.
I
I
4.5. Rib-waveguide-based circulators 97
2:0
1:5
1:0
 D 1299:0 nm
 D 1299:5 nm
0:5
 D 1300:0 nm
 D 1300:5 nm
0:0
0 1000 2000 3000
dport (nm)
Figure 4.20 Dependence of the isolation I of circulator C1 on the value of dport for four different wavelengths 
located in the neighbourhood of a maximum of I./. The other parameters are fixed as hmax = 500 nm, p = 5,
dPML = 600 nm, sPML =  and dsep = 5000 nm.
It is worth noting that some authors [137, 162] have proposed a different method of handling infinite
waveguides in FEM calculations. In their approach, PMLs surround the whole computational domain,
including the waveguide outlets, and the incident waveguide mode is introduced into the system by im-
posing special boundary conditions on a cross-section of the input waveguide lying inside the domain.
As an alternative, one could also divide the system under study in two parts: one comprising the input
waveguide, and the other, the cavity with the output waveguides. In the latter, the finite-element expan-
sion would continue to stand for the total electromagnetic field. In the former, however, the expansion
would represent only the scattered field, i.e., the total field minus the incident waveguide mode. The
latter could be introduced into the system by means of appropriate boundary conditions imposed on the
junction of the two subdomains. The combined structure could then be completely surrounded in PMLs,
as shown in fig. 4.21.
We have not tested any of these solutions, mostly owing to time constraints. However, they could be
implemented in future if the accuracy limits of the approach followed so far become a serious issue.
4.5.3 Geometry optimisation
Having fixed most of the geometrical parameters of the circulator in the way described at the end of
subsection 4.5.1, we were essentially left with the problem of optimising the values of dn and wg.
For the sake of simplicity, we initially focused on structures with dn independent from n, i.e., with
waveguides enclosed in rectangular “slits” of width d . The bandwidth proved a rather cumbersome
objective function, since it is nonzero only for structures already rather close to optimum. Therefore,
the reservations from subsection 4.5.2 notwithstanding, we chose the maximum isolation factor as the
objective function, hoping that circulators with large values of this parameter would also be characterised
by a large bandwidth.
Figure 4.22(a) shows the geometry of the best structure that we have found, called C2 in the follow-
ing. It has 3 full and 4 split rings. The slit width d = 1770 nm and the waveguide ends are located at
wg = 1240 nm from the cavity centre, so that the waveguides cross the outermost full ring. For ease
of reference, the values of all the geometrical parameters of C2 are listed in table 4.5. This circulator
offers maximum isolation of 3590, and the wavelength dependences of T2, T3 and I are shown in fig.
4.22(b). Clearly, the curves are fairly symmetric with respect to the central wavelength  = 1300:0 nm,
which indicates that the direct coupling between waveguides is insignificant. Figure 4.22(c) shows the
map of the magnetic field at  = 1300:0 nm. At this wavelength, 88% of the input power is transmitted
I=I.dport D 3000 nm/
98 Chapter 4. Magneto-optical circulators
PML
Subdomain 2
Subdomain 1
Figure 4.21 Alternative technique of domain truncation. In subdomain 1, the electromagnetic field is repre-
sented by the sum of the field of the incident waveguide mode (assumed known) and the scattered field expanded
on a finite-element basis. In subdomain 2, the finite-element basis is used to expand the total field. Electromagnetic
continuity conditions are imposed on the interface separating the two subdomains (dashed line).
to waveguide 2; the rest is not reflected, but mainly lost to the surrounding free space. Far from the
peak, the amount of these losses can exceed 50%. This behaviour contrasts with that of the PC circu-
lator, where almost 100% of the input power remains in the waveguide system due to the quasi-perfect
isolation provided by the surrounding periodic lattice. The 20-dB bandwidth B.100/ of circulator C2 is
0.729 nm.
The grey curves in fig. 4.22(b) show the transmittance curves of circulator C2 as predicted by the
coupled-wave model with radiation losses taken into account, presented in subsection 4.2.2. The values
of the parameters !0, !,  and l were found by fitting the expressions for T2 and T3 obtained from
eqs. (4.26) to the values calculated numerically. The Levenberg-Marquardt algorithm was used as the
fitting procedure. The best fit was obtained for parameters corresponding to 0  2 c=!0 = 1299:9 nm,
  2 c!=!20 = 2:3 nm,Q  !0=.2/ = 370 andQl  !0=.2l/ = 5730. Clearly, there is a good
match between the theoretical and numerical curves; its quality would probably be further improved by
taking into account the direct coupling between waveguides, which causes the slight asymmetry of the
numerical plots. The quality factor related to losses, Ql, is significantly lower than that of an isolated
cavity with 7 full rings, which is as large as 107,000. This is obviously due to the presence of slits. On
4.5. Rib-waveguide-based circulators 99
1:00 10000
T2
0:75 T 10003
T2 (fit)
0:50 T 1003 (fit)
I
0:25 10
0:00 1
1295:0 1297:5 1300:0 1302:5 1305:0
 (nm)
(a) (b)
(c)
Figure 4.22 (a) Geometry of circulator C2. (b) Wavelength dependence of the transmission (left axis) and
isolation (right axis) of this circulator. (c) Magnitude of the magnetic field in the circulator at the wavelength
 = 1300:0 nm, corresponding to the maximum isolation. The waveguide mode is incident from the left.
the other hand, the position of the ends of the waveguides (just inside the third innermost ring) is in good
accord with the predictions made at the end of subsection 4.5.1.
We have found this device fairly tolerant to variations of the slit width d ; figs. 4.23(a)–(b) show the
plot of the maximum isolation and bandwidth of C2 when this parameter is varied. It can be seen that the
bandwidth stays above 0.5 nm in a 300-nm-wide range of d . The constraints on wg are more stringent:
as shown in fig. 4.23(c), the corresponding range of wg is only about 40 nm wide.
The performance of this structure changes rather abruptly when the number of rings is modified. For
instance, if the seventh ring is removed, the maximum isolation decreases to only 140 and the bandwidth
to 0.386 nm. However, it is possible to improve these figures by readjusting the slit widths and the
Transmission T2, T3
Isolation I
100 Chapter 4. Magneto-optical circulators
0:75
(a) (c)
0:50
0:25
0:00
10000
(b) (d)
1000
100
10
1200 1400 1600 1800 2000 1200 1220 1240 1260 1280
d (nm) rwg (nm)
Figure 4.23 Tolerance of the maximum isolation Imax and the bandwidth B.100/ of circulator C2 to perturba-
tions of the parameters (a)–(b) d and (c)–(d) wg.
1:00 10000
T2
0:75 T 10003
I
0:50 100
cone 0:25 10
0:00 1
1295:0 1297:5 1300:0 1302:5 1305:0
 (nm)
(a) (b)
Figure 4.24 (a) Geometry of a circulator with conical slits surrounding the waveguides. The values of the vari-
ous parameters have been chosen to match those of circulator C3. (b)Wavelength dependence of the transmission
(left axis) and isolation (right axis) of this circulator.
position of the waveguide ends: for wg = 1250 nm and d = 1570 nm (10% less than in the 7-ring case)
Imax reaches 2140 and the bandwidth 0.603 nm.
It is interesting to note that both for 6 and 7 rings the optimum angular length of the removed sectors
of the outermost ring is almost the same: 34ı. This led us to test the performance of a second class
of structures, in which the outer rings are truncated along radial lines instead of ones parallel to the
waveguides, so that the latter are enclosed by conical rather than rectangular air slits, as illustrated in fig.
4.24(a). We found the optimum cone aperture  ıcone to be 35:1 , which is close to the value obtained
in the simulations of the first class of structures (with dn independent from n). The optimum position
of the waveguide end, wg = 1210 nm, is also only slightly different from the original one. More
importantly, the maximum isolation and bandwidth decrease much less (from 3300 to 700 and from
0.770 to 0.708 nm, respectively) when the seventh ring is removed. This relative insensitivity to the
details of the geometrical structure of the exterior region of the device is the behaviour that one would
intuitively expect from a well-designed circulator; therefore, structures with conical slits seem closer to
the ideal that those with rectangular ones. Figure 4.24(b) shows the wavelength dependence of T2, T3
and I of the optimum 7-ring circulator with conical slits, referred to as C3. Its parameters are listed in
table 4.5.
Max. isolation Bandwidth (nm)
Transmission T2, T3
Isolation I
4.6. Simulations of three-dimensional axisymmetric cavities 101
(a) (b)
Figure 4.25 Microphotographs of a rib-waveguide-based circulator etched in a BIG layer grown on a GGG sub-
strate (courtesy of L. Magdenko and B. Dagens, Institut d’Électronique Fondamentale, Orsay, France). (a) Tung-
sten mask before etching. (b) Complete circulator after etching.
4.5.4 Fabrication
Our collaborators from Institut d’Électronique Fondamentale (Orsay, France) have developed a tech-
nique of fabricating magnetophotonic structures in BIG thin films [163]. The films used in experiments,
supplied by the GEMAC team from Versailles, France, were grown on GGG substrates by pulse layer
deposition. The circulators were fabricated by inductively coupled plasma ion etching the BIG layer in a
mixture of boron trichloride and argon, with a nanostructured tungsten layer used as a mask. An example
circulator fabricated in this way is shown in fig. 4.25.
To evaluate the optical properties of the manufactured structures, a series of measurements of the
power transmitted to the two output waveguides was made. The transmittances to the two output branches
were found not to be completely equal. However, reversal of the polarisation of the applied SEMF
brought no discernible change of the transmission levels. Apparently, then, the observed difference
between T2 and T3 was due to fabrication imperfections rather than to nonreciprocal effects.
4.6 Simulations of three-dimensional axisymmetric cavities
4.6.1 Evaluation of possible three-dimensional geometries
Motivation We strongly suspected that the incorrect operation of the fabricated circulators was due to
the fact that their design had been based solely on two-dimensional simulations. While we had attempted
to take the three-dimensional (3D) nature of the true physical system into account by using the effective-
index model to find the material properties of the high- and low-index regions of the simulated structures,
this was evidently not enough. Indeed, the effective-index description is known to give erroneous results
for high-contrast systems, such as those considered in this chapter [164]. In any case, its accuracy can
only be evaluated by comparing its predictions with results of rigorous 3D calculations.
Owing to the time requirements of full-blown 3D simulations, which would be necessary to anal-
yse complete circulators consisting of a cavity coupled to waveguides, we decided to implement first a
method allowing to calculate the eigenmodes of axisymmetric 3D cavities. In this case it is possible to
profit from the knowledge of the azimuthal dependence of the eigenmodes to restrict the computational
mesh to a single meridional (z) plane of the cavity. Our calculations were made with the finite-element
method, described in detail in section 5.3.
High-contrast cavities We began by considering the simplest type of structures, in which the rings
are etched in a layer of BIG with thickness dBIG, sandwiched between a GGG substrate and air, as shown
102 Chapter 4. Magneto-optical circulators
in fig. 4.26(a). We set dBIG = 340 nm and took the refractive indices of BIG and GGG to be nBIG = 2:51
and nGGG = 1:97. The effective index of the unetched areas was calculated to be 2.25, while that of
the etched rings was set to the index of air, nair = 1. The radii of the rings were determined with the
procedure described in section 4.3, with the target wavelength  = 1300 nm. For future reference, we
shall denote this just described geometry with the symbol G1.
Very soon it became apparent that cavities of type G1 behaved very badly in 3D. In fact, they do
not seem to support any well-localised modes near the design wavelength  = 1300 nm. This turns
out to be easily explicable: sufficiently far from the cavity centre, a circular Bragg grating can be well
approximated by a linear grating with period d = 1.n 1Cn 10 1 /, where n0 and n1 denote the refractive4
indices of etched and unetched areas. If d is larger than =.2nGGG/, all Bloch eigenmodes of the grating
will leak into the GGG substrate [165, p. 203]. Unfortunately, this is the case with G1-type structures:
d = 469 nm > =.2nGGG/ = 330 nm.
Low-contrast cavities In view of the failure of the effective-index description of structures of type
G1, we have studied a handful of geometries liable to be approximated better by the effective-index
model. They were proposed by L. Magdenko and B. Dagens (Institut d’Electronique Fondamentale,
Orsay, France).
The first structure that was considered is shown in fig. 4.26(b). In this case, the BIG layer is left
unetched, and the necessary effective-index contrast between successive rings is introduced by etching
an additional high-index layer deposited on top of BIG. This geometry has distinct theoretical and ex-
perimental advantages. First, owing to the continuity of the BIG layer, it supports everywhere a locally
guided mode. This lets us avoid the problem that the effective index, defined with the help of the prop-
agation constant of the fundamental guided mode of a given region, is in fact undetermined for regions
where no guided modes exist. Conventionally, these areas are attributed the index of the sub- or super-
strate but, as noted by Hammer and Ivanova [164], this choice is not based on any rigorous arguments.
In the case of the geometry from fig. 4.26(b), the effective index is well-defined everywhere and one can
hope that this will improve the accuracy of the effective-index description.
From the experimental point of view, the structure in question has the advantage that it does away
with the necessity of etching the BIG layer. This process, while already successfully demonstrated [163],
remains less well developed than the nanostructuration of materials such as silicon or indium phosphide.
On the other hand, the presence of a MO material both in the high- and low-index rings will necessarily
diminish the SEMF-induced mode coupling strength, owing to the cancellation effect described in ref.
148. A possible solution consists in depriving the uncovered areas of BIG of their MO properties, which
can be experimentally achieved by ion implantation.
The structure shown in fig. 4.26(b) is characterised by the refractive index nspl of the supplemen-
tary layer, its thickness dspl, and the thickness of the BIG layer, dBIG. We have taken nspl = 3:50,
corresponding to the index of amorphous silicon around the wavelength  = 1300 nm. The choice of
dspl and dBIG was motivated by two competing goals. On one hand, the supplementary layer had to
be sufficiently thick to provide an appreciable contrast of the effective index of the etched and unetched
areas. On the other hand, dspl could not be chosen too large for fear of generating a second s-polarised
guided mode in the unetched region and of displacing too large a fraction of the guided mode’s energy
away from the BIG layer, which would diminish the MO properties of the system. As a compromise,
the two thicknesses were taken as dspl = 80 nm and dBIG = 280 nm. The effective indices of the etched
and unetched regions were then calculated as 2.19 and 2.50, and the fraction of energy of the guided
mode of the unetched region contained in BIG was found to be 0.48. For convenience, the just described
geometry will henceforth be referred to as G2.
In another type of structures, shown in fig. 4.26(c), the etched BIG layer of thickness dBIG is covered
4.6. Simulations of three-dimensional axisymmetric cavities 103
z
nair
nBIG dBIG

nGGG
(a)
z
nair
nspl dspl
nBIG dBIG

nGGG
(b)
z
nsup
nBIG dBIG

nGGG
(c)
Figure 4.26 Schematics of 3D structures of types (a) G1, (b) G2, and (c) G3 and G4 (which differ only with
the value of nsup).
with a solid superstrate with refractive index nsup close to that of GGG. In this way, the index contrast
between the etched and unetched areas is lessened and one can expect the effective-index approximation
to be more accurate. We considered mainly systems with nsup = 1:97 (exactly equal to the refractive in-
dex of GGG) or nsup = 1:90 (refractive index of silicon nitride) and chose dBIG to be 330 nm. Structures
with these parameters will be called G3 and G4 in the following. The effective indices of their unetched
regions were calculated to be 2.275 and 2.282, respectively, whereas those of the etched areas were set
to min.nGGG; nsup/, i.e., 1.97 and 1.90.
Table 4.6 summarises the results obtained for a handful of structures. Three cavities, designed for
azimuthal orders l = 1, 4 and 10, were tested for each of the geometry types G2, G3 and G4. In addition,
for cavities of type G2 two distributions of the MO coefficient g were investigated. In one series of
simulations, the whole BIG layer was assumed to be uniformly magnetised, so that g was taken to be
0.1 throughout that layer. In the other, the areas of BIG not covered with silicon were assumed to be
deprived of their MO properties and, consequently, attributed g = 0. For ease of reference, these two
variants of geometry G2 will be called G2(a) and G2(b).
The magnitude the relative frequency splitting !=!0 obtained in 3D simulations does not differ
drastically from that predicted by 2D ones. The observed deviation is easily explicable by the fact that
not the whole vertical profile of the unetched areas has MO properties. Anyway, the coupling strength
of the eigenmodes of most of the cavities listed in table 4.6 exceeds that of the 2D high-contrast cavity
104 Chapter 4. Magneto-optical circulators
Type l C   !=!0 (3D) !=!0 (2D) QC Q  Qavg
G2(a) 1 1:27779C 0:00618i 1:27833C 0:00617i  0:00042 — 103 104 103
4 1:27546C 0:00607i 1:27633C 0:00611i  0:00068 — 105 104 105
10 1:27564C 0:00582i 1:27666C 0:00588i  0:00080 — 110 109 109
G2(b) 1 1:27892C 0:00616i 1:27727C 0:00618i 0:00129 0:00166 104 103 104
4 1:27722C 0:00603i 1:27466C 0:00615i 0:00200 0:00286 106 104 105
10 1:27764C 0:00570i 1:27475C 0:00600i 0:00227 0:00342 112 106 109
G3 1 1:28103C 0:00461i 1:27926C 0:00498i 0:00138 0:00224 139 128 134
4 1:28102C 0:00355i 1:27829C 0:00391i 0:00213 0:00356 180 164 172
10 1:28032C 0:00179i 1:27724C 0:00206i 0:00241 0:00408 357 310 334
G4 1 1:28550C 0:00722i 1:28366C 0:00773i 0:00143 0:00207 89 83 86
4 1:28675C 0:00606i 1:28403C 0:00662i 0:00212 0:00348 106 97 102
10 1:28710C 0:00401i 1:28415C 0:00454i 0:00229 0:00411 160 141 151
Table 4.6 Results of 3D calculations of the eigenmodes of cavities with geometries G2(a), G2(b), G3 and G4.
The symbols   and C denote the wavelengths of the modes with azimuthal order l and  l . In addition to the
relative frequency splitting !=!0 of the modes of the 3D cavities, calculated as .ReC   Re /=Œ.ReC C
Re /=2, the values obtained for the corresponding infinite 2D cavities are also given; they are calculated as in
section 4.3. The symbolsQ˙ = .Re˙/=.2 Im˙/ stand for the quality factors of the modes with order l and  l .
Finally,Qavg is defined as .QC CQ /=2.
presented at the end of section 4.3. This can be attributed to the decrease of the effective-index contrast
between etched and unetched areas, and is in accord with the observation from ref. 148 that the reduced
coupling strength of a 2D high-contrast cavity can be augmented three times by making its core of
demagnetised BIG instead of air.
As opposed to the values of!=!0, well preserved in the 2D-to-3D transition, the quality factors of
the 3D cavities are on average ten times smaller than the quality factors obtained with 2D calculations
(related only to the in-plane confinement). The geometry that fares best, G3, provides barely Q = 334.
In addition, even the small deviation from symmetry induced by changing the superstrate’s refractive
index from 1.97 to 1.90 decreases the quality factor by about 50%.
Figures 4.27, 4.28 and 4.29 show the maps of the z components of the magnetic field and the cross
product EEe  EEo of the electric fields of the even and odd eigenmodes of the G2-, G3- and G4-type
cavities designed for the azimuthal order l = 10, in the absence of SEMF. Comparison of figs. 4.28(a) and
4.29(a) gives testimony to the substantial increase of out-of-plane radiation losses in the cavity of type
G4 with respect to that of type G3: the field in the asymmetric cavity features a prominent beam directed
into the substrate, which is absent from that of the symmetric cavity’s eigenmode. The field in the G2-
type cavity from fig. 4.27 is well localised in the vertical direction, and the low quality factor of this
mode seems to stem from the excitation of the fundamental p-polarised mode of the highly asymmetric
GGG-BIG-air multilayer, as evidenced by the relatively large amplitude of the Ez field component on
the plot from fig. 4.27(b).
Both !=!0 and Q typically increase with l (the exception is the geometry G2, for which little
change ofQ is observed). This effect is further illustrated in fig. 4.30(a), which shows the l-dependence
of !=!0 and Q of circulators of type G3. Figure 4.30(b), in turn, presents the dependence of these
parameters on the number of high-index rings, N , with l fixed to 10. It can be seen that !=!0 and Q
reach their asymptotic values around N = 25.
To sum up, the results listed in table 4.6 attest that the SEMF-induced coupling strength of the
eigenmodes of structures G2, G3 and G4 is sufficient to cause a substantial frequency splitting; even in
4.6. Simulations of three-dimensional axisymmetric cavities 105
1:00
(a) jHz j
1000 0:75
0:50
0
0:25
 1000
0:00
1:00
(b) jEz j=Z0
1000 0:75
0:50
0
0:25
 1000
0:00
1:0
(c) eEz  .EEe EEo/
1000 0:5
0:0
0
 0:5
 1000
 1:0
0 2000 4000 6000
 (nm)
Figure 4.27 (a) Magnitude of the z component of the magnetic field of the eigenmodes of the G2-type cavity
designed for l = 10, in the absence of SEMF. (b) Magnitude of the z component of the electric field divided
by Z0. The colour scale is the same for parts (a) and (b). (c) The z component of the cross product EE Ee  Eo of
the electric fields of the even and odd modes of the same cavity, which occurs as the integrand in the expression
for the SEMF-induced mode coupling strength [34].
the unfavourable case of geometry G2 with uniformly MO BIG the frequency splitting of high-l modes
is fairly large. However, the quality factor of these cavities is unsatisfactory. The cavity design must
clearly be further improved to make the resulting devices usable in practice.
4.6.2 Towards cavities with higher quality factor
There are several routes that might potentially lead to an increase ofQ. First, one could augment further
the azimuthal order of the cavity mode; fig. 4.30(b) lets us expect that this will lead to a rise of Q.
Indeed, we have verified that the G3-type cavity designed for l = 40 has Q = 1760. This growth of Q
is achieved, however, at the expense of a significant enlargement of the cavity volume, which may not
always be desirable.
z (nm) z (nm) z (nm)
106 Chapter 4. Magneto-optical circulators
1:00
(a) jHz j
1000 0:75
0:50
0
0:25
 1000
0:00
1:0
(b) eE z  .EEe EEo/
1000 0:5
0:0
0
 0:5
 1000
 1:0
0 2000 4000 6000 8000
 (nm)
Figure 4.28 (a) Magnitude of the z component of the magnetic field of the eigenmodes of the G3-type cavity
designed for l = 10, in the absence of SEMF. (b) The z component of the cross product EE  EEe o of the electric
fields of the even and odd modes of the same cavity. The plot of jEzj=Z0 has been omitted because this field
component is very small.
1:00
(a) jHz j
1000 0:75
0:50
0
0:25
 1000
0:00
1:0
(b) eE z  .EE EEe o/
1000 0:5
0:0
0
 0:5
 1000
 1:0
0 2000 4000 6000 8000
 (nm)
Figure 4.29 Same as fig. 4.28, but for the G4-type cavity.
z (nm) z (nm) z (nm) z (nm)
4.6. Simulations of three-dimensional axisymmetric cavities 107
600 0:0025
(a)
400 0:0020
200 0:0015
Q
!=!0
0 0:0010
0 5 10 15
Bessel order l
400 0:002500
(b)
0:002475
300
Q
0:002450
!=!0
200
0:002425
100 0:002400
10 15 20 25 30
Number of rings N
Figure 4.30 Dependence of the relative frequency splitting !=!0 and quality factor Q of G3-type cavities
(a) on the azimuthal order l with fixed number of high-index rings N = 20 and (b) on the number of rings N with
fixed l = 10.
Second, one might look for ways of improving the accuracy of the effective-index approximation. As
we have mentioned before, the effective index of regions supporting no guided modes is not rigorously
defined. We have tested the influence of changing the value taken for the effective index of the etched
areas of G4-type cavities from 1.90 to 1.97 and found that it brought about a 20-percent growth of Q.
However, the wavelength of the cavity modes shifted by 2.5 nm further away from the design value of
1300 nm, which indicates that the increase of Q was not due to an improvement in the accuracy of
the effective-index description. We have also tried the variational effective-index method proposed by
Hammer and Ivanova [164], but found it to degrade both the quality factor and the match between the
predicted and true value of the frequency of cavity modes.
Third, one should certainly profit from the extensive research on the optimisation of PC cavities done
in the course of the last decade. As discussed in the review by Lalanne et al. [166], the approaches to this
subject proposed so far can be divided into two large classes.
Some authors [167, 168] treat a PC cavity as a system consisting of many “elementary” cells of size
comparable to the lattice constant of the surrounding PC. In each such cell, they expand the field in the
basis of the cell’s Bloch eigenstates. Often, each cell supports only one guided mode (one that does not
radiate energy in the vertical direction). The radiation loss from the cavity is then regarded as resulting
from the scattering of the guided modes into radiative ones at the intercell boundaries. To reduce this
loss, the geometry of each cell must then be adjusted so as to improve the match between the profiles of
the guided modes of successive cells.
Unfortunately, this approach cannot be directly applied to axisymmetric structures, since it relies
on the idea of expanding the field in each cell in its Bloch basis. Maxwell’s equations in cylindrical
Quality factor Q Quality factor Q
Relative shift !=!0
Relative shift !=!0
108 Chapter 4. Magneto-optical circulators
coordinates are not invariant with respect to translations in the radial direction, however, even if the
permittivity and permeability are; therefore the Bloch’s theorem does not carry over to systems periodic
in the radial direction. On the other hand, sufficiently far from the z axis, an approximate version of
the Bloch’s theorem can certainly be formulated. The results from a recent paper [169] indicate that this
approximate formalism is fairly accurate even in small distances from the axis. Thus, it might be possible
to apply the ideas from refs. 167 and 168 to axisymmetric systems. This will be the subject of future
work.
Other researchers [170–173] base their cavity optimisation procedures on the link between the cav-
ity’s radiation pattern and the Fourier transform of its electromagnetic field. The quality factor Q of a
cavity mode can be written asQ = .Re!/U=P , where ! is the mode’s frequency, U stands for the time-
averaged energy stored in its electromagnetic fields, and P is the rate of energy loss [166, 172]. Treating
the cavity as an aperture antenna, one can relate the out-of-plane energy loss rate P? to the 2D Fourier
transforms of the  and  field components on two planes, one lying in the substrate and the other in
the superstrate of the cavity [174, 175]. Englund et al. [172] have gone one step further, rewriting P? in
terms of the z components of EE andHE :
X Z qZ k k2   k2 C k2    x y 1
P? = dkx dky C jE
Q .k 2 Q 2z x; ky/j C jHz .kx; ky/j ;
8 2 2C 2 2 k2 k2 Z2k k
=sub;sup x y
k x y 
(4.48)
where Z
 p 
p
.0 /=.0 / is the (absolute) impedance of medium  (substrate or superstrate),
k k0  and Z Z
Q 1 1 1F .k ; k /  dx dy F .x; y; z / e i.kxxCkyy/z x y z  (4.49)
2   1  1
denotes the 2D Fourier transform of the field Fz on the plane z = z . The plane z = zsub can be taken
to lie just below the interface of the substrate and the guiding layer, and the plane z = zsup, just above
the boundary between the guiding layer and the superstrate. It is important to note that the integrals in
eq. (4.48) run only over the light cones. One concludes that to obtain a high-Q cavity it is necessary to
sweep all the peaks of the Fourier transforms EQ andHQ away from the circle k2 C k2  k2z z x y  [171].
In the axisymmetric case it is possible to simplify eq. (4.48). It can be shown [176, section 9.3] that
the 2D Fourier transform of a function f .; /  f ./ eill is
fQ.k ; /  fQ .k / eil l  ; (4.50a)
where Z
Q 1fl.k/  d  fl./Jl.k/ (4.50b)
0
is the l th-order Hankel transform of f ./. The symbols .; / and .k; / denote the polar coordinates
in the direct and reciprocal space. Using eqs. (4.50) one can bring eq. (4.48) into the form
X Z qk k2   k2 Z k    1
P? =
  dk jEQz .k 2/j C jHQ 2z .k/j : (4.51)
4  k Z20 
=sub;sup 
Figure 4.31(a) shows the squared norms of the Hankel transforms Z 1 EQz;sub.k/ and HQz;sub.k/sub
of the clockwise-rotating eigenmode of a G2-type cavity designed for l = 10 and comprising as much
as 40 high-index rings (to eliminate border effects related to insufficient lateral size). The plane zsub is
4.6. Simulations of three-dimensional axisymmetric cavities 109
taken to lie 1 nm below the top boundary of the substrate. The curves obtained with 3D FEM simulations
are juxtaposed with that stemming from Hankel-transforming theHz field of the eigenmode of the corre-
sponding 2D cavity (this mode is purely p-polarised, so the Ez component vanishes). Clearly, the peaks
of all the curves are fairly well localised outside the light cone, whose boundary, k = 1:97k0, is marked
with a vertical line. Remarkably, the areas under the curves Z 2 jEQ .k /j2z;sub  and jHQz;sub.k/j2 ob-sub
tained with 3D calculations are roughly equal, while the Ez component should vanish according to 2D
simulations. This confirms our earlier conclusions that the low quality factor of the eigenmodes of G2-
type cavities stems from the excitation of a p-polarised guided mode of the multilayer rather than from
radiation losses.
The corresponding plots obtained for G3- and G4-type cavities are shown in figs. 4.31(b) and (c).
While the transforms calculated in the 2D case are virtually indistinguishable, there is a marked differ-
ence in the 3D case: the transform ofHz of the mode of the G4-type cavity extends considerably further
into the light cone than that corresponding to the G3-type structure. This is reflected in the lower quality
factor of the mode of the former cavity, as evidenced in table 4.6. In contrast to what we saw in the
previous paragraph, for G3- and G4-type cavities the part played by the Ez component is completely
negligible.
In all the three systems considered here, the refractive index of the substrate is at least equal to that
of the superstrate. Hence, radiation loss into the substrate dominates over that into the superstrate and,
for brevity, we omit the discussion of the Hankel transforms of the fields on z = zsup.
Advocates of the Fourier-transform-based optimisation of PC cavities have demonstrated that the
quality factor–mode volume ratio of an eigenmode of a given structure can be increased by adjusting its
geometry so as to lessen the decay rate of the mode field near the centre of the cavity. This narrows the
peak of the Fourier transform, so that, provided that the centre of the peak lies outside the light cone, the
integral of the squared norm of the Fourier transform over the light cone diminishes. This design rule
has been summarised as “light should be confined gently in order to be confined strongly” [173].
Unfortunately, it is not easy to establish a link between the geometry of the cavity and the shape of its
eigenmode field. Englund et al. [172] have derived an approximate formula for the permittivity profile of
a cavity supporting a mode with a prescribed spatial dependence. However, they assumed that the field
near the centre of the cavity could be approximated by that of a PC waveguide mode close to cut-off,
i.e., with a very flat dispersion curve. For axisymmetric structures, this assumption is not met: near the
z axis, the cavity mode could possibly be approximated with a guided mode of the multilayer, whose
dispersion relation is in general not flat. Moreover, the formula derived by Englund et al. is based on the
application of the perturbation theory rather far from its domain of validity—to describe discontinuous
high-amplitude perturbations of permittivity. Therefore, its predictions might conceivably be not always
accurate.
The last method that can be tried is the adjustment of ring dimensions based on a purely numerical
optimisation algorithm. We have made some limited attempts at this sort of optimisation, parametrising
the cavity geometry by the seven variables rc, ah, bh, ch, al, bl and cl, defined as follows. The symbol
rc denotes the radius of the central low-index hole. The widths of the high-index rings are taken to be
C bh C cwh;n = hah with n = 1; 2; : : : ; (4.52a)
n n2
whereas these of the low-index rings are set to
b
= C lwl;n al C C
cl
C with n = 1; 2; : : : : (4.52b)n 1 .n 1/2
These particular functional forms were chosen because of their ability of approximating well the ring
width distributions generated by the procedure from section 4.3. As the optimisation routine, we used
110 Chapter 4. Magneto-optical circulators
10:0
(a)
7:5
5:0 jHQ 2z j , 2D calc.
jHQ j2z , 3D calc.
2:5
Z 2jEQ j20 z , 3D calc.
0:0
10:0
(b)
7:5
5:0 jHQ j2z , 2D calc.
jHQ 2z j , 3D calc.
2:5
Z 2jEQ j20 z , 3D calc.
0:0
10:0
(c)
7:5
5:0 jHQ j2z , 2D calc.
jHQz j2, 3D calc.
2:5
Z 2 Q 20 jEz j , 3D calc.
0:0
0 1 2 3
k=k0
Figure 4.31 Squared norms of the Hankel transforms of the eigenmode fields of the cavities of types (a) G2,
(b) G3 and (c) G4 designed to support modes with l = 10 at wavelength  = 1300 nm. In each plot, the Hankel
transforms ofHz and Ez of the eigenmodes of the respective 3D cavities, calculated at the plane lying 1 nm below
the substrate-BIG interface, are juxtaposed with the Hankel transform of the Hz field of the eigenmode of the
corresponding 2D cavity. The vertical line at k = 1:97k0 marks the boundary of the light cone of the substrate.
the trust-region-based gradient-free NEWUOA algorithm by Powell [177]. The objective function was
initially taken as  
! ˛ ˇ
  Qavg (4.53)
!0
with the exponents ˛ and ˇ chosen heuristically as ˛ = 2 and ˇ = 1 to favour cavities with a large
frequency splitting. Later it was found necessary to prevent a drift of the wavelength of the cavity
eigenmodes far away from the design value of  = 1300 nm; this was done by multiplying  by an
additional penalty factor
 1 1p
1C e .  (4.54)min/ 1C e .max /
with  = 0:2 nm 1, min = 1250 nm and max = 1350 nm. At the start of the optimisation algorithm,
the seven parameters were set so as to mimic the ring width distribution obtained with the procedure
described in section 4.3.
jHQ j2 Z 2jEQ j2 jHQ j2 Z 2jEQ j2 jHQ j2 Z 2jEQ j2z , 0 z z , 0 z z , 0 z
4.7. Conclusions and perspectives 111
0:5 (a)
0
0:5 (b)
0
0 2 4 6 8
 (nm)
Figure 4.32 Geometry of (a) the original and (b) the numerically optimised cavity G3-type cavity designed for
the azimuthal order l = 10. The shaded areas are the cross-sections of BIG rings, which are immersed in a material
with refractive index 1.97.
We have not yet tested extensively the above optimisation algorithm, applying it so far only to a few
special cases. One of them was the 20-ring G3-type cavity designed to support a mode with l = 10
at the wavelength  = 1300 nm, whose geometry is shown in fig. 4.33(a). According to table 4.6 the
average quality factor of the counter-propagating modes of this cavity is 334 and the relative frequency
splitting, 0.00241. Using the just described procedure to optimise the radii of the rings, we arrived at
the geometry shown in fig. 4.32(b). The average Q factor of the resonant mode of this structure is as
large as 2630. One can suspect this Q factor to be limited by in-plane rather than out-of-plane losses,
since it is already higher than the Q factor of the corresponding 20-ring 2D cavity, 2156. Remarkably,
the observed improvement of the mode confinement does not occur at a cost of deterioration of the MO
properties of the cavity, whose relative frequency splitting, 0.00260, is even slightly larger than that of
the original structure. Figure 4.33 shows the map of the z components of the magnetic field and of the
cross product EE Ee  Eo of the eigenmodes of this cavity, as well as the squared norms of the Hankel
transformsZ 1 EQz;sub.k/ andHQz;sub.k/. Comparing these curves with those from fig. 4.31(b), it cansub
be seen that the peak of jHQ 2z;sub.k/j of the optimised structure is indeed more tightly localised outside
the light cone of GGG.
4.7 Conclusions and perspectives
The research presented in this chapter was founded on the algorithm for the design of z-invariant axi-
symmetric MO cavities that in the presence of a uniform SEMF exhibit maximum frequency splitting
(section 4.3). In sections 4.4 and 4.5 we put forth a number of designs of three-port circulators incorpo-
rating such cavities and operating according to the model presented in section 4.2. Lastly, in section 4.6,
we studied the properties of the proposed cavities in a 3D setting, using full 3D simulations.
In the course of this work, we increasingly tried to take into account the 3D nature of real integrated
systems, in which the components are etched in BIG thin layers grown on GGG substrates. Initially,
we performed purely 2D calculations, using bulk indices of the constituent materials. To some extent,
this approach was justified: the algorithm from section 4.3 was based on 2D considerations, and it was
necessary to compare the performance of the cavities designed by its help against those proposed before
[34, 37, 150], which were also evaluated in a purely 2D setting.
At the next stage, we attempted to take into account the multilayer structure of the experimental sys-
tem with the effective-index approximation, which is fairly widely used to bring the results of 2D simu-
lations of, in particular, PC-slab-based devices closer to reality. The design of the rib-waveguide-based
circulators, reported on in section 4.5, was done in this way. However, measurements of the transmittance
z (nm) z (nm)
112 Chapter 4. Magneto-optical circulators
1:00
(a) jHz j
1000 0:75
0:50
0
0:25
 1000
0:00
1:0
(b) eE z  .EEe EEo/
1000 0:5
0:0
0
 0:5
 1000
 1:0
0 2000 4000 6000 8000
 (nm)
7:5
(c)
5:0
2:5 jHQ j2z , 3D calc.
Z 2jEQ j20 z , 3D calc.
0:0
0 1 2 3
k=k0
Figure 4.33 (a) Magnitude of the z component of the magnetic field of the eigenmodes of the optimised G3-
type cavity designed for l = 10, in the absence of SEMF. (b) The z component of the cross product EEe  EEo of
the electric fields of the even and odd modes of the same cavity. (c) Squared norms of the Hankel transforms of
the eigenmode fieldsHz and Ez at the plane located 1 nm below the surface of the substrate.
through fabricated components of this type revealed that the behaviour of the 3D cavity differed strongly
from the predictions of the 2D model. It became apparent that full 3D simulations were inevitable.
The results of these calculations, summarised in section 4.6, proved that resonant cavities designed by
help of the effective-index approximation do have good MO properties: the SEMF-induced splitting of
the frequencies of their eigenmodes is indeed spectacular. However, the cavities suffer from substantial
radiation losses in the vertical direction. The outcome of the various attempts at increasing the quality
factor of these cavities, presented in subsection 4.6.2, points to the conclusion that 3D simulations are,
unfortunately, all but unavoidable. They are required not only in the somewhat “brute-force” numerical
optimisation of ring widths described at the end of subsection 4.6.2, but also in the approach based on
Bloch’s theorem, which we have not tested, but which definitely looks promising.
Regardless of the way in which a cavity is designed, it must still be integrated with waveguides. The
results from section 4.5, while based on the effective-index approximation and therefore inaccurate, do
z (nm) z (nm)
jHQ j2 Z 2jEQ j2z , 0 z
4.7. Conclusions and perspectives 113
provide some insight into the problem of cavity–rib-waveguide coupling. In particular, they confirm that
the optimum location of the waveguide ends can be approximately determined by analysing the quality
factors of cavities with a varying number of rings. Therefore, if the distance from the cavity centre to
the ends of 3D waveguides is figured out with this method, some nonreciprocal isolation should be ob-
servable in experiment. Clearly, though, some numerical fine-tuning of this distance will be necessary
to optimise the maximum isolation and the operation bandwidth of the device. Three-dimensional sim-
ulations of a complete circulator would be prohibitively slow. However, as a workaround one might try
the method of Andreani and Gerace [178], who successfully calculated the diffraction losses of eigen-
modes of PC slabs by expanding the fields in terms of a few lowest guided modes of a specific multilayer
(dependent on the structure of the slab) and including the radiation losses in a perturbative way.

Chapter 5
Numerical methods
5.1 Multiple-scattering method for systems containing gyrotropic media
In section 4.4 we presented results of numerical simulations of the scattering of electromagnetic waves
by 2D PCs composed of circular cylinders etched in a MO, and thus anisotropic, matrix. The multiple-
scattering method used to make these calculations was originally derived for isotropic materials [38].
Here we show that it can be extended with very little effort to the case of gyrotropic media.
The most important assumption of the method, which is described in detail in refs. 38, 39 and 40,
is that the field Fz (standing for Ez for s-polarised waves and Hz for p-polarised ones) in the medium
surrounding the scatterers is governed by the Helmholtz equation
r2F C k2n2z 0 Fz = 0; (5.1)
where k0  !=c, ! denotes the frequency, and n is the refractive index of the medium in question.
It can be shown that in each circular annulus surrounding a particular scatterer Si and intersecting no
other scatterers the field F can be decomposed into three parts: F srcz zi , the incident field coming directly
from the source, F inc, the field scattered towards S by other scatterers, and F scattzi i zi , the field scattered
by Si itself. Each of these fields can be writtenXin the form of a Fourier-Bessel series:
F src. ;  / = asrcJ .k n / eimizi i i im m 0 i ; (5.2a)
mX2Z
F inc. ;  / = aincJ .k n / eimizi i i im m 0 i ; (5.2b)
mX2Z
F scatt. ;  / = b H .1/.k n / eimizi i i im m 0 i ; (5.2c)
m2Z
where src, inc and are constant coefficients, and .1/aim aim bim Jm.x/ Hm .x/ denote the Bessel and Hankel
functions of the first kind, and .i ; i / are polar coordinates defined with respect to the centre of the
annulus. With the so-called Graf’s theorem, a link can be established between the series (5.2) expressed
in coordinate systems associated with different scatterers. This makes it possible to write F inczi in terms
of F scattzj for all j ¤ i . Moreover, a linear relation exists between the Fourier-Bessel coefficients of the
sum F src C F inc and those of F scattzi zi zi . With aEi and bEi denoting the column vectors of the coefficients
.asrc C aincim im / and bim, respectively, this relation can be expressed as
bEi = SOiaEi ; (5.3)
where SOi is conventionally called the scattering matrix of Si . Its entries can be obtained by imposing
the electromagnetic boundary conditions on the inner surface of the annulus mentioned above. Their
115
116 Chapter 5. Numerical methods
derivation is particularly simple for a homogeneous isotropic circular scatterer with refractive index ni ;
in this case, the total field Fz inside Si can alsoXbe written as a Fourier-Bessel series,
F int. ;  / = c J .k n  / eimizi i i im m 0 i i ; (5.4)
m2Z
and since the surface of Si coincides with a constant coordinate line of the polar coordinate system
anchored at the centre of Si , field matching can be done analytically and in fact the matrix SOi becomes
diagonal.
We shall now show that Maxwell’s equations describing wave propagation in a homogeneous medium
can also be reduced to a Helmholtz equation if the medium has gyrotropic permittivity and permeability
of the form 2 3 2 3
t ig 0 t ig 0
O  4 i  05 and O  4 i  0 5g t g t : (5.5)
0 0 z 0 0 z
We shall focus on p polarisation; the results for s polarisation can be obtained from the duality principle
[65, p. 72–73]. Substituting eqs. (5.5) into Maxwell’s equations for p polarisation, eqs. (1.7), and writing
the differential operators explicitly in Cartesian coordinates, we get
@Ey   @Ex = i!0zHz; (5.6a)
@x @y
@Hz =  i!0.tEx C igEy/; (5.6b)
@y
 @Hz =  i!0. igEx C tEy/: (5.6c)
@x
Solving the two last equations for the components of EE, we obtain
 
1 @H
= i z
@Hz
Ex   g C t ; (5.7a)i! .20 g 2t / @x @y 
1 @Hz
Ey =    t C
@H
i zg : (5.7b)
i! 2 20.g  / @x @yt
Substitution of these expressions into eq. (5.6a) yields
2 2  2@ Hz C @ Hz C k20 t   g zHz = 0: (5.8)@x2 @y2 t
Thus, the fieldHz fulfils a Helmholtz equation with an “effective refractive index”
n0  Œ.   2= / 1=2t g t z : (5.9)
It is also possible to derive analytically the expression for the entries of the scattering matrix SO of a
homogeneous gyrotropic cylinder S of radiusR embedded in a gyrotropic matrix. We need to impose the
conditions of continuity of the components of the electric and magnetic fields tangential to the surface
of S , i.e.,Hz and E . The fieldHzXon the exterior side of the surface of S is given by
H ext.R; / = Œa J .k n0 R/C b H .1/.k n0 R/ eimz n m 0 ext n m 0 ext ; (5.10a)
m2Z
5.1. Multiple-scattering method for systems containing gyrotropic media 117
and on the interior side, X
H int.R; / = c J .k n0 R/ eimz n m 0 int I (5.10b)
m2Z
in these formulas, the subscripts “int” and “ext” label quantities measured on the interior and exterior
side of the surface of S . Equations (5.7) imply that
 
1 @Hz
E =    t C
ig @Hz
; (5.11)
i!0.2 2g / @r r @t
hence
X
ext   1 .mg;ext=R/Jm.k0n
0 R/C  k 0 0 0ext t;ext 0nextJm.k0nextR/E .R; / = ami! 2   20
m2Z g;ext t;ext
.1/ 0 C 0 .1/0 0 C .mg;ext=R/Hm .k0nextR/ t;extk0nextHm .k0n R/b ext imm   e ; (5.12a)2 2g;ext t;ext
  1
X .mg;int=R/J 0m.k0n R/C  0t;intk0n J 0 .k n0 R/
Eint
m 0
.R; / = c int int int im m   e ; (5.12b)i! 2 20
m2Z g;int t;int
where the symbols 0 and .1/0Jm.x/ Hm .x/ denote the derivatives of the Bessel and Hankel functions at x.
To condense the notation, we can rewrite eqs. (5.10) and (5.12) in the form
X X
H ext.R; / = .AHa C BHb / eim ; H intz m m m m z .R; / = CH c imm m e ; (5.13a)
mX2Z mX2Z
Eext.R; / = .AEa C BEb / eim ; Eint m m m m  .R; / = CE imm cm e ; (5.13b)
m2Z m2Z
where the definitions of the constant coefficients AHm etc. can be obtained straightforwardly by com-
paring the above expressions with eqs. (5.10) and (5.12). Imposing now the conditions H extz .R; / =
H int.R; / and Eext.R; / = Eintz   .R; / for all  2 Œ0; 2 / and noting that, owing to the orthogonality
of the functions eim (m 2 Z) on this interval, the sums over m can be dropped, we arrive finally at the
formulas
H E
 AmCm   A
E
mC
H
b = mm   am; (5.14a)BH E Em Cm BmCHm
H E
 AmBm   A
E
mB
H
c = mm   am: (5.14b)BH E Em Cm BmCHm
Thus, by virtue of eq. (5.14a), we conclude that the scattering matrix SO of a gyrotropic cylinder embedded
in a gyrotropic matrix is diagonal and its elements are given by
H E
 AmCm   A
E H
S = m
Cm
mn   ımn: (5.15)BH E Em Cm BmCHm
We have thus demonstrated that only minor modifications of the multiple-scattering method are nec-
essary to make it able to tackle gyrotropic materials. First, the refractive index n supplied to the argument
of Bessel functions must be replaced by the “effective refractive index” n0 defined in eq. (5.9). Second,
118 Chapter 5. Numerical methods
the formulas for the entries of the scattering matrix of a cylinder acquire additional terms proportional to
the off-diagonal elements of the material property tensors.
It is natural to ask whether these steps suffice for different classes of anisotropic materials. The
answer is, unfortunately, negative. For instance, consider the case of a medium with permittivity O 
diag.x; y ; z/ with x ¤ y . The transformation of Maxwell’s equations into the Helmholtz equation
comes now at the price of the change of coordinates
r
sx y
.x; y/!7 .sxx; syy/ with = ¤ 1: (5.16)
sy x
An unwelcome side-effect of this change of coordinates is the mapping of circles into ellipses. This has
two consequences. First, the elements of the scattering matrix of a circular cylinder cease to be diagonal
and have to be determined in a more complicated way than that presented above, since after the mapping
the cylinder’s surface does not coincide any more with a line of constant polar coordinates. Second, if
it is the matrix (rather than the scatterer) that is anisotropic, the mapping (5.16) may cause the circles
circumscribing the scatterers to overlap. It is well known that if this overlap is sufficiently large, the
Fourier-Bessel expansion (5.6c) of the scattered field becomes invalid and the multiple-scattering theory
in it classical form cannot be applied [179, 180].
5.2 Calculation of photonic-crystal band structures
with Fourier-Bessel expansions
5.2.1 Introduction
The multiple-scattering method, whose extension to MO materials we have presented in the previous
section, has long been recognised as one of the most efficient techniques of modelling finite PCs com-
posed of circular cylinders. The reason for this is twofold: first, the basis functions used to expand the
fields are exact solutions of Maxwell’s equations, and hence they are well-adapted for the representation
of these fields; second, since the basis functions are separable in polar coordinates, it is easy to apply the
electromagnetic boundary conditions at the surfaces of the cylinders.
In view of these advantages of the multiple-scattering method, it is tempting to extend its domain of
application to the calculation of band structures of infinite PCs. Such an extension has indeed been made
both for PCs composed of cylinders and spheres [41–47]. In this approach it is necessary to calculate ex-
plicitly the field produced by an infinite number of scatterers arranged on a periodic lattice, which can be
expressed by a series termed a lattice sum. Unfortunately, lattice sums are slowly convergent, and special
techniques needed for acceleration of their computation complicate significantly the implementation of
the method with respect to the finite-system case.
Here we propose a much simpler technique of calculating band structures of PCs composed of cir-
cular cylinders. Like the multiple-scattering method, it relies on Fourier-Bessel field expansions, but it
dispenses with the calculation of lattice sums. The underlying idea is very simple: the field in a unit cell
of a PC is expanded in terms of particular solutions of the Helmholtz equation, and the Bloch conditions
on the boundaries of the cell are imposed by collocation (point matching). This approach is actually
similar to the technique used in the fictitious-sources method to avoid the calculation of periodic Green’s
functions in simulations of gratings [48]. The method is easy in implementation and it leads to expo-
nential convergence of the band structure, potentially yielding very high relative accuracy, as will be
demonstrated in the following.
The proposed method shares many features with the technique of Dirichlet-to-Neumann mappings
developed in the group of Lu [49, 50]. In their approach, a field expansion in particular solutions of the
5.2. Calculation of photonic-crystal band structures with Fourier-Bessel expansions 119
Helmholtz equation is used to calculate a finite-dimensional approximation of the Dirichlet-to-Neumann
operator that maps the distribution of the field on the unit cell’s boundary to that of the normal derivative
of this field. The resulting operator can then be used to calculate the band structure of the PC. Our method
is more direct and more efficient, since it does not require the construction of the Dirichlet-to-Neumann
matrix, and hence dispenses with the need of performing a matrix inversion. On the other hand, it is
also less powerful, since a Dirichlet-to-Neumann operator can be used for the sake of computing not
only a band structure, but also, for instance, the transmission and reflection coefficients of a finite or
semi-infinite PC [50]. One could say that while the method of Lu et al. is more general, ours has been
specifically tailored to band-structure calculations.
In the next subsection we shall present the formulation of the proposed technique. Some concrete
numerical examples of its application will be given in subsection 5.2.3, and the obtained results will be
briefly discussed in subsection 5.2.4.
5.2.2 Formulation
Let us consider a 2D PC whose unit cell, shown in fig. 5.1(a), is composed ofM nonoverlapping circular
inclusions of radius rm, permittivity Om and permeability Om (m = 1; 2; : : : ;M ), embedded in a matrix
with permittivity O0 and permeability O 0. The tensors Om and Om (m = 0; 1; : : : ;M ) are assumed to
have the (gyrotropic2) form 3 2 3
tm igm 0 tm igm 0
Om  4 i  0 5 and O  4 i  0 5gm tm m gm tm : (5.17)
0 0 zm 0 0 zm
As we have shown in section 5.1, for p polarisation, the Maxwell’s equations in a homogeneous region
with permittivity Om and permeability Om reduce to the Helmholtz equation for the z component of the
magnetic field,Hz:
r2H C k2z mHz = 0; (5.18)
where  2 1=2
km  !
gm
tm   : (5.19)
c tm
The corresponding equation for s polarisation can be obtained simply from the duality principle [65, p.
72–73]. Vekua [181, section 22] showed that every regular solution of the Helmholtz equation (5.18) in
a multi-connected domain D  D0n.C1 [ C2 [    [ CM /, where D0, C1, C2, : : : , CM are simply-
connected domains and C1; C2; : : : ; CM  D0, can be approximated uniformly by a linear combination
of the functions
J .k / eil and Y .k  / eilml m l m m for l 2 Z and m = 1; 2; : : : ;M; (5.20)
where .; / are standard polar coordinates and .m; m/ are the polar coordinates defined with respect
to the point Om 2 Cm [see fig. 5.1(b)].
We shall use Vekua’s theorem to determine the representation of the field in the PC unit cell shown
in fig. 5.1(a). We divide it into M 0  M polygonal subcells, each containing exactly one circular
inclusion. (For numerical purposes it can be advantageous to introduce subcells containing no “physical”
inclusions; these can be treated as if they contained an inclusion with permittivity O0, permeability O 0
and a sufficiently small radius.) Inside the inclusion of the mth subcell, the solution of the Helmholtz
equation can be approximated by the series
XL
.L/  .L/H .m; m/ c Jl.kmm/ eilm ; (5.21)z;in ml
l= L
120 Chapter 5. Numerical methods
D0
P
C1
1
1
 2
O1
 
C
2 2
O O2
(a) (b)
Figure 5.1 (a)Geometry of a PC’s unit cell that containsM = 3 circular inclusions embedded in a homogeneous
matrix. It is subsequently divided into M 0 = 4 quadrilateral subcells. (b) Schema of the domain D referred to in
Vekua’s theorem. Note that the symbol D0 denotes the whole interior of the large contour, whereas D stands for
the shaded region.
with the polar coordinates .m; m/ defined with respect to the origin Om lying in the centre of the
inclusion. In turn, the field outside the inclusion can be approximated by
XL
.L/  .L/ .L/H . ;  / Œa J .k  /C b Y .k  / eilmz;out m m l 0 m l 0 m : (5.22)ml ml
l= L
The superscripts .L/ in the above formulas stress that, according to Vekua’s theorem, the system
(5.20) is complete, but need not be a basis. In other words, it is not guaranteed, for instance, that there
exist coefficients aml and bml (Xl 2 Z) such that the series
Œa J .k  /C b Y .k  / eilmml l 0 m ml l 0 m (5.23)
l2Z
converges to the true solution Hz;out.m; m/. What is guaranteed is that a finite superposition of the
functions (5.20) can be found that approximates Hz;out.m; m/ to any desired accuracy  > 0. This is
quite sufficient for practical purposes. An example illustrating clearly the difference between a basis and
a complete set is given by Christensen [182, pp. 98–99]. For compactness of notation, the superscripts
.L/ will be dropped from now on.
At the present stage, to each subcell correspond three families of unknown coefficients: aml , bml
and cml . The former two can be easily expressed in terms of the latter one by imposing analytically the
electromagnetic boundary conditions at the surfaces of the circular inclusions. This is done exactly in
the same way as in the multiple-scattering method, and has been detailed in ref. 40 for the isotropic case
and in section 5.1 of this thesis for the gyrotropic case. Therefore, we do not describe it again here. In
any case, this procedure leads to expressions of the form
aml = Amlcml and bml = Bmlcml ; (5.24)
where Aml and Bml are known. Substituting them to eq. (5.22), we get
XL
H . ;  /  c ŒA J .k  /C B Y .k  / eilmz;out m m ml ml l 0 m ml l 0 m : (5.25)
l= L
To determine the values of cml , we impose appropriate boundary conditions at discrete collocation points
distributed on the inter-subcell boundaries, which can be divided into two classes. On an interface of two
5.2. Calculation of photonic-crystal band structures with Fourier-Bessel expansions 121
subcells belonging to the same unit cell, we impose the continuity of Hz and its derivative normal to
that interface. (The continuity of the tangential derivative should follow, in the limit of infinitely many
collocation points, from the continuity of Hz itself.) On an external boundary of a unit cell, in turn,
we impose Bloch conditions on Hz and its normal derivative. Assuming that the number of collocation
points is equal to half the number of unknowns cml , the above procedure leads to a homogeneous system
of linear equations, whose matrix is square and depends on the Bloch vector kE. This system is subse-
quently transformed into a generalised eigenvalue problem for one of the components of kE, as will be
demonstrated on an example later in this section.
In the meantime, there is a technical difficulty to be resolved. As we have seen, we have always an
even number of boundary conditions. However, the expansion (5.25) contains an odd number (2LC 1)
of coefficients cml . In order to match the number of equations and that of unknowns, it is necessary
to dispense with one coefficient. To this end, we follow a procedure used in spectral Fourier-expansion
techniques [183, subsection 2.2.1]. We rewrite the exponential functions eilm in eq. (5.25) in terms of
the trigonometric functions cos.l / and sin.l /, and use the relations J  .x/ = . 1/lm m l Jl.x/, Y l.x/ =
. 1/lYl.x/, Am; l = Aml and Bm; l = Bml to convert the series from eq. (5.25) to the form
XL
Hz;out.m; m/  ŒAmlJl.k0m/C BmlYl.k0m/Œd cml cos.lm/C d sml sin.lm/; (5.26)
l=0
where
d c  c C . 1/lc   and d s  iŒc   . 1/lml ml m; l ml ml cm; l : (5.27)
We set now d smL = 0, obtaining
XL
Hz;out.m; m/  d cml ŒAmlJl.k0m/C BmlYl.k0m/ cos.lm/
l=0
X  (5.28)L 1
C d sml ŒAmlJl.k0m/C BmlYl.k0m/ sin.lm/
l=1
and reducing the total number of unknowns to 2L.
We shall now present in detail the conversion of the square system of linear equations resulting from
the collocation procedure to an eigenvalue problem, considering the example case of a PC composed
of a hexagonal lattice of cylinders, shown in fig. 5.2(a). Its unit cell can be chosen as the Wigner-Seitz
cell delimited by the segments ˙i (i = 1; 2; : : : ; 6). Since it contains only a single inclusion, it is not
necessary to divide it into subcells. Let us assume that on each segment ˙i L=3 collocation points with
polar coordinates .1;ij ; 1;ij / (j = 1; 2; : : : ; L=3) are distributed so that the positions of the points lying
on opposite sides of the cell differ by a lattice vector. Let us denote by HO i the matrix of size .L=3; 2L/
that, right-multiplied by the vector of unknowns dE  Œd c ; d c ; : : : ; d c ; d s ; d s ; : : : ; d s T1;0 1;1 1;L 1;1 1;2 1;L 1 ,
will produce the vector of values of the fieldHz at the collocation points lying on the segment˙i . From
eq. (5.28), the elements ofHO i are given by (
O C  cos.l1;ij / for l = 0; 1; : : : ; L;.Hi /jl = ŒA1lJl.k01;ij / B1lYl.k01;ij / C C (5.29)sin.l1;ij / for l = L 1;L 2; : : : ; 2L:
The analogous matrix that, right-multiplied by dE, will produce the vector of derivatives of Hz taken in
the direction normal to ˙ will be denoted byHO 0i i .
122 Chapter 5. Numerical methods
bE2
aE2
a ˙3 ˙2
M
˙ r4 ˙1
0
aE   K M1
collocation ˙5 ˙6
E
points b1
(a) (b)
Figure 5.2 (a) Geometry of a hexagonal-lattice PC composed of circular air holes etched in a dielectric matrix.
A Wigner-Seitz unit cell is marked by shading. (b) Reciprocal space of this PC. Large dots mark the positions
of reciprocal lattice points. The hexagonal first Brillouin zone is also shown; its irreducible part  MK has been
shaded.
In this matrix notation, the equations resulting from imposition of the Bloch boundary conditions at
all the collocation points take then the form
O E ikEH d = e aE1 HO dE; HO 0dE =   eikEaE1 HO 01 4 1 4dE;
O E ikEaE O E O 0 E   ikEH d = e 2 H d; H d = e aE2 HO 0dE2 5 ; (5.30)2 5
HO dE = eikE.aE2 aE / E13 HO6dE; HO 03dE =   eik.aE2 aE1/HO 06dE;
p
where aE 1 31  .a; 0/ and aE2  . a; a/ denote the basis vectors of the hexagonal lattice show2 2 pn in fig.
5.2(a). The Blo
E  p
ch vector kE can be expressed as kE = k E E E 2 1b1 C k2b2, where b1  .1; 1= 3/ anda
b 2 2 .0; 2= 3/ are the basis vectors of the reciprocal lattice of the PC in question, shown in fig.a
5.2(b), and have the property aEi  bEj = 2 ıij . Consequently, eqs. (5.30) can be rewritten as
.HO   e2 ik1 HO /dE = 0; .HO 0 C e2 ik1 HO 01 4 1 4/dE = 0;
.HO   e2 ik2 HO /dE = 0; .HO 0 C e2 ik22 5 HO 0 /dE = 0; (5.31)2 5
.e2 ik1 HO 2 ik2 O E 2 ik1 O 0 2 ik2 O 0 E3   e H6/d = 0; .e H3 C e H6/d = 0:
To bring this system into the form of an eigenvalue problem, we can fix the value of some linear combi-
nation of k1 and k2. For instance, calculations of the band structure of the hexagonal-lattice PC from fig.
5.2(a) are most often done along the boundaries of the irreducible fragment of its first Brillouin zone, the
triangle  MK, shown in fig. 5.2(b). On the segment  M , the Bloch vector kE has the form kE = bE1CbE2
with 0    1 . Thus, setting k1 = k2   in eq. (5.31) and reordering terms, we obtain the linear2
eigenvalue problem 2 O 3 2 36 H HO666
1 4
HO 0 7 6 O 07
O1
7
6 77 6
6
H 7 E 6
 H 7
6 HO
47
6 2 7 d = e2 i6 O 0 7 6
57 E
6  O 0777 d: (5.32)4 HHO 2 HO3 65 4 H50O 5
HO 03 CHO 0 0O6
5.2. Calculation of photonic-crystal band structures with Fourier-Bessel expansions 123
Since the matrices HO and HO 0i i have dimensions .L=3; 2L/, it can be easily verified that the matrices in
the above equation are square.
Things are slightly more complex for the segment  K. There, the Bloch vector kE = 2bE1 C bE2
with 0    1 , and eqs.
3 2(5.313) reduce to thO 2
e quad3ratic eigenva2lue pro3blem
H 0O  HO
6 1 466HO 0777 666 0O 777 666 HO 076 17 76HO 7 O O
47
6 26 O 077
E C e2 i 666 H57d O 077 dE6 7 C e
4 i
66
66 0 7O 77 dE7 = 0: (5.33)4HO25 4 HO5H6  H35 4 00O 5
HO 0 HO 06 3 0O
This problem can be solved in a number of ways [184]. The most popular of them, which we employ
here, is linearisation: given an equation of the form .AO C BO C 2CO /xE = 0, one defines yE  xE and
solves a linear eigenvalue problem"of doub#leO O "
siz#e, e."g.,O O #" #A B xE 0  C xE
O O E = O O E ; (5.34)0 I y I 0 y
where IO denotes the identity matrix. Alternative linearisations are also possible, but they are advanta-
geous primarily if the original quadratic eigenvalue problem has a particular structure—for instance, is
symmetric—which is not the case here.
The band structure on the KM segment could be calculated by solving a third eigenvalue problem
obtained from eq. (5.31) by imposing the constraint k1 C k2 = 1. However, owing to the six-fold
rotational symmetry of the PC from fig. 5.2(a), its dispersion diagram on KM is identical with that on
the segmentKM 0, shown in fig. 5.2(b), which is collinear with  K. Thus, the band structure on  K and
KM 0 can be obtained simultaneously by solving the eigenvalue problem (5.33); values of  belonging
to the intervals Œ0; 1  and Œ1 ; 1  will then correspond to Bloch vectors lying on the segments  K and
KM 0
3 3 2
, respectively.
5.2.3 Numerical examples
We shall now apply the method introduced in the previous subsections to the determination of the band
structure of several example PCs. The results obtained with this technique will be compared to those
produced by another, well-tested code. We shall also examine the convergence rate of Fourier-Bessel
expansions and discuss some technical details of the implementation of the proposed method.
We begin with the simple case of a PC composed of a hexagonal lattice of air holes of radius r =
0:3a, where a is the lattice constant, etched in a dielectric matrix with refractive index 2.5, as shown
schematically in fig. 5.2(a); this is in fact the PC introduced in section 4.4. First, it is necessary to check
whether the proposed method yields results convergent with increasing truncation order L. We shall
therefore study how the changes in L influence the magnitude of the Bloch vector kE of the state located
on the  M segment and having frequency ! = 0:40  2 c=a (chosen arbitrarily). In practice, the
determination of the error of a calculated value of k is complicated by the fact that the exact magnitude
of kE is not known. As a workaround, given a series of values ki (i = 1; 2; : : : ; NL) obtained at several
monotonically increasing truncation orders Li , we shall take as a reference the value ki for which the
expression .jki   ki 1j C jki   kiC1j/=jki j is smallest.
The collocation points on all boundaries ˙i (i = 1; 2; : : : ; 6) of the unit cell will be initially placed
at the Gauss-Legendre quadrature points, i.e., at the roots of the Legendre polynomial of order L=3C 1
[183, p. 252]. This choice will be later demonstrated to be near-optimal.
124 Chapter 5. Numerical methods
100
(a) (b) Equidistant
  Chebyshev10 5 Legendre
10 10 No bal.
Bal. (1)
10 15 Bal. (2)
0 50 100 150 200 0 50 100 150 200
L L
Figure 5.3 (a) Convergence of the magnitude of the Bloch vector kE of the state located on the  M seg-
ment in the first Brillouin zone of the hexagonal-lattice PC shown in fig. 5.2(a). The frequency was fixed to
! = 0:40  2 c=a. The different data series refer to results obtained with different levels of eigenvalue-problem
balancing. Crosses: no balancing. Black circles: out-of-the-box balancing as provided by LAPACK. White cir-
cles: balancing preceded by elimination of nonzero matrix entries due to round-off error, as described in the text.
(b) Convergence of k with three different distributions of collocation points: equidistant points (crosses), Gauss-
Chebyshev quadrature points (black circles), Gauss-Legendre quadrature points (white circles).
Since Bessel functions of different orders vary greatly in magnitude for a fixed argument, the eigen-
value problems (5.32) and (5.33) very quickly become numerically close to singular if no rescaling of
the basis functions is done. This leads to erroneous results. As a remedy, it is possible to scale the
basis functions manually, e.g., by normalising them to the value they attain at a typical (in some sense)
distance from the collocation points to the origin of the coordinate system. However, we found it more
convenient to rely on the matrix-pair balancing algorithm due to Ward [185], which can be invoked auto-
matically by the generalised non-symmetric eigensolver routine ggevx from the LAPACK library [186].
In fig. 5.3 the points marked with black circles show the convergence of k calculated in this way with
the truncation order L. Clearly, relative accuracy of 10 7 is achieved in a fairly wide range of trunca-
tion orders. However, there is still room for improvement, since the machine precision is much higher
(10 16/.
The performance of the balancing algorithm of Ward [185] is degraded by the presence of small
matrix elements due to round-off error [187, balance function]. Such entries do occur in our case; they
correspond to collocation points located on nodal lines of trigonometric functions cos.lm/ and sin.lm/
of various orders l [cf. eq. (5.29)]. It is impractical to locate such points by hand. Therefore we have
used instead a heuristic procedure that looks for matrix entries smaller than a given fraction  of the
average magnitude of the elements of the column they lie in. These entries are subsequently replaced
with zeros. The value  = 10 10 seems to work well. As demonstrated by the series marked with white
circles in fig. 5.3(a), introduction of this procedure leads to a significant increase of the attainable relative
accuracy, which reaches 10 14.
We have also studied the dependence of the convergence rate on the placement of collocation points.
Three distributions were considered: Gauss-Legendre, Gauss-Chebyshev and equispaced. As shown in
fig. 5.3(b), the former two yield approximately the same convergence rate of k (the Gauss-Legendre
distribution performing marginally better), while the equispaced points fare distinctly worse. These
tendencies have also been observed for other frequencies and PC geometries. Thus, in the remaining
examples we use the Gauss-Legendre distribution.
In figs. 5.4(a) and (b) the band structures of the crystal from fig. 5.2 computed for p and s polarisa-
tions with the method under study are compared with the data obtained using the MPB library [188]. For
both polarisations, a perfect visual agreement can be seen.
Relative error
5.2. Calculation of photonic-crystal band structures with Fourier-Bessel expansions 125
0:4 (a) (b)
0:2
0:0
  M K     M K  
Figure 5.4 Comparison of the (a) p-polarisation and (b) s-polarisation band structure of the hexagonal-lattice
crystal from fig. 5.2, calculated with the method described here (points) and with the MPB library (lines).
aE bE2 2
M
r
aE   X1 bE1
a
a
(a) (b)
Figure 5.5 (a) Geometry of a square-lattice PC composed of circular air holes etched in a dielectric matrix. A
Wigner-Seitz unit cell is marked by shading. (b) Reciprocal space of this PC. Large dots mark the positions of
reciprocal lattice points. The square first Brillouin zone is also shown; its irreducible part  MX has been shaded.
We shall now move on to the analysis of the square-lattice PC shown in fig. 5.5(a), composed of air
holes of radius r etched in a dielectric matrix with refractive index 3.4. We shall focus on the case of
large r (close top1a). Without Vekua’s theory, one could have doubts about the validity of the method2
for r > a.1   2/=2  0:29a, since in this case the circumscribed circle of a unit cell crosses the
inclusions from the neighbouring cells, and hence it is not clear whether a Fourier-Bessel representation
of the field near the cell corners is valid. We shall show that even for r  1a the method still produces
2
correct results, in accordance with Vekua’s assertion.
Figure 5.6 shows the juxtaposition of the band structures of the PC from fig. 5.5(a) with r = 0:49a
obtained with the present technique and with MPB. As before, a perfect visual agreement in apparent.
In turn, in fig. 5.7 we compare the convergence of the magnitude of the vector kE of a Bloch state lying
on the  M segment for the two polarisations and three values of r : 0:45a, 0:49a and 0:50a. In each
case, the frequency is fixed so as to correspond to k roughly equal to 0:25a. It can be seen that in the
p polarisation case the convergence slows down distinctly as r approaches 0:50a; this is probably related
to the occurrence of field singularities at the points of contact of neighbouring holes. Such singular fields
cannot be represented efficiently with a regular function basis. Even so, a relative accuracy of 10 4 is
attainable with a reasonable number of basis functions.
Comparison of figs. 5.3(a) and 5.7 shows that the ultimate relative error of the calculations done for
!a=2 c
126 Chapter 5. Numerical methods
0:4 (a) (b)
0:2
0:0
  X M     X M  
Figure 5.6 Comparison of the (a) p-polarisation and (b) s-polarisation band structure of the square-lattice
crystal from fig. 5.5, calculated with the method described here (points) and with the MPB library (lines).
100
(a) p pol. (b) s pol. r D 0:45a
r D 0:49a
10 5 r D 0:50a
10 10 r D 0:45a
r D 0:49a
r D 0:50a
10 15
0 50 100 150 200 0 50 100 150 200
L L
Figure 5.7 Convergence of the magnitude of the Bloch vector kE of the state located on the  M segment in
the first Brillouin zone of the square-lattice PC shown in fig. 5.5(a) for (a) p polarisation and (b) s polarisation.
The frequency was fixed to: (a) ! = 0:38  2 c=a for r = 0:45a; ! = 0:40  2 c=a for r = 0:49a; and
! = 0:47  2 c=a for r = 0:50a; (b) ! = 0:35  2 c=a for r = 0:45a; ! = 0:40  2 c=a for r = 0:49a; and
! = 0:40  2 c=a for r = 0:50a. In all these cases, k  0:25  2 =a.
the square-lattice PC is slightly larger than in the hexagonal-lattice case. This is probably caused by the
fact that the spread of the radial coordinates of the collocation points placed on a square is greater than
on a hexagon. Therefore the range of values taken by any given basis function at different collocation
points is larger in the former case, and this reduces the efficiency of the balancing algorithm.
The third example to be studied is the PC composed of a hexagonal lattice of “shamrocks”, i.e.,
patterns of three adjacent circular air holes of radius 0:2a, shown in fig. 5.8(a). The PC matrix is assumed
to be magneto-optical, with a tensorial permittivity of the form (4.31) with  = .2:5/2 and g = 0:1; these
parameters correspond roughly to those of BIG in the infrared range (see section 4.4). In this structure,
which has already been discussed briefly in section 3.4.3, both the spatial inversion symmetry and the
time-reversal symmetry of Maxwell’s equation are broken; therefore, it is nonreciprocal and its band
structure has no centre of symmetry. A particularly striking consequence of this fact is the existence
of unidirectional band gaps. Such a band gap appears, for instance, in the neighbourhood of frequency
! = 0:3915  2 c=a. Figure 5.8(b) shows the equifrequency curve at this value of !. Clearly, there
exist propagative bands at kx =  =.3a/ (close to theK points), whereas there are none at kx =   =.3a/
(close to the K 0 points). As noted in ref. 115, a slab of such a PC can be used as an isolator.?
? As a historical note, we mention that the unidirectional-mirror effect caused by the lifting of the spatial inversion symmetry,
described in ref. 115, had originally been discovered in the PC shown in fig. 5.8(a). However, it was subsequently found
that a PC composed of triples of slightly overlapping holes provides a larger unidirectional gap and would be easier to
manufacture. Such a system cannot be directly handled by the method presented here; therefore, calculations of its band
Relative error
!a=2 c
5.2. Calculation of photonic-crystal band structures with Fourier-Bessel expansions 127
(a)
(b) K
0 M K
0:50
a a
0:25 M M
r
0:00
 
K K0
 0:25
M M
 0:50
K0 M K
 0:5 0:0 0:5
a
kxa=2 
100 (c)
10 3
10 6
0 50 100 150 200
L
Figure 5.8 (a) Geometry of the PC composed of a hexagonal lattice of groups of three adjacent circular holes
etched in a magneto-optical matrix. The shaded region is the unit cell composed of four hexagonal subcells
that was used in calculations. (b) p-polarisation equifrequency curve of this crystal at ! = 0:3915  2 c=a.
(c) Convergence of the magnitude of the Bloch vector kE of the state located on the  M segment in the first
Brillouin zone of this crystal at the same frequency.
The calculations of the equifrequency curve shown in fig. 5.8(b) were made by dividing the PC’s unit
cell into four hexagonal subcells outlined in fig. 5.8(a), one of them empty. Owing to the presence of
field singularities at the cylinder junction points and the offset of the inclusion centres with respect to the
hexagon centres, which causes a wider spread of the radial coordinates of different collocation points,
only a moderate relative accuracy of10 5 was attained in simulations, as evidenced by the convergence
plot from fig. 5.8(c). For very large truncation orders (L  150) round-off error increasingly corrupts
the results.
In section 4.4 another class of PC systems was studied with the method proposed here: waveguides
embedded in the hexagonal-lattice crystal from fig. 5.2. The band structures of two such waveguides
are plotted in fig. 4.9. These calculation were done using the supercell technique, with artificial quasi-
periodic boundary conditions imposed on the segments ˙1–˙4 of the supercell shown schematically in
fig. 5.9.
structure reported in ref. 115 were performed with the MPB library [188].
Relative error
kya=2 
128 Chapter 5. Numerical methods
dw
˙3
˙2 ˙4
˙1
Figure 5.9 Geometry of the supercell used for the calculation of the waveguide dispersion relations shown in
fig. 4.9.
5.2.4 Conclusions
In this section we have presented a method of calculating band structures of 2D PCs composed of circular
cylinders by help of Fourier-Bessel expansions. Its cardinal virtue is its high efficiency: owing to the
exponential convergence of the method, it is possible to achieve a relative accuracy better than 10 10 at a
modest computational cost. Therefore the proposed technique can provide extremely accurate reference
values for the purposes of testing other numerical methods. High accuracy is also invaluable in studies
of tiny effects, such as the nonreciprocity induced by a static magnetic field at optical frequencies.
For PCs whose unit cell need not be divided into subcells, the method has an extremely simple imple-
mentation. On the other hand, if multiple subcells are present, the necessary bookkeeping can be tricky;
however, it should be possible to automatise the imposition of the appropriate boundary conditions to
a certain degree. Disadvantages of the technique in question lie primarily in its restriction to systems
containing circular inclusions and in the degradation of its accuracy for subcells whose shape deviates
markedly from that of a circle concentric with the embedded inclusion. This latter problem might pos-
sibly be alleviated with more advanced matrix-pair balancing algorithms, such as those presented in
ref. 189.
5.3 Finite-element simulations of three-dimensional axisymmetric cavities
5.3.1 Introduction
In this section we shall describe the finite-element (FE) method used to calculate the eigenmodes of open
3D axisymmetric cavities containing gyrotropic materials. This technique was used to obtain the results
presented in section 4.6.
There are two major approaches to FE simulations of axisymmetric systems [60, p. 912–913]. Early
researchers [190, 191] made use of the possibility of expressing all the components of the electromag-
netic fields EE and HE in such systems in terms of the so-called coupled azimuthal potentials E and
H , which were subsequently discretised with standard nodal FEs. However, Maxwell’s equations
written in terms of these potentials have nonphysical singularities at certain radii, whose presence affects
adversely the accuracy of calculations.
In 1993, Lee et al. [192] proposed an alternative approach to the problem of finding the eigenmodes
of a closed axisymmetric cavity. He formulated the equations in terms of the two meridional ( and z)
components of the electric fields, expanded into curl-conforming vector elements, and the electric az-
imuthal potential E , expanded into nodal elements. The boundary conditions on the z axis were not
yet treated in a sophisticated way. Therefore, the expressions for the elements of the matrices repre-
senting the discretised equations contained singular integrals, whose computation can be numerically
demanding. Later, Chinellato [193] established a solid mathematical foundation for this approach, intro-
ducing also a set of carefully crafted techniques for the calculation of the singular integrals. Combined
with a PML-based truncation of the computational domains, this method was used for the determina-
tion of the eigenmodes of open dielectric axisymmetric resonators [194]. Hiptmair and Ledger [195]
5.3. Finite-element simulations of three-dimensional axisymmetric cavities 129
extended it to FEs of arbitrary order, so-called hp FEs, which allow to obtain exponential convergence,
even if field singularities are present, by combining mesh refinement with an increase of the element
order.
In the meantime, however, it had been shown that the enforcement of the boundary conditions on
the z axis is facilitated if a particular change of variables is made so that the vector FEs are used to
expand a specific combination of the azimuthal and meridional components of EE rather than the “pure”
meridional part [196, 197]. This change of variables removes also all singular integrals. Greenwood and
Jin applied this idea to simulations of wave scattering [51] and radiation [198] by axisymmetric bodies,
using PMLs to truncate the computational domain. Finally, Venkatarayalu [52] proposed an algorithm
of elimination of unwanted static (zero-frequency) cavity eigenmodes from the FE approximation space,
which is reputed to accelerate the convergence of iterative eigenvalue solvers.
The particular variant of the axisymmetric FE method implemented during this thesis combines el-
ements of several works cited above. It is probably closest to that of Greenwood and Jin [51]: vector
FEs are used to expand a superposition of the azimuthal and meridional components of EE; exponential
Fourier expansions in the azimuthal direction are used rather than trigonometric ones; and the computa-
tional domain is truncated with PMLs. On the other hand, unlike Greenwood and Jin, we look for the
eigenmodes of the modelled system rather than its response to an incident field; thus, in a manner similar
to that of Venkatarayalu [52], we derive an eigenvalue problem rather than an inhomogeneous system of
equations. Finally, like Hiptmair and Ledger [195], we use relatively high-order FE expansions is order
to improve the efficiency of calculations. The original contribution of our work is the extension of the
method to the case of media with gyrotropic material properties. Before, it had been formulated only for
diagonal permittivity and permeability tensors, which are used to represent PMLs adapted to cylindrical
coordinates [51, 53, 54].
In the next subsection we present the derivation of our algorithm. Some issues, in particular the
manner of boundary condition enforcement on the z axis, are discussed in rather more detail than it has
been done in literature [51, 52, 196].? We hope that their pedagogical derivation here will be useful for
future researchers intending to use or program the FE method for axisymmetric structures. Subsection
5.3.3 is devoted to the numerical implementation of the proposed technique. Finally, in subsection 5.3.4
we evaluate its accuracy.
Several examples of the application of the method to the calculation of the eigenmodes of specific
cavities can be found in section 4.6.
5.3.2 Formulation
Axisymmetric systems We begin by defining precisely what we mean by an axisymmetric structure.
A system characterised by position-dependent permittivity and permeability tensors is said to be axisym-
metric if the representations of these tensors in cylindrical coordinates .; ; z/ are independent from
the azimuthal coordinate . It is instructive to check in what circumstances a tensor field whose Carte-
sian components are constant in some area of space stays independent from  when it is transformed to
cylindrical coordinates. Consider, for instance, the permittivity tensor O. Its Cartesian components are
defined by the relation 2 3 2 32 3
4Dx5 4xx xy xz54ExDy =   5yx yy yz Ey ; (5.35)
Dz zx zy zz Ez
? We have not had access to ref. 197, in which this topic is probably also considered.
130 Chapter 5. Numerical methods
where EE  .E ;E ;E /T is the electric field and DE  .D ;D ;D /Tx y z x y z the electric displacement.
Since the Cartesian components of a vector FE are related to the cylindrical ones by
2 3 2   32 34Fx5 4cos sin 0F = sin cos 054FF 5y  ; (5.36)
Fz 0 0 1 Fz
the tensor O in cylindrical coordinates will take the form
2   3 12 32 34cos sin 05 4xx xy xz54cos   sin 0O.cyl/ = sin cos 0 yx yy yz sin cos 05
20 0 1 zx zy 3zzC   2
0 0 3 1
1
= 4 xx yy xy yx 0 5 4 0 0 xz .xy   yx/  5xx C yy 0 C 0 0 yz cos
2
2 0 30 2z2z zx zy 0 3 (5.37)
4 0 0 yz xx   yy xy C yx 0C 10 0   5 sin C 4xz xy C yx  .xx   yy/ 05 cos 2
2
2zy  zx 0 30 0 0
4 1 xy C yx  .xx   yy/ 0C  . 5xx   yy/  .xy C yx/ 0 sin 2:
2
0 0 0
Obviously, in order that .cyl/ be independent of , all the terms proportional to trigonometric functions
of  in the above expression must vanish. This is the case if and only if xx = yy , xy =  yx and
xz = yz = zx = zy = 0. Thus, a permittivity tensor field having a locally constant Cartesian
representation will be independent from  after transformation to cylindrical coordinates if and only if it
has the form 2 3
t ig 0
O.Cart/ = 4 i 5g t 0 (5.38)
0 0 z
(the imaginary unit has been introduced into the off-diagonal components purely for future convenience
and for consistency with other parts of this manuscript). It is worth noting that from eq. (5.37) it follows
that in this case O.cyl/ = O.Cart/. Obviously, the above reasoning can be repeated for the permeability
tensor O .
In this way we have shown that axisymmetric systems may not contain physical? materials whose
permittivity or permeability tensors have a form other than (5.38).
Statement of the problem We seek the (leaky) eigenmodes of an open axisymmetric cavity with
the given permittivity O.; z/ and permeability O .; z/ (in the rest of this section, components of material
property tensors will be assumed to be given in cylindrical coordinates unless mentioned otherwise), ful-
filling the Sommerfeld’s boundary conditions [60, p. 294] at infinity. Since it is not possible to discretise
the whole space 3R with FEs, simulations will be done on the finite cylindrical domain
˝0  f.; ; z/j0    R and 0   < 2  and Z   z  ZCg : (5.39)
? This conclusion does not apply to “numerical” media such a PMLs, which need not have piecewise-constant Cartesian
representations of the permittivity and permeability tensors.
5.3. Finite-element simulations of three-dimensional axisymmetric cavities 131
In order to suppress spurious reflections on the boundaries of ˝0, its surface will be coated with PMLs,
treated numerically as special anisotropic media, whose nature will be specified later in this section. On
the whole surface of ˝0 perfect-electric-conductor boundary conditions will be imposed.
Wave equation We shall now demonstrate that the independence of O and O from  allows to convert
the vector wave equation for the electric field EE in ˝0 into an infinite set of decoupled equations for the
restriction of EE to a single meridional plane of ˝0.
Eliminating the magnetic field HE from the time-harmonic source-free Maxwell’s equations (1.4a)–
(1.4b), we get
rE  ŒO 1  .rE EE/ = k20O EE; (5.40)
where k0  !=c is the free-space wave number. The electric field EE can be expanded in a Fourier series
with respect to :
E XE.; ; z/ = EE .; z/ eill ; (5.41)
l2Z
so that eq. (5.40) becomes
X E   E E Xr  fŒO .; z/ 1  Œr E .; z/ eil g = k2 O.; z/ EE .; z/ eill 0 l : (5.42)
l l
In cylindrical coordinates,
rE = rE C eE  1t  @ ; where rE t  eE@ C eEz@z : (5.43)
Since all functions in eq. (5.42) depend on  only through factors eil , differentiation over  reduces to
multiplication by il . As a result, eq. (5.42) can be rewritten as
X
rE  fŒO .; z/ 
X
1  ŒrE EE .; z/g eil = k2 O.; z/ EE .; z/ eill l l 0 l ; (5.44)
l l
where
rE  rE C eE il 1l t  : (5.45)
From the linear independence of the functions eil (l 2 Z) on the interval Œ0; 2  it follows that eq. (5.44)
is equivalent to a system of decoupled equations on individual Fourier coefficients EEl.; z/:
rE  fŒO .; z/ 1  ŒrE EE .; z/g = k2l l l 0O.; z/ EEl.; z/ for each l 2 Z: (5.46)
Thus, the eigenmodes of an axisymmetric system can be classified according to their azimuthal order l
and found by solving separately each of the equations (5.46) for the field EEl.; z/ defined on the 2D
domain
˝  f.; z/j0    R and Z   z  ZCg : (5.47)
Needless to say, this brings substantial savings in computational time in comparison to the solution of
the original equation (5.40) defined on the 3D domain ˝0. The geometry of the domain ˝ is shown
schematically in fig. 5.10.
132 Chapter 5. Numerical methods
z
 1 eEn
ZC
PML
 0  1
˝
R 
PML
Z 
 1
Figure 5.10 Geometry of the domain ˝. Regions filled with PMLs are hatched.
Weak form The FE method is based on the Galerkin’s technique, itself a representative of the class of
weighted-residual methods for solving differential equations. In these methods, a generalised differential
eigenvalue problem [like the one from eq. (5.46)] of the general form A u = Bu, where A and B are
differential operators, u is the unknown function, and  is the eigenvalue, is converted into a system of
algebraic linear equations by (i) expanding u in a series of known basis functions un and (ii) requiring
that an appropriately defined inner product .vn;Ru/ of a number of test functions vn with the residual
Ru  A u   Bu vanish. In the Galerkin’s method the set of test functions is chosen to be identical
with that of basis functions [199, section 3.1].
Boundary conditions can be incorporated into the equation .vn;Ru/ = 0 using integration by parts.
This leads to the weak form of a differential equation, in which the original equation and its associated
boundary conditions are merged in a single formula.
We shall now derive the weak form of eq. (5.46). We define the inner product in the usual way,
“
.vE; uE/  vE.; z/  uE.; z/ d˝: (5.48)
˝
The condition that the inner product of an arbitrary test function vE with the residual of eq. (5.46) vanish
takes then the form (henceforth we omit the superscript l in EEl )
“ “
vE  frE  ŒO 1  .rE EE/g d˝ = k2 vE  O EEl l 0 d˝ (5.49)
˝ ˝
It can be shown that the following integration-by-parts formula is valid:
“ “ I
vE  .rE  uE/ d˝ = .rE  vE/l l  uE d˝   .vE  uE/  eEn dl I (5.50)
˝ ˝ @˝
here, vE and uE are arbitrary sufficiently regular functions, @˝ is the boundary of ˝, and eEn denotes the
unit vector normal to @˝ and directed outwards. Applying this formula to eq. (5.49), we get
“ I “
.rE  vE/ O 1  .rE EE/ d˝   fvE  ŒO 1  .rE EE/g  eE dl = k2 vE  O EEl l l n 0 d˝: (5.51)
˝ @˝ ˝
Later in this subsection we shall use the boundary conditions to dispense with the contour integral in the
above equation.
5.3. Finite-element simulations of three-dimensional axisymmetric cavities 133
Boundary conditions The contour @˝ can be divided into two parts: that lying on the z axis, denoted
henceforth  0, and the rest, denoted  1 (see fig. 5.10). The segment  1 is a subset of the surface of the
original 3D domain ˝0. Therefore the boundary condition imposed on it has already been specified to
be of the perfect-electric-conductor type. In contrast, the segment  0 does not belong to the surface
of˝0, and the boundary conditions on it have still to be determined. They will follow from the physical
requirement that the limits lim!0EE.; ; z/ and lim!0HE.; ; z/ exist and be independent from 
for all z 2 ŒZ ; ZC.
For an eigenmode of a given order l , EE.; ; z/ = EE.; z/ eil . Using eq. (5.36) and rewriting cos
and sin in terms of the exponential functions e˙i , we obtain that
E .; ; z/ = 1fŒE .; z/C iE .; z/ ei.lC1/ C ŒE .; z/   iE .; z/ ei.l 1/x     g; (5.52a)2
E .; ; z/ = 1 fŒE .; z/C iE .; z/ ei.lC1/   ŒE .; z/   iE .; z/ ei.l 1/y     g; (5.52b)2i
E .; ; z/ = E .; z/ eilz z : (5.52c)
Thus the lim8ˆits of these expressions with ! 0 exist and are independent from  only if< for l = 0; (a) E.0; z/ = 0 and (b) E.0; z/ = 0; (5.53)
:ˆ for jl j = 1; (a) E.0; z/C ilE.0; z/ = 0 and (b) Ez.0; z/ = 0; (5.54)
for jl j > 1; (a) E.0; z/ = 0; (b) E.0; z/ = 0 and (c) Ez.0; z/ = 0: (5.55)
Turning now to the magnetic field, from eq. (1.4a) we get
HE.; ; z/ = Œi! O .; z/ 10  ŒrE EE.; ; z/
O    rE  E (5.56)= Œi!0.; z/ 1 Œ l E.; z/ eil :
R8ˆˆˆeasoning analogously as in the case of the electric field, we obtain the conditions
ˆˆˆ for l = 0; (a) ŒO 1  .rE l EE/.0; z/ = 0 and (b) ŒO 1  .rE El E/.0; z/ = 0; (5.57)< for jl j = 1; (a) ŒO 1  .rE EE/ .0; z/C il ŒO 1  .rE EEl  l /.0; z/ = 0 and (5.58)
ˆˆˆˆˆ (b) ŒO 1  .rE l EE/z.0; z/ = 0;
:ˆ for jl j > 1; (a) ŒO 1  .rE EE/ .0; z/ = 0; (b) ŒO 1l   .rE l EE/.0; z/ = 0 and (5.59)
(c) ŒO 1  .rE l EE/z.0; z/ = 0:
Finite-element expansions From now on we restrict our attention to the case jl j  1. The deriva-
tions go slightly differently for modes with order l = 0, and such modes are less interesting for us, since
they do not exhibit the twofold degeneracy required in a cavity forming part of a circulator. Following
refs. 51, 196, 197 and 52, we introduce the following change of variables:
EE  eE E C eE E = .il/ 1.eE E   EE 0t   z z   t/: (5.60)
We expand the azimuthal component of EE into nodal FE basis functions u0n.; z/ (n = 1; 2; : : : ; N):
XN
E = E
0
nun; (5.61)
n=1
and the new field EE 0t, tangential to the meridional plane z, into curl-conforming vector FE basis func-
tions uE0tn.; z/ (n = 1; 2; : : : ; Nt):
E 0 XNtEt = E 0 0tnuEtn: (5.62)
n=1
134 Chapter 5. Numerical methods
The coefficients E and E 0n tn are the unknowns to be determined. The restrictions of the functions
u0 and of both components of uE0 to any element are polynomials in  and z. The functions u0n tn n are
continuous on ˝, whereas uE0tn have the property that their tangential components are continuous across
element borders; as a result, rE  uE0t tn is finite everywhere.
Gathering together eqs. (5.60)–(5.62), we obtain thus the following FE expansion of the electric
field EE, XN XNt
EE = ŒeE C .il/ 1eEE   .il/ 1EE 0t = EnuEn C E 0tnuEtn; (5.63)
n=1 n=1
in terms of the azimuthal basis functions
uE  ŒeE C .il/ 1eE u0n   n .n = 1; 2; : : : ; N/ (5.64)
and the meridional basis functions
uE   .il/ 1uE0tn tn .n = 1; 2; : : : ; Nt/: (5.65)
Imposition of boundary conditions We shall now demonstrate that the chosen form of FE ex-
pansions allows to impose conditions (5.53) and (5.57) in a simple way, as well as to remove from the
integrals in eq. (5.51) all singular weights, stemming from the presence of the term eE il 1 in definition
(5.45) of rE l . We shall assume that close to the z axis the tensor O has the gyrotropic form2 3
t ig 0
O = 4 i 5g t 0 (5.66)
0 0 z
As will be shown in section 5.3.3, this is the case even if PMLs are present.
We begin by expressing E , E and all the components of rE EE in terms of E and EE 0 z l  t. Using eq.
(5.60), after some straightforward algebra we obtain
E = .il/ 1.E   E 0  /; (5.67a)
E = .il/ 1E 0z z; (5.67b)
.rE EE/ =  @ E  E 0l  z  z; (5.67c)
.rE EE/ = .il/ 1Œ@ E CE 0   .@ E 0   @ E 0l  z  z z   z; (5.67d)
.rE EE/ = @ E CE 0l z   : (5.67e)
Owing to the regularity properties of the basis functions used to expand the fields E and EE 0 t, discussed
above, the limits of expressions (5.67) with ! 0 exist and are equal to
E .0; z/ = .il/ 1 E.0; z/; (5.68a)
Ez.0; z/ = 0; (5.68b)
.rE EE/ .0; z/ =  .@ E /.0; z/  E 0l  z  z.0; z/; (5.68c)
.rE EE/ .0; z/ = .il/ 1Œ.@ E /.0; z/CE 0l  z  z.0; z/; (5.68d)
.rE EE/ .0; z/ = .@ E /.0; z/CE 0l z   .0; z/: (5.68e)
Let us now study the cases jl j = 1 and jl j > 1 in turn.
For jl j = 1, conditions (5.54) on the electric field on the z axis are satisfied automatically: the
fulfilment of condition (5.54b) follows directly from eq. (5.68b), while that of condition (5.54a) is the
5.3. Finite-element simulations of three-dimensional axisymmetric cavities 135
consequence of eq. (5.68a) and the observation that l = l 1 if jl j = 1. The satisfaction of condition
(5.58a) also follows from eqs. (5.68c) and (5.68d), as can be verified by hand (the assumption that O is
gyrotropic on the z axis is crucial here). In contrast, condition (5.58b) is not met automatically, and it
will need to be imposed weakly by help of the contour-integral term in eq. (5.51), as will be demonstrated
below.
For jl j > 1, only condition (5.55c) is automatically fulfilled, by virtue of eq. (5.68b). To satisfy
conditions (5.55a), (5.55b), (5.59a) and (5.55b), homogeneous Dirichlet boundary conditions on E and
E 0z on  0 must explicitly be imposed by removing from the series (5.63) the functions uEn and uEtn
whose  or z components are nonzero on  0. As in the case jl j = 1, the remaining condition (5.59c) will
be imposed weakly.
For all values of l , of course, the perfect-electric-conductor boundary conditions eEn  EE = 0 on  1
must also be imposed; this can be done in the manner described in the previous paragraph, by removing
appropriate terms from expansion (5.63).
We are now ready to tackle the contour integral from eq. (5.51). The integration path @˝ is the sum
of  0 and  1; let us consider first the latter part of this contour. From the identity .aE  bE/  cE = .cEaE/  bE,
where aE, bE and cE are arbitrary vectors, we get
Z Z
fvE  ŒO 1  .rE EEl /g  eEn dl = .vE  eE n/  O 1  .rE l EE/ dl: (5.69)
 1  1
But since in the Galerkin’s method the set of test functions is identical with that of basis functions and,
as we have said above, the latter will be chosen so as to fulfil the perfect-electric-conductor boundary
conditions on  1, the cross product vE  eEn will vanish on  1 and this part of the integration path will
bring no contribution to the integral. Integration over  0 is more interesting. Using the aforementioned
identity one more time, we convert the integral to the form
Z Z
fvE  ŒO 1  .rE l EE/g  eEn dl = vE  fŒO 1  .rE El E/  eEng dl: (5.70)
 0  0
Since on  0 the unit vector eEn =  eE,
Z Z Z
fvE ŒO 1  .rE l EE/g  eEn dl =   ŒO 1  .rE l EE/ zv dlC ŒO 1  .rE El E/ vz dl: (5.71)
 0  0  0
By conditions (5.58b) and (5.59c), for all l  1 the z component of O 1  .rE l EE/ should vanish on  0;
hence, the first term on the right-hand side of eq. (5.71) will approach zero as the FE approximation of a
given cavity eigenmode tends to the true solution. Therefore, we shall omit this term from the discretised
equation (5.51). On the other hand, the second term will vanish because, as we have said above, the
chosen FE expansions satisfy automatically the condition that Ez = 0 on  0 [conditions (5.54b) and
(5.55c)]; hence, vz will disappear on this part of the integration contour.
In this way we have shown that the contour integral can be dropped from the weak form (5.51) of the
vector wave equation of an axisymmetric system. We arrive thus at the final form of this equation:
“ “
.rE  vE/  O 1  .rE EE/ d˝ = k2 vEl l 0  O EE d˝: (5.72)
˝ ˝
Conversion into algebraic eigenvalue problem In order to convert eq. (5.72) into a system of
algebraic equations, we write it separately for each test function vE = uEn (n = 1; 2; : : : ; N) and vE = uEtn
136 Chapter 5. Numerical methods
(n = 1; 2; : : : ; Nt), substituting for EE expansion (5.63). We assume the cylindrical representation of the
permittivity tensor to have the form 2 3
 ig 0
O = 4 i 5g  0 ; (5.73)
0 0 z
and the permeability tensor to be diagonal, 2 3
 0 0
O = 4 0  5 0 ; (5.74)
0 0 z
with the additional constraint that  =  close to the z axis, which is necessary for the boundary con-
ditions on that axis to be met.? The reader will certainly have noted that we have let the tensors O and O
take a more general form than the gyrotropic one from eq. (5.38). This is because we allow for the pres-
ence of PMLs, whose material properties need not have a piecewise-constant Cartesian representation.
After some algebra, we obta"in the following generalised eigenvalueO O #" E # " O O #
p"roble#m:
A At E E 2 B Bt E
O O NE 0 = k0 O O NE 0 ; (5.75)At Att EN Bt t Btt EN t
where EE and EE 0 denote the column vectors of coefficients E and E 0 t n tn, respectively (the underbars
have beNen addedNto distinguish these symbols from those denoting components ofEE), whereas the entries
of matrices AO O˛ˇ“and B˛ˇ (˛; ˇ = ; t) are given by
.AO / = . 1@ u0 @ u0 C  1@ u0 @ u0 C l 2 1@ u0 @ u0 mn   z z z z /  d dz; (5.76a)
“ z m n  m n  m n˝
.AO / = f 1@ u0 u0 C  1@ u0 u0t mn z  m n  z m zn
˝
C l 2 1@ u0 Œu0   .rE  uE0 z m zn t tn/zg  d dz; (5.76b)
.AOt/mn =“.AOt/nm; (5.76c)
.AO / = f 1u0 u0 C  1u0 u0tt mn z m n  zm zn
˝
“C l 2 1 0 E 0 0 E 0 Œuzm   .rt  uEtm/zŒuzn   .rt  uEtn/zg  d dz; (5.76d)
.BO / = Œ.l 2   2l 1 mn  g C /u0 u0   d dz; (5.76e)
“ m n˝
.BO / = Œ. l 2 C l 1 /u0 u0  2t mn  g m n d dz; (5.76f)
˝
.BOt/mn = .“BOt/nm; (5.76g)
.BO / = l 2. u0 u0 C  u0 u0 / 3tt mn  m n z zm zn d dz: (5.76h)
˝
In these formulas u0 and u0 denote the  and z components of the basis function uE0n zn tn. It has been
assumed that all the functions u0 and uE0n tn are real-valued.
? It is equally possible to handle the slightly more general case with  =   ¤ 0, at the cost of more complicated
formulas.
5.3. Finite-element simulations of three-dimensional axisymmetric cavities 137
5.3.3 Numerical implementation
Software We have implemented the method presented in the previous subsection using the Hermes
C++ library [55, 56], which significantly facilitates the development of FE-method-based codes. First,
it provides ready-made implementations of commonly used classes of FEs, including standard nodal
FEs and vector curl-conforming FEs, up to the polynomial order 10. Both triangular and quadrilateral,
recti- and curvilinear elements are available. Second, the library completely automatises the matrix
assembly, allowing also to impose Dirichlet and Neumann boundary conditions on selected portions
of the computational domain’s boundary. In principle, a user of Hermes needs only to write functions
calculating the integrals occurring in the weak form of the differential equation at hand and to specify
the geometry of the computational domain along with the boundary conditions.
Meshing A characteristic feature of axisymmetric cavities produced by etching multilayer structures
is that the material interfaces in any meridional plane are almost always parallel to the  or z axis. This
is the case with all the structures studied in section 4.6. Therefore we have meshed the domain ˝ with
rectangular FEs with sides parallel to eE and eEz . The process of mesh generation for a typical cavity goes
as follows. In the first step,˝ is divided into as many conforming elements as are necessary to ensure that
each interface between two different materials coincides with an interelemental boundary. The elements
created in this way are subsequently subdivided into smaller ones with side lengths approximately equal
to a predefined constant hideal. If desired, the resulting mesh is further uniformly refined by splitting
each element into quarters. This step can be repeated as many times as necessary.
FE expansions The unknown fields E and EE 0 t are expanded into hierarchical polynomial bases pro-
vided by Hermes. The expansion order p, defined as the maximum degree of the polynomials included
in these expansions, is taken to be the same in all elements.
Quadratures All the matrix entries (5.76) are calculated with Gauss-Legendre quadratures. In ele-
ments containing materials with constant O and O , we employ quadratures of the minimum order neces-
sary to ensure their exactness (for the given expansion order p). In elements containing PMLs, whose
material properties depend on the position in a non-polynomial way (see below), the quadrature order is
chosen as greater by ten than that which would ensure exact integration for constant O and O .
Eigenvalue problem solving To solve the complex sparse non-symmetric generalised eigenvalue
problem (5.75), we have used the Krylov-Schur iterative sparse eigenvalue solver implemented in the
SLEPc library [57–59]. Hermes provides interfaces to several popular sparse linear equation solvers;
unfortunately, at present it does not offer integration with any eigenvalue solvers. Therefore we have
written a custom interface between Hermes and SLEPc.
The vector wave equation (5.40) incorporates Gauss’s law rE .O EE/ = 0, but only if k0 ¤ 0 [200]. As
a result, eq. (5.75), derived from (5.40), possesses a large cluster of spurious static solutions that do not
obey Gauss’s law. Therefore even if the lowest-frequency eigenmodes of a given cavity are desired, they
cannot be found by using an iterative eigenvalue solver to find a few lowest-magnitude eigenvalues of
(5.75). Rather, a shift-and-invert transformation of (5.75) must be used to bring the part of its spectrum
closest to a prescribed shift  into the neighbourhood of zero, so that the eigenmodes belonging to this
part of the spectrum may be found by the iterative algorithm [59]. Such spectral transformations are
handled transparently by SLEPc.
It is possible to modify the bases used for field expansions so as to eliminate altogether the spuri-
ous static solutions [201]. Another possibility consists in modifying an iterative eigenvalue solver so
as to prevent it from converging to a solution violating Gauss’s law. This technique has recently been
demonstrated by Venkatarayalu [52]. Although these approaches probably improve the efficiency of
138 Chapter 5. Numerical methods
z
 1
ZC
PML dPML
 0 dsup  1
dsep dPML
R
d sub
PML dPML
Z 
 1
Figure 5.11 Geometry of an example domain ˝. Darker regions have larger permittivity. PMLs are hatched.
calculations—in particular, a sparse matrix inversion required by a shift-and-invert transformation is
avoided—their implementation is quite non-trivial. We have therefore stuck to shift-and-invert transfor-
mations, which we found to work very reliably.
Perfectly matched layers As mentioned in the previous subsection, to suppress spurious reflections
due to the finite size of the computational domain, the boundary  1 is coated from inside by PMLs
of thickness dPML, as shown in fig. 5.11. We use standard PMLs adapted for cylindrical coordinates,
which can be interpreted as anisotropic materials with diagonal permittivity tensors O = O and O = O,
where  and  are the material parameters of the “real” media adjacent to PMLs and the diagonal tensor
O  diag.;  ; z/ is responsible for the absorbing properties of the PML. Its elements are given by
[51, 54]
 SzQ  SzS ;  Q and z 
SQ
; (5.77)
S  Sz
where       2
S./  1C  .R dPML/isPML U ; (5.78a)
  dPMLC   2        C .Z  dPML/ z z .ZC d / 2PMLSz.z/ 1 isPML U C isPML U ; (5.78b)
dPML dPML
ŒU.   .R   d //3
Q PML./  C isPML (5.78c)
3d2
PML
and U.x/ is x if x > 0 and zero otherwise. The real parameter sPML is called the PML strength. It is
worth noting that for   R   dPML we have S./ = Q./ = 1; hence,  =  = Sz , in accord with
our earlier assumption that the tensor O should be gyrotropic close to the z axis.
5.3.4 Evaluation of accuracy
The accuracy of calculations made with the proposed technique is affected by a number of factors, which
can be divided into two groups. The first of them includes the parameters of the FE expansion itself:
 typical element size h,
 expansion order p.
5.3. Finite-element simulations of three-dimensional axisymmetric cavities 139
# rin (nm) rout (nm) # rin (nm) rout (nm)
1 1236 1443 11 4618 4765
2 1656 1828 12 4933 5079
3 2019 2181 13 5246 5392
4 2363 2519 14 5559 5705
5 2696 2849 15 5872 6017
6 3023 3174 16 6184 6329
7 3346 3496 17 6495 6640
8 3667 3816 18 6806 6951
9 3986 4134 19 7117 7262
10 4303 4450 20 7428 7572
Table 5.1 Radii of the high-index rings of the G4-type cavity used to test the accuracy of calculations. The
symbols rin and rout denote the inner and outer radius of a ring, respectively.
nref p C  
0 1 1:25199C 0:00612i 1:25194C 0:00610i
0 2 1:24329C 0:00367i 1:24022C 0:00419i
0 3 1:25691C 0:00340i 1:25384C 0:00387i
0 4 1:26034C 0:00333i 1:25728C 0:00379i
1 1 1:25900C 0:00362i 1:25597C 0:00411i
1 2 1:26133C 0:00333i 1:25827C 0:00378i
1 3 1:26148C 0:00331i 1:25842C 0:00376i
2 1 1:26145C 0:00331i 1:25839C 0:00376i
2 2 1:26149C 0:00331i 1:25843C 0:00376i
Table 5.2 Influence of the number of mesh refinements, nref, and the expansion order p on the calculated values
of the wavelengths ˙ of the counter-rotating modes of the cavity described in the text. The remaining parameters
were chosen as dsub = dsup = 600 nm, dsep = dPML = 500 nm and sPML = 6.
The second is formed by the domain truncation parameters:
 substrate thickness dsub,
 superstrate thickness dsup,
 distance from the outermost inhomogeneity in the multilayer to the inner boundary of the radial
PML, dsep,
 PML thickness, dPML,
 PML strength, sPML.
In fig. 5.11 graphical definitions of the first four items from the above list are shown.
To determine the values of the above parameters required to get a reasonable accuracy, we have
studied the influence of their variation of the calculated values of the wavelengths C and   of the
modes with azimuthal order l = 10 and  10 of a particular G4-type cavity (see section 4.6) containing
20 high-index rings, whose radii are listed in table 5.1.
We began by testing the dependence of ˙ on h and p. The former was varied as follows: first, in the
way described in subsection 5.3.3, we generated an initial mesh composed of rectangular elements with
side lengths roughly equal to hideal = 150 nm, and subsequently we refined it uniformly nref times. Table
5.2 lists the values of ˙ obtained for a number of combinations .nref; p/; the values of the remaining
parameters are specified in the caption of that table. Clearly, at least one level of refinement is necessary
to get accurate results. This is probably related to the occurrence of field singularities at the edges of
140 Chapter 5. Numerical methods
nsub = nsup C  
0:1 1:26135C 0:00311i 1:25831C 0:00354i
0:2 1:26146C 0:00319i 1:25842C 0:00364i
0:3 1:26150C 0:00325i 1:25845C 0:00370i
0:4 1:26150C 0:00329i 1:25845C 0:00374i
0:5 1:26150C 0:00330i 1:25844C 0:00376i
0:6 1:26149C 0:00331i 1:25843C 0:00376i
0:7 1:26148C 0:00331i 1:25843C 0:00376i
0:8 1:26148C 0:00331i 1:25843C 0:00376i
0:9 1:26148C 0:00331i 1:25842C 0:00376i
1:0 1:26148C 0:00331i 1:25842C 0:00376i
Table 5.3 Influence of the substrate and superstrate thicknesses, dsub and dsup (taken equal to each other) on
the calculated values of the wavelengths ˙ of the counter-rotating modes of the cavity described in the text. The
remaining parameters were chosen as nref = 1, p = 3, dsep = dPML = 500 nm and sPML = 6.
rings; these singularities can be clearly seen on plots of the meridional components ofEE. It is well known
[202, section 3.3] that the convergence of a FE expansion can be accelerated by an additional refinement
of the elements at whose corners singularities occur.
In any case, the data in table 5.2 show that the wavelengths obtained for .nref; p/ = .1; 3/, .2; 1/
and .2; 2/ differ only with the sixth significant digit. Therefore, one can expect them to have absolute
accuracy of at least 0.1 nm. This is enough for the purposes of the evaluation of the wavelength splitting
  C     between the counter-rotating modes, which is typically on the level on 2–3 nm. For the
remaining calculations we fixed nref = 1 and p = 3.
We studied next the sensitivity of ˙ to the changes of dsub and dsup, for simplicity taking them
to be equal. The results, listed in table 5.3, indicate that the influence of these parameters is negligible
(˙ does not change by more than 0.03 nm) as soon as they are chosen larger than 100 nm. We decided
therefore to stay with the originally assigned values, dsub = dsup = 600 nm. We have also calculated ˙
as a function of dsep ranging from 100 nm to 800 nm, and found all the obtained values to be identical to
six significant digits. In future calculations we continue to take dsep = 500 nm.
Lastly, we evaluated the dependence of ˙ on the PML parameters, dPML and sPML. We made two
series of calculations, in which the PML strength was fixed to 6 and 12, respectively, while its thickness
was varied from 100 to 800 nm. The results are given in table 5.4. Clearly, for both PML strengths the
wavelengths ˙ converge quickly to practically the same values (˙0:01 nm).
To sum up, the parameters related to the truncation of ˝ have been found to affect little the results
of calculations. Thus, one can be reasonably confident that the data presented in section 4.6, which were
obtained with nref = 1, p = 3, dsub = dsup = 600 nm, dsep = dPML = 500 nm and sPML = 6, are
accurate to about˙0:05 nm, which corresponds to a relative error of 4  10 5.
5.3. Finite-element simulations of three-dimensional axisymmetric cavities 141
sPML = 6 sPML = 12
dPML C   C  
0:1 1:25945C 0:00388i 1:25617C 0:00423i 1:26114C 0:00439i 1:25796C 0:00488i
0:2 1:26107C 0:00385i 1:25793C 0:00430i 1:26163C 0:00331i 1:25858C 0:00378i
0:3 1:26148C 0:00350i 1:25841C 0:00396i 1:26147C 0:00330i 1:25842C 0:00375i
0:4 1:26151C 0:00334i 1:25845C 0:00380i 1:26148C 0:00330i 1:25842C 0:00376i
0:5 1:26149C 0:00331i 1:25843C 0:00376i 1:26148C 0:00331i 1:25842C 0:00376i
0:6 1:26148C 0:00331i 1:25843C 0:00376i 1:26148C 0:00331i 1:25842C 0:00376i
0:7 1:26148C 0:00331i 1:25843C 0:00376i 1:26148C 0:00331i 1:25843C 0:00376i
0:8 1:26148C 0:00331i 1:25842C 0:00376i 1:26148C 0:00331i 1:25843C 0:00376i
Table 5.4 Influence of the PML thickness dPML and PML strength sPML on the calculated values of the wave-
lengths ˙ of the counter-rotating modes of the cavity described in the text. The remaining parameters were chosen
as nref = 1, p = 3, dsub = dsup = 600 nm and dsep = 500 nm.

Chapter 6
Conclusions and perspectives
The work whose results have been presented in this thesis encompasses a fairly wide range of topics,
concerning mostly, but not exclusively, those related to PCs. Here we attempt to summarise these results,
putting them in perspective, highlighting those we find the most important, and offering some ideas on
future work.
In chapter 2, the most theoretical one in this thesis, we formulated an effective-medium model of
2D PCs. Using this model, we conducted an in-depth study of the validity of the effective-medium
description of PCs exhibiting the negative-refraction effect. We believe this to have been the first analysis
encompassing both the propagative and the evanescent region and not limited to at most a few discrete
incidence angles. We think we provided convincing arguments that the effective-medium approximation
of PCs with negative refraction is too simplistic and, therefore, such PCs cannot be used as a drop-in
replacement of homogeneous negative-index media.
The rest of the manuscript was more device-oriented. In chapter 3 we presented an algorithm for the
design of AR gratings for PCs and showed its applicability to certain specific PC components. At the
same time, we strived to be explicit about its limitations, which stem from its reliance on a number of
approximations.
It needs to be stressed that the possibilities offered by the numerical shape optimisation procedure,
which is the last step of the proposed algorithm, have not been exploited in full in the examples presented
in section 3.4. For instance, in the case of a flat lens, it is not sufficient that the device pass (almost) all
the incident energy; creation of a high-quality image requires also that the waves incident at different
angles arrive on the image plane with appropriate phases. Thus, it might be more judicious to formulate
the objective function (to be minimised) in terms of the amplitudes and phases of the transmitted waves
rather than the reflected ones. This would also allow to optimise the transmission of the evanescent
waves, and hence, possibly, to overcome the diffraction limit.
In chapter 4 we reported on our work on magneto-optical circulators. The crucial step was the
idea of studying closely the class of resonant cavities having the rotational symmetry. It led to the
formulation of a novel design principle for uniformly magnetised, and therefore manufacturable, cavities
that nonetheless exhibit a substantial mode frequency splitting. We then initially pursued the beaten
path of PC-based circulator designs. It was M. Vanwolleghem (Institut d’Electronique Fondamentale,
Orsay, France) who first suggested testing simpler systems based on uniform waveguides. Despite initial
problems with securing a sufficient degree of coupling between such waveguides and the central cavity (it
was not possible to use side-coupling owing to an extreme phase mismatch between the waveguide and
cavity modes), we finally succeeded by employing butt-coupling instead of side-coupling and optimising
the shape of the waveguide slot.
As we have remarked in section 4.5.4, the circulator designed on the basis of 2D calculations did
not fare well in experiment owing to excessive out-of-plane losses. In March 2010 it was therefore
deemed necessary to turn to 3D simulations. Good progress has already been made; in particular, at
143
144 Chapter 6. Conclusions and perspectives
the end of section 4.6.2 we presented a 3D cavity with markedly reduced radiation losses. To arrive at
an experimental demonstration of a working circulator, however, further work is still necessary. The
optimisation should be repeated using the exact value of the refractive index of the potential coating
material, silicon nitride. More importantly, we do not understand yet the mechanism for the improvement
of the mode confinement provided by the optimised cavity. A Bloch-mode-based theory might be able
to explain this effect. We also hope that it will lead to successful designs—no longer based on the
effective-index approximation—of uncoated cavities, which should have smaller footprint than coated
ones, thanks to stronger in-plane mode localisation.
Even if a satisfactory 3D model of axisymmetric cavities is established in future, some numerical
optimisation of their geometry may still be necessary, or at least desirable. It is well known that gradient-
based optimisation techniques are in general more efficient than derivative-free methods, such as the
NEWUOA algorithm used thus far. It should be quite possible to calculate the derivative of the frequency
splitting ! of a given cavity over the radius of any particular ring, symbolically denoted r here. The
derivative of the eigenvalue k20 of the problem eq. (5.75) over r is simple to calculate, at least assuming
that there are no repeated eigenvalues:
2 @k @AO @BO 0 = yE    k20  xE; (6.1)@r @r @r
where xE and yE are the right and left eigenvectors corresponding to k2 and normalised so that yE0 BO xE = 1.
(See refs. 203 and 204 for a review on the computation of eigenvalue derivatives.) The derivatives of AO
and BO over r can be evaluated from the explicit formulas (5.76) for their entries.
An optimised cavity will eventually need to be integrated with the input and output waveguides.
Which numerical method will be most suitable for the simulation of the complete 3D system is not clear
yet; some views on this matter have been offered in the conclusions to chapter 4.
Finally, as noted in section 4.1.3, Yu et al. [155] have recently proposed theoretically an isolator based
on time-dependent refractive-index modulation. In the structure presented in their article, introduction of
a boundary separating the modulated and unmodulated parts of the waveguides is needed; this requires
a precise alignment of the electric field enforcing the modification of the refractive index. It might be
possible to employ the ideas developed in chapter 4, and in particular the design rule from section 4.3, to
dispense with the necessity of introducing domains free from the modulating field.
Bibliography
[1] R. Nagarajan, C. Joyner, J. Schneider, R.P., J. Bostak, T. Butrie, A. Dentai, V. Dominic, P. Evans,
M. Kato, M. Kauffman, et al., J. Sel. Top. Quant. Electron. 11, 50 (2005).
[2] R. Nagarajan, M. Kato, J. Pleumeekers, P. Evans, D. Lambert, A. Chen, V. Dominic, A. Mathur,
P. Chavarkar, M. Missey, et al., J. Opt. Netw. 6, 102 (2007).
[3] S. C. Nicholes, M. L. Mašanovic´, B. Jevremovic´, E. Lively, L. A. Coldren, and D. J. Blumenthal,
J. Lightwave Technol. 28, 641 (2010).
[4] Infinera’s 400 Gb/s PIC sets new record for integration, http://www.infinera.com/j7/servlet/
NewsItem?newsItemID=150.
[5] W. A. Harrison, Solid state theory (Dover, New York, 1980).
[6] E. Ozbay, Science 311, 189 (2006).
[7] R. G. Hunsperger, Integrated optics: theory and technology (Springer, New York, 2009).
[8] E. Yablonovitch, Phys. Rev. Lett. 58, 2059 (1987).
[9] S. John, Phys. Rev. Lett. 58, 2486 (1987).
[10] R. D. Meade, A. Devenyi, J. D. Joannopoulos, O. L. Alerhand, D. A. Smith, and K. Kash, J. Appl.
Phys. 75, 4753 (1994).
[11] A. Mekis, J. C. Chen, I. Kurland, S. Fan, P. R. Villeneuve, and J. D. Joannopoulos, Phys. Rev.
Lett. 77, 3787 (1996).
[12] K. Busch, G. von Freymann, S. Linden, S. Mingaleev, L. Tkeshelashvili, and M. Wegener, Phys.
Rep. 444, 101 (2007).
[13] B. Gralak, S. Enoch, and G. Tayeb, in Metamaterials: physics and engineering explorations,
edited by N. Engheta and R. W. Ziolkowski (Wiley, New York, 2006), chap. 10, pp. 261–283.
[14] B. Gralak, S. Enoch, and G. Tayeb, J. Opt. Soc. Am. A 17, 1012 (2000).
[15] H. Kosaka, T. Kawashima, A. Tomita, M. Notomi, T. Tamamura, T. Sato, and S. Kawakami, Appl.
Phys. Lett. 74, 1212 (1999).
[16] H. Kosaka, T. Kawashima, A. Tomita, M. Notomi, T. Tamamura, T. Sato, and S. Kawakami, Phys.
Rev. B 58, R10096 (1998).
[17] J. B. Pendry, Phys. Rev. Lett. 85, 3966 (2000).
145
146 BIBLIOGRAPHY
[18] N. Fabre, L. Lalouat, B. Cluzel, X. Mélique, D. Lippens, F. de Fornel, and O. Vanbésien, Phys.
Rev. Lett. 101, 073901 (2008).
[19] J. Amet, F. I. Baida, G. W. Burr, and M. Bernal, Photonics Nanostruct. Fundam. Appl. 6, 47
(2008).
[20] V. G. Veselago, Sov. Phys. Usp. 10, 509 (1968).
[21] T. Decoopman, G. Tayeb, S. Enoch, D. Maystre, and B. Gralak, Phys. Rev. Lett. 97, 073905
(2006).
[22] J. Ushida, M. Tokushima, M. Shirane, A. Gomyo, and H. Yamada, Phys. Rev. B 68, 155115
(2003).
[23] A. Efros and A. Pokrovsky, Solid State Commun. 129, 643 (2004).
[24] R. Biswas, Z. Y. Li, and K. M. Ho, Appl. Phys. Lett. 84, 1254 (2004).
[25] B. Momeni, A. Asghar Eftekhar, and A. Adibi, Opt. Lett. 32, 778 (2007).
[26] Z. Lu and D. W. Prather, Opt. Express 15, 8340 (2007).
[27] R. Pierre and B. Gralak, J. Mod. Opt. 55, 1759 (2008).
[28] B. Momeni, M. Badieirostami, and A. Adibi, J. Opt. Soc. Am. B 24, 2957 (2007).
[29] Y. Wu, J. Li, Z.-Q. Zhang, and C. T. Chan, Phys. Rev. B 74, 085111 (2006).
[30] V. Yannopapas and A. Moroz, J. Phys. Cond. Mat. 17, 3717 (2005).
[31] V. Yannopapas and N. V. Vitanov, Phys. Rev. B 74, 193304 (2006).
[32] V. Yannopapas, Phys. Rev. B 75, 035112 (2007).
[33] G. Scherrer, M. Hofman, W. S´migaj, B. Gralak, X. Melique, O. Vanbésien, D. Lippens, C. Dumas,
B. Cluzel, and F. de Fornel, Appl. Phys. Lett. 97, 071119 (2010).
[34] Z. Wang and S. Fan, Appl. Phys. B 81, 369 (2005).
[35] H. Dötsch, N. Bahlmann, O. Zhuromskyy, M. Hammer, L. Wilkens, R. Gerhardt, P. Hertel, and
A. F. Popkov, J. Opt. Soc. Am. B 22, 240 (2005).
[36] D. R. Goff, Fiber optic reference guide (Focal Press, Amsterdam, 2002).
[37] Z. Wang and S. Fan, Opt. Lett. 30, 1989 (2005).
[38] D. Felbacq, G. Tayeb, and D. Maystre, J. Opt. Soc. Am. A 11, 2526 (1994).
[39] G. Tayeb and D. Maystre, J. Opt. Soc. Am. A 14, 3323 (1997).
[40] D. Maystre, S. Enoch, and G. Tayeb, in Electromagnetic theory and applications for photonic
crystals, edited by K. Yasumoto (CRC Press, Boca Raton, 2005), chap. 1.
[41] N. Stefanou, V. Karathanos, and A. Modinos, J. Phys. Cond. Mat. 4, 7389 (1992).
[42] N. Stefanou, V. Yannopapas, and A. Modinos, Comp. Phys. Commun. 113, 49 (1998).
BIBLIOGRAPHY 147
[43] N. Stefanou, V. Yannopapas, and A. Modinos, Comp. Phys. Commun. 132, 189 (2000).
[44] N. A. Nicorovici, R. C. McPhedran, and L. C. Botten, Phys. Rev. E 52, 1135 (1995).
[45] S. K. Chin, N. A. Nicorovici, and R. C. McPhedran, Phys. Rev. E 49, 4590 (1994).
[46] K. Ohtaka and Y. Tanabe, J. Phys. Soc. Jpn. 65, 2265 (1996).
[47] A. Moroz, Phys. Rev. B 51, 2068 (1995).
[48] R. Pierre, Ph.D. thesis, Institut Fresnel, Marseille (2008).
[49] J. Yuan and Y. Y. Lu, J. Opt. Soc. Am. A 23, 3217 (2006).
[50] Y. Huang and Y. Y. Lu, J. Lightwave Technol. 24, 3448 (2006).
[51] A. D. Greenwood and J. Jin, IEEE Trans. Antennas Propag. 47, 620 (1999).
[52] N. V. Venkatarayalu, Int. J. Numer. Model. 23, 231 (2010), ISSN 0894-3370.
[53] J. Jin, The finite element method in electromagnetics (Wiley, New York, 2002).
[54] F. Teixeira and W. Chew, IEEE Microw. Guided Wave Lett. 7, 371 (1997), ISSN 1051-8207.
[55] Hermes – higher-order modular finite element system (user’s guide), http://hpfem.org (2010).
[56] P. Solin, Partial differential equations and the finite element method (Wiley, 2005).
[57] V. Hernandez, J. E. Roman, and V. Vidal, ACM Trans. Math. Software 31, 351 (2005).
[58] V. Hernandez, J. E. Roman, E. Romero, A. Tomas, and V. Vidal, http://www.grycap.upv.es/slepc
(2009).
[59] V. Hernandez, J. E. Roman, E. Romero, A. Tomas, and V. Vidal, SLEPc Users Manual (2009).
[60] J. G. Van Bladel, Electromagnetic fields (Wiley, 2007).
[61] J. D. Jackson, Classical electrodynamics (Wiley, New York, 1998).
[62] W. S´migaj and B. Gralak, Phys. Rev. B 77, 235445 (2008).
[63] W. S´migaj and B. Gralak, Proc. SPIE 6987, 698726 (2008).
[64] C. Giacovazzo, ed., Fundamentals of crystallography (Oxford University Press, Oxford, 1992).
[65] C. G. Someda, Electromagnetic waves (Chapman & Hall, London, 1998).
[66] S. Boscolo, C. Conti, M. Midrio, and C. G. Someda, J. Lightwave Technol. 20, 304 (2002).
[67] P. Kuchment, Floquet theory for partial differential equations (Birkhäuser Verlag, Basel, 1993).
[68] R. Petit, in Electromagnetic theory of gratings, edited by R. Petit (Springer, Berlin, 1980), chap. 1,
pp. 1–52.
[69] M. Nevière and E. Popov, Light propagation in periodic media. Differential theory and design
(Marcel Dekker, New York, 2002).
[70] Z.-Y. Li and K.-M. Ho, Phys. Rev. B 68, 155101 (2003).
148 BIBLIOGRAPHY
[71] L. C. Botten, T. P. White, A. A. Asatryan, T. N. Langtry, C. M. de Sterke, and R. C. McPhedran,
Phys. Rev. E 70, 056606 (2004).
[72] E. Istrate, A. A. Green, and E. H. Sargent, Phys. Rev. B 71, 195122 (2005).
[73] L. Li, J. Opt. Soc. Am. A 13, 1024 (1996).
[74] P. Vincent, in Electromagnetic theory of gratings, edited by R. Petit (Springer, Berlin, 1980),
chap. 4, pp. 101–122.
[75] E. Popov and B. Bozhkov, Appl. Opt. 39, 4926 (2000).
[76] W. S´migaj, Master’s thesis, Faculty of Physics, Adam Mickiewicz University in Poznan´ (2007).
[77] M. Plihal and A. A. Maradudin, Phys. Rev. B 44, 8565 (1991).
[78] J. F. Cornwell, Group theory and electronic energy bands in solids (North-Holland, Amsterdam,
1969).
[79] K. Sakoda, Optical properties of photonic crystals (Springer, Berlin, 2001).
[80] M. Tinkham, Group theory and quantum mechanics (McGraw-Hill, New York, 1964).
[81] Y.-C. Chang, Phys. Rev. B 25, 605 (1982).
[82] T. Koschny, P. Markoš, D. R. Smith, and C. M. Soukoulis, Phys. Rev. E 68, 065602(R) (2003).
[83] D. Seetharamdoo, R. Sauleau, K. Mahdjoubi, and A.-C. Tarot, J. Appl. Phys. 98, 3505 (2005).
[84] T. Koschny, P. Markoš, E. N. Economou, D. R. Smith, D. C. Vier, and C. M. Soukoulis, Phys.
Rev. B 71, 245105 (2005).
[85] R. Liu, T. J. Cui, D. Huang, B. Zhao, and D. R. Smith, Phys. Rev. E 76, 026606 (2007).
[86] K. F. Riley, M. P. Hobson, and S. J. Bence, Mathematical Methods for Physics and Engineering
(Cambridge University Press, Cambridge, 2006).
[87] J. A. Dobrowolski, D. Poitras, P. Ma, H. Vakil, and M. Acree, Appl. Opt. 41, 3075 (2002).
[88] E. B. Grann and M. G. Moharam, J. Opt. Soc. Am. A 13, 988 (1996).
[89] H. A. Macleod, Thin-film optical filters (Institute of Physics, Bristol, 2001).
[90] S. J. Orfanidis, Electromagnetic waves and antennas, http://www.ece.rutgers.edu/~orfanidi/ewa
(2008).
[91] D. H. Raguin and G. M. Morris, Appl. Opt. 32, 1154 (1993).
[92] D. H. Raguin and G. M. Morris, Appl. Opt. 32, 2582 (1993).
[93] R. Bräuer and O. Bryngdahl, Appl. Opt. 33, 7875 (1994).
[94] H. Kikuta, H. Toyota, and W. Yu, Opt. Rev. 10, 63 (2003).
[95] S. Xiao, M. Qiu, Z. Ruan, and S. He, Appl. Phys. Lett. 85, 4269 (2004).
[96] L. C. Botten, T. P. White, C. M. de Sterke, and R. C. McPhedran, Phys. Rev. E 74, 026603 (2006).
BIBLIOGRAPHY 149
[97] Z. Li, E. Ozbay, H. Chen, J. Chen, F. Yang, and H. Zheng, J. Phys. D 40, 5873 (2007).
[98] S.-G. Lee, J.-S. Choi, J.-E. Kim, H.-Y. Park, and C.-S. Kee, Opt. Express 16, 4270 (2008).
[99] J.-M. Park, S.-G. Lee, H. Y. Park, J.-E. Kim, and M.-H. Lee, J. Opt. Soc. Am. B 26, 1967 (2009).
[100] Y. Jin and S. He, Phys. Lett. A 360, 461 (2007).
[101] B. Zhang and M. Y. Li, Eur. Phys. J. D 45, 321 (2007).
[102] T. Baba and D. Ohsaki, Jpn. J. Appl. Phys. 40, 5920 (2001).
[103] T. Baba, T. Matsumoto, and M. Echizen, Opt. Express 12, 4608 (2004).
[104] T. Matsumoto, S. Fujita, and T. Baba, Opt. Express 13, 10768 (2005).
[105] T. Matsumoto, K. Eom, and T. Baba, Opt. Lett. 31, 2786 (2006).
[106] F. J. Lawrence, L. C. Botten, K. B. Dossou, and C. M. de Sterke, Appl. Phys. Lett. 93, 121114
(2008).
[107] F. J. Lawrence, L. C. Botten, K. B. Dossou, C. M. de Sterke, and R. C. McPhedran, Phys. Rev. A
80, 023826 (2009).
[108] J. Witzens, M. Hochberg, T. Baehr-Jones, and A. Scherer, Phys. Rev. E 69, 046609 (2004).
[109] B. Momeni and A. Adibi, Appl. Phys. Lett. 87, 171104 (2005).
[110] W. H. Press, B. P. Flannery, S. A. Teukolsky, and W. T. Vetterling, Numerical recipes in C (Cam-
bridge University Press, 1992).
[111] W. S´migaj, B. Gralak, R. Pierre, and G. Tayeb, in SPP4 Surface Plasmon Photonics Conference
(2009).
[112] W. S´migaj, B. Gralak, R. Pierre, and G. Tayeb, Opt. Lett. 34, 3532 (2009).
[113] D. W. Prather, S. Shi, J. Murakowski, G. J. Schneider, A. Sharkawy, C. Chen, B. L. Miao, and
R. Martin, J. Phys. D 40, 2635 (2007).
[114] S. G. Johnson, M. Ibanescu, M. A. Skorobogatiy, O. Weisberg, J. D. Joannopoulos, and Y. Fink,
Phys. Rev. E 65, 066611 (2002).
[115] M. Vanwolleghem, X. Checoury, W. S´migaj, B. Gralak, L. Magdenko, K. Postava, B. Dagens,
P. Beauvillain, and J.-M. Lourtioz, Phys. Rev. B 80, 121102(R) (2009).
[116] R. E. Collin, Foundations for microwave engineering (Wiley-IEEE, New York, 2001).
[117] D. M. Pozar, Microwave engineering (Wiley, New York, 1998).
[118] F. Olyslager, Electromagnetic waveguides and transmission lines (Oxford University Press, Ox-
ford, 1999).
[119] D. D. Stancil and A. Prabhakar, Spin waves. Theory and applications (Springer, New York, 2009).
[120] Y. Shoji and T. Mizumoto, Opt. Express 15, 13446 (2007).
150 BIBLIOGRAPHY
[121] M. Vanwolleghem, private communication (2009).
[122] B. Vertruyen, R. Cloots, J. S. Abell, T. J. Jackson, R. C. da Silva, E. Popova, and N. Keller, Phys.
Rev. B 78, 094429 (2008).
[123] H. Takeda and S. John, Phys. Rev. A 78, 023804 (pages 15) (2008).
[124] J. Lettieri, V. Vaithyanathan, S. K. Eah, J. Stephens, V. Sih, D. D. Awschalom, J. Levy, and D. G.
Schlom, Appl. Phys. Lett. 83, 975 (2003).
[125] M. J. Steel, M. Levy, and R. M. Osgood, J. Lightwave Technol. 18, 1297 (2000).
[126] A. Figotin and I. Vitebsky, Phys. Rev. E 63, 066609 (2001).
[127] Z. Yu, Z. Wang, and S. Fan, Appl. Phys. Lett. 90, 121133 (2007).
[128] A. B. Khanikaev and M. J. Steel, Opt. Express 17, 5265 (2009).
[129] R. Wolfe, V. J. Fratello, and M. M. Powell, J. Appl. Phys. 63, 3099 (1988).
[130] R. Wolfe, R. A. Lieberman, V. J. Fratello, R. E. Scotti, and N. Kopylov, Appl. Phys. Lett. 56, 426
(1990).
[131] H. Dammann, E. Pross, G. Rabe, and W. Tolksdorf, Appl. Phys. Lett. 56, 1302 (1990).
[132] F. Auracher and H. H. Witte, Opt. Commun. 13, 435 (1975).
[133] J. Fujita, M. Levy, R. M. Osgood, L. Wilkens, and H. Dötsch, Appl. Phys. Lett. 76, 2158 (2000).
[134] N. Kono and M. Koshiba, Opt. Express 13, 9155 (2005).
[135] O. Zhuromskyy, M. Lohmeyer, N. Bahlmann, P. Hertel, H. Dötsch, and A. F. Popkov, Opt. Quan-
tum Electron. 32, 885 (2000).
[136] N. Bahlmann, M. Lohmeyer, O. Zhuromskyy, H. Dötsch, and P. Hertel, Opt. Commun. 161, 330
(1999).
[137] N. Kono and Y. Tsuji, J. Lightwave Technol. 22, 1741 (2004).
[138] W. Zaets and K. Ando, IEEE Photon. Technol. Lett. 11 (1999).
[139] M. Takenaka and Y. Nakano, in Proceedings of the 11th International Conference on Indium
Phosphide and Related Materials (1999), pp. 289–292.
[140] M. Vanwolleghem, W. Van Parys, D. Van Thourhout, R. Baets, F. Lelarge, O. Gauthier-Lafaye,
B. Thedrez, R. Wirix-Speetjens, and L. Lagae, Appl. Phys. Lett. 85, 3980 (2004).
[141] W. Van Parys, B. Moeyersoon, D. Van Thourhout, R. Baets, M. Vanwolleghem, B. Dagens, J. De-
cobert, O. Le Gouezigou, D. Make, R. Vanheertum, et al., Appl. Phys. Lett. 88 (2006).
[142] T. Amemiya, H. Shimizu, M. Yokoyama, P. N. Hai, M. Tanaka, and Y. Nakano, Appl. Opt. 46,
5784 (2007).
[143] H. Hemme, H. Dötsch, and P. Hertel, Appl. Opt. 29, 2741 (1990).
[144] L. Tang, S. M. Drezdzon, and T. Yoshie, Opt. Express 16, 16202 (2008).
BIBLIOGRAPHY 151
[145] S. M. Drezdzon and T. Yoshie, Opt. Express 17, 9276 (2009).
[146] Z. Wang, Y. D. Chong, J. D. Joannopoulos, and M. Soljacˇic´, Phys. Rev. Lett. 100, 013905 (2008).
[147] Z. Wang, Y. Chong, J. D. Joannopoulos, and M. Soljacˇic´, Nature 461, 772 (2009).
[148] W. S´migaj, J. Romero-Vivas, B. Gralak, L. Magdenko, B. Dagens, and M. Vanwolleghem, Opt.
Lett. 35, 568 (2010).
[149] W. Suh, Z. Wang, and S. Fan, IEEE J. Quantum Electron. 40, 1511 (2004).
[150] Z. Wang and S. Fan, Photonics Nanostruct. Fundam. Appl. 4, 132 (2006).
[151] N. Kono and M. Koshiba, in Integrated Photonics Research and Applications/Nanophotonics
(OSA, 2006), p. IMD3.
[152] N. Kono, K. Kakihara, K. Saitoh, and M. Koshiba, Opt. Express 15, 7737 (2007).
[153] K. Gallo, G. Assanto, K. R. Parameswaran, and M. M. Fejer, Applied Physics Letters 79, 314
(2001).
[154] Z. Yu and S. Fan, Nat. Photonics 3, 91 (2009).
[155] Z. Yu, G. Veronis, Z. Wang, and S. Fan, Phys. Rev. Lett. 100, 023902 (2008).
[156] J. D. Joannopoulos, S. G. Johnson, J. N. Winn, and R. D. Meade, Photonic crystals (Princeton
University Press, Princeton, 2008).
[157] J. Scheuer, J. Opt. Soc. Am. B 24, 2178 (2007).
[158] Abramowitz, M. and Stegun, I. A., ed., Handbook of mathematical functions (Dover, New York,
1970).
[159] S. Mazoyer, J. P. Hugonin, and P. Lalanne, Phys. Rev. Lett. 103, 063903 (2009).
[160] W. S´migaj, J. Opt. Soc. Am. A 24, 3309 (2007).
[161] Comsol Multiphysics, version 3.5a, RF module user’s guide (2008).
[162] Y. Tsuji and M. Koshiba, J. Lightwave Technol. 20, 463 (2002).
[163] L. Magdenko, E. Popova, M. Vanwolleghem, C. Pang, F. Fortuna, T. Maroutian, P. Beauvillain,
N. Keller, and B. Dagens,Wafer-scale fabrication of magneto-photonic structures in Bismuth Iron
Garnet thin film, to appear in Microelectron. Eng. (2010).
[164] M. Hammer and O. V. Ivanova, Opt. Quantum Electron. 41, 267 (2009).
[165] A. Hessel, in Antenna theory, edited by R. E. Collin and F. J. Zucker (McGraw-Hill, New York,
1969), vol. 2, chap. 19.
[166] P. Lalanne, C. Sauvan, and J. P. Hugonin, Laser Photonics Rev. 2, 514 (2008).
[167] P. Lalanne and J. P. Hugonin, IEEE J. Quantum Electron. 39, 1430 (2003).
[168] C. Sauvan, G. Lecamp, P. Lalanne, and J. P. Hugonin, Opt. Express 13, 245 (2005).
152 BIBLIOGRAPHY
[169] A. Kitagawa and J. Sakai, Phys. Rev. A 80, 033802 (2009).
[170] K. Srinivasan and O. Painter, Opt. Express 11, 579 (2003).
[171] K. Srinivasan and O. Painter, Opt. Express 10, 670 (2002).
[172] D. Englund, I. Fushman, and J. Vucˇkovic´, Opt. Express 13, 5961 (2005).
[173] Y. Akahane, T. Asano, B. Song, and S. Noda, Nature 425, 944 (2003).
[174] E. V. Jull, Aperture antennas and diffraction theory (Peter Peregrinus Ltd., New York, 1981).
[175] C. Balanis, Antenna theory, analysis and design (Wiley, New York, 1997).
[176] R. Piessens, in Transforms and applications handbook, edited by A. D. Poularikas (CRC, Boca
Raton, 2000), chap. 9.
[177] M. Powell, in Large-scale nonlinear optimization, edited by G. Di Pillo and M. Roma (Springer,
2006), pp. 255–297.
[178] L. C. Andreani and D. Gerace, Phys. Rev. B 73, 235114 (2006).
[179] D. Maystre and M. Cadilhac, Journal of Mathematical Physics 26, 2201 (1985).
[180] D. Maystre, P. Electromagn. Res. 57, 55 (2006).
[181] I. N. Vekua, New methods for solving elliptic equations (North-Holland, Amsterdam, 1967).
[182] O. Christensen, An introduction to frames and Riesz bases (Birkhäuser, Boston, 2003).
[183] J. S. Hesthaven, S. Gottlieb, and D. Gottlieb, Spectral methods for time-dependent problems (Cam-
bridge University Press, Cambridge, 2007).
[184] F. Tisseur and K. Meerbergen, SIAM Rev. 43, 235 (2001), ISSN 0036-1445.
[185] R. C. Ward, SIAM J. Sci. Stat. Comput. 2, 141 (1981).
[186] E. Anderson, Z. Bai, C. Bischof, S. Blackford, J. Demmel, J. Dongarra, J. Du Croz, A. Greenbaum,
S. Hammarling, A. McKenney, et al., LAPACK users’ guide (SIAM, Philadelphia, 1999).
[187] MATLAB 7 function reference, release 2010a, http://www.mathworks.com (2010).
[188] MIT Photonic Bands (MPB), http://ab-initio.mit.edu/mpb (2003).
[189] T. Betcke, SIAM J. Matrix Anal. Appl. 30, 1320 (2008).
[190] M. A. Morgan, S. Chang, and K. K. Mei, IEEE Trans. Antennas Propag. 25, 413 (1977).
[191] M. A. Morgan and K. K. Mei, IEEE Trans. Antennas Propag. 27, 202 (1979).
[192] J. Lee, G. M. Wilkins, and R. Mitra, IEEE Transactions on Microwave Theory Techniques 41,
1981 (1993).
[193] O. Chinellato, Ph.D. thesis, Swiss Federal Institute of Technology, Zürich (2005).
[194] O. Chinellato, P. Arbenz, M. Streiff, and A. Witzig, Future Gener. Comput. Syst. 21, 1263 (2005).
BIBLIOGRAPHY 153
[195] R. Hiptmair and P. D. Ledger, Int. J. Numer. Meth. Engng 62, 1652 (2005).
[196] M. Wong, M. Prak, and V. Hanna, in IEEE MTT-S Dig. (1995), pp. 285–288.
[197] P. Lacoste and Y. Gay, in Mathematical and numerical aspects of wave propagation phenomena
(SIAM, 1991), pp. 746–749, cited after ref. 196.
[198] A. D. Greenwood and J. Jin, IEEE Trans. Antennas Propag. 47, 1260 (1999).
[199] J. P. Boyd, Chebyshev and Fourier spectral methods (Dover, New York, 2000).
[200] D. Sun, J. Manges, X. Yuan, and Z. Cendes, IEEE Antennas Propag. Mag. 37, 12 (1995).
[201] I. Munteanu, ICS Newslett. 9, 10 (2002).
[202] C. Schwab, p- and hp- finite element methods: theory and applications in solid and fluid mechan-
ics (Oxford University Press, Oxford, 1998).
[203] Z. Xu and B. Wu, Int. J. Numer. Meth. Engng 75, 945 (2008).
[204] N. P. van der Aa, H. G. Ter Morsche, and R. R. M. Mattheij, Electron. J. Lin. Algebra 16, 300
(2007).


Conception et modélisation numérique
de composants optiques en nanophotonique intégrée
Résumé Cette thèse est consacrée à la conception et l’analyse théorique de différents composants en
optique intégrée.
Nous présentons un modèle de milieu effectif pour les cristaux photoniques (CPs) 2D qui rend
compte des effets de surface, puis un algorithme pour la conception de réseaux antiréfléchissants grand-
angle pour ces CPs. Ces réseaux permettent d’améliorer significativement la transmission à travers une
lentille plate d’indice négatif.
Nous proposons une nouvelle génération de circulateurs magnétooptiques compacts, fonctionnant
dans un champ magnétique extérieur uniforme et constitués d’une cavité résonnante en anneaux circu-
laires couplée directement à des guides d’ondes standards.
Nous généralisons la méthode multipolaire 2D aux matériaux gyrotropiques et la formulons sans
« lattice sums » pour les structures périodiques. Enfin, nous décrivons en détail la méthode des éléments
finis pour le calcul des modes propres des cavités 3D en anneaux circulaires et matériaux gyrotropiques.
Mots clés cristaux photoniques, composants magnétooptiques, théories du milieu effectif, réseaux
antiréfléchissants, méthodes numériques, optique intégrée.
Design and numerical modelling of integrated optical components
Abstract This thesis is devoted to the design and theoretical and numerical analysis of a number of
photonic crystal (PC) components. In its first part we study the influence of the surface structure of
two-dimensional (2D) PCs on their optical properties. We formulate an effective-medium model of
such PCs, able to reproduce the commonly observed strong dependence of their effective parameters
on the position of their truncation plane. We then develop an algorithm for the design of compact
wide-angle antireflection gratings for 2D PCs and show them to improve significantly the transmission
through a PC flat lens.
In the second part of the manuscript we introduce a new approach to the design of resonant cavities
to be used in compact magneto-optical circulators. In contrast to structures proposed previously, they
are devoid of oppositely-polarised magnetic domains, which significantly facilitates their fabrication. We
show that these cavities need not be embedded in PCs, but can be coupled directly with standard rib
waveguides.
Some numerical techniques developed in the course of this thesis are presented in the last part
of the manuscript. We extend the multiple-scattering method to the case of gyrotropic materials and
introduce a straightforward and extremely accurate method for the calculation of band structures of
2D PCs composed of circular cylinders, based on Fourier-Bessel expansions. Finally, we describe the
implementation of the finite-element method for the calculation of eigenmodes of open, axisymmetric,
three-dimensional cavities containing gyrotropic materials.
Keywords photonic crystals, magneto-optical devices, effective-medium theory, antireflection gratings,
numerical methods, integrated optics.
Laboratoire d’accueil Équipe CLARTE, Institut Fresnel, Campus de Saint Jérôme,
avenue Escadrille Normandie-Niemen, 13397 Marseille Cedex 20
Formation doctorale physique théorique et mathématique
